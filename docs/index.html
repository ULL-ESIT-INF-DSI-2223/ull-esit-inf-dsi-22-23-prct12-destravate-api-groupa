<!DOCTYPE html><html class="default" lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>prct12</title><meta name="description" content="Documentation for prct12"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css"/><link rel="stylesheet" href="assets/highlight.css"/><script async src="assets/search.js" id="search-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os"</script><header class="tsd-page-toolbar">
<div class="tsd-toolbar-contents container">
<div class="table-cell" id="tsd-search" data-base=".">
<div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><path d="M15.7824 13.833L12.6666 10.7177C12.5259 10.5771 12.3353 10.499 12.1353 10.499H11.6259C12.4884 9.39596 13.001 8.00859 13.001 6.49937C13.001 2.90909 10.0914 0 6.50048 0C2.90959 0 0 2.90909 0 6.49937C0 10.0896 2.90959 12.9987 6.50048 12.9987C8.00996 12.9987 9.39756 12.4863 10.5008 11.6239V12.1332C10.5008 12.3332 10.5789 12.5238 10.7195 12.6644L13.8354 15.7797C14.1292 16.0734 14.6042 16.0734 14.8948 15.7797L15.7793 14.8954C16.0731 14.6017 16.0731 14.1267 15.7824 13.833ZM6.50048 10.499C4.29094 10.499 2.50018 8.71165 2.50018 6.49937C2.50018 4.29021 4.28781 2.49976 6.50048 2.49976C8.71001 2.49976 10.5008 4.28708 10.5008 6.49937C10.5008 8.70852 8.71314 10.499 6.50048 10.499Z" fill="var(--color-text)"></path></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div>
<div class="field">
<div id="tsd-toolbar-links"></div></div>
<ul class="results">
<li class="state loading">Preparing search index...</li>
<li class="state failure">The search index is not available</li></ul><a href="index.html" class="title">prct12</a></div>
<div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><rect x="1" y="3" width="14" height="2" fill="var(--color-text)"></rect><rect x="1" y="7" width="14" height="2" fill="var(--color-text)"></rect><rect x="1" y="11" width="14" height="2" fill="var(--color-text)"></rect></svg></a></div></div></header>
<div class="container container-main">
<div class="col-8 col-content">
<div class="tsd-page-title">
<h2>prct12</h2></div>
<div class="tsd-panel tsd-typography">
<a href="#práctica-12---destravate" id="práctica-12---destravate" style="color: inherit; text-decoration: none;">
  <h1>Práctica 12 - Destravate</h1>
</a>
<p><a href="https://github.com/ULL-ESIT-INF-DSI-2223/ull-esit-inf-dsi-22-23-prct12-destravate-api-groupa/actions/workflows/node.js.yml"><img src="https://github.com/ULL-ESIT-INF-DSI-2223/ull-esit-inf-dsi-22-23-prct12-destravate-api-groupa/actions/workflows/node.js.yml/badge.svg" alt="Node.js CI"></a> <a href="https://github.com/ULL-ESIT-INF-DSI-2223/ull-esit-inf-dsi-22-23-prct12-destravate-api-groupa/actions/workflows/coveralls.yml"><img src="https://github.com/ULL-ESIT-INF-DSI-2223/ull-esit-inf-dsi-22-23-prct12-destravate-api-groupa/actions/workflows/coveralls.yml/badge.svg" alt="Coveralls"></a> <a href="https://github.com/ULL-ESIT-INF-DSI-2223/ull-esit-inf-dsi-22-23-prct12-destravate-api-groupa/actions/workflows/sonarcloud.yml"><img src="https://github.com/ULL-ESIT-INF-DSI-2223/ull-esit-inf-dsi-22-23-prct12-destravate-api-groupa/actions/workflows/sonarcloud.yml/badge.svg" alt="Sonar-Cloud"></a> <a href="https://github.com/ULL-ESIT-INF-DSI-2223/ull-esit-inf-dsi-22-23-prct12-destravate-api-groupa/actions/workflows/pages/pages-build-deployment"><img src="https://github.com/ULL-ESIT-INF-DSI-2223/ull-esit-inf-dsi-22-23-prct12-destravate-api-groupa/actions/workflows/pages/pages-build-deployment/badge.svg" alt="pages-build-deployment"></a></p>

<a href="#introducción" id="introducción" style="color: inherit; text-decoration: none;">
  <h2>Introducción</h2>
</a>
<p>El objetivo de esta práctica es implementar un API REST, haciendo uso de Node/Express, que permita llevar a cabo operaciones de creación, lectura, modificación y borrado (Create, Read, Update, Delete - CRUD) de un registro de actividades deportivas.</p>
<p>Podríamos decir que otro objetivo de la práctica es trabajar en grupo de manera conjunta de tal modo que todos aportemos nuestro conocimiento para cumplir con el objetivo, enunciado y requisitos, todo esto gracias a la comunicación adecuada, al trabajo en grupo y también a herramientas muy útiles que vimos en prácticas anteriores como LiveShare para poder estar todos los componentes del grupo trabjando en el código a la vez.</p>

<a href="#desarrollo" id="desarrollo" style="color: inherit; text-decoration: none;">
  <h2>Desarrollo</h2>
</a>
<p>A continuación vamos a explicar cada fichero que tenemos implementado en el proyecto:</p>

<a href="#activityts" id="activityts" style="color: inherit; text-decoration: none;">
  <h3>Activity.ts</h3>
</a>

<a href="#código" id="código" style="color: inherit; text-decoration: none;">
  <h4>Código</h4>
</a>
<pre><code class="language-TypeScript"><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-2">enum</span><span class="hl-1"> </span><span class="hl-3">Activity</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">running</span><span class="hl-1"> = </span><span class="hl-5">&#39;running&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">cycling</span><span class="hl-1"> = </span><span class="hl-5">&#39;cycling&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">hiking</span><span class="hl-1"> = </span><span class="hl-5">&#39;hiking&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">}</span>
</code></pre>
<p>Este código define una enumeración llamada <code>Activity</code> que contiene tres valores posibles: <code>running</code>, <code>cycling</code> y <code>hiking</code>.</p>

<a href="#challengets" id="challengets" style="color: inherit; text-decoration: none;">
  <h3>Challenge.ts</h3>
</a>

<a href="#código-1" id="código-1" style="color: inherit; text-decoration: none;">
  <h4>Código</h4>
</a>
<pre><code class="language-TypeScript"><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-6">Activity</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-5">&#39;./Activity.js&#39;</span><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-6">UniqueList</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-5">&#39;./UniqueList.js&#39;</span><br/><br/><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-2">interface</span><span class="hl-1"> </span><span class="hl-3">ChallengeInterface</span><span class="hl-1">&lt;</span><span class="hl-3">T</span><span class="hl-1"> = </span><span class="hl-3">number</span><span class="hl-1">&gt; {</span><br/><span class="hl-1">  </span><span class="hl-6">name</span><span class="hl-1">: </span><span class="hl-3">string</span><br/><span class="hl-1">  </span><span class="hl-6">activity</span><span class="hl-1">: </span><span class="hl-3">Activity</span><br/><span class="hl-1">  </span><span class="hl-6">tracks</span><span class="hl-1">: </span><span class="hl-3">Array</span><span class="hl-1">&lt;</span><span class="hl-3">T</span><span class="hl-1">&gt;</span><br/><span class="hl-1">  </span><span class="hl-6">users</span><span class="hl-1">: </span><span class="hl-3">Array</span><span class="hl-1">&lt;</span><span class="hl-3">T</span><span class="hl-1">&gt;</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-2">class</span><span class="hl-1"> </span><span class="hl-3">Challenge</span><span class="hl-1">&lt;</span><span class="hl-3">T</span><span class="hl-1"> = </span><span class="hl-3">number</span><span class="hl-1">&gt; </span><span class="hl-2">implements</span><span class="hl-1"> </span><span class="hl-3">ChallengeInterface</span><span class="hl-1">&lt;</span><span class="hl-3">T</span><span class="hl-1">&gt; {</span><br/><br/><span class="hl-1">  </span><span class="hl-2">public</span><span class="hl-1"> </span><span class="hl-2">readonly</span><span class="hl-1"> </span><span class="hl-6">id</span><span class="hl-1">: </span><span class="hl-3">number</span><br/><br/><span class="hl-1">  </span><span class="hl-2">public</span><span class="hl-1"> </span><span class="hl-6">name</span><span class="hl-1">: </span><span class="hl-3">string</span><br/><br/><span class="hl-1">  </span><span class="hl-2">public</span><span class="hl-1"> </span><span class="hl-6">activity</span><span class="hl-1">: </span><span class="hl-3">Activity</span><br/><br/><span class="hl-1">  </span><span class="hl-2">public</span><span class="hl-1"> </span><span class="hl-6">tracks</span><span class="hl-1">: </span><span class="hl-3">UniqueList</span><span class="hl-1">&lt;</span><span class="hl-3">T</span><span class="hl-1">&gt; = </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-7">UniqueList</span><span class="hl-1">&lt;</span><span class="hl-3">T</span><span class="hl-1">&gt;()</span><br/><br/><span class="hl-1">  </span><span class="hl-2">public</span><span class="hl-1"> </span><span class="hl-6">users</span><span class="hl-1">: </span><span class="hl-3">UniqueList</span><span class="hl-1">&lt;</span><span class="hl-3">T</span><span class="hl-1">&gt; = </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-7">UniqueList</span><span class="hl-1">&lt;</span><span class="hl-3">T</span><span class="hl-1">&gt;()</span><br/><br/><span class="hl-1">  </span><span class="hl-2">constructor</span><span class="hl-1">(</span><span class="hl-6">id</span><span class="hl-1">, </span><span class="hl-6">name</span><span class="hl-1">, </span><span class="hl-6">activity</span><span class="hl-1">, ...</span><span class="hl-6">tracks</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-2">this</span><span class="hl-1">.</span><span class="hl-6">id</span><span class="hl-1"> = </span><span class="hl-6">id</span><br/><span class="hl-1">    </span><span class="hl-2">this</span><span class="hl-1">.</span><span class="hl-6">name</span><span class="hl-1"> = </span><span class="hl-6">name</span><br/><span class="hl-1">    </span><span class="hl-2">this</span><span class="hl-1">.</span><span class="hl-6">activity</span><span class="hl-1"> = </span><span class="hl-6">activity</span><br/><span class="hl-1">    </span><span class="hl-0">for</span><span class="hl-1"> (</span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-4">track</span><span class="hl-1"> </span><span class="hl-2">of</span><span class="hl-1"> </span><span class="hl-6">tracks</span><span class="hl-1">) </span><span class="hl-2">this</span><span class="hl-1">.</span><span class="hl-6">tracks</span><span class="hl-1">.</span><span class="hl-7">add</span><span class="hl-1">(</span><span class="hl-6">track</span><span class="hl-1">)</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span>
</code></pre>
<p>Este código es una definición de una clase llamada <code>Challenge</code> que implementa una interfaz llamada <code>ChallengeInterface</code>. La clase Challenge tiene cuatro propiedades: <code>id</code>, <code>name</code>, <code>activity</code>, <code>tracks</code> y <code>users</code>.</p>
<p>La propiedad <code>id</code> es de solo lectura y se establece en el constructor. La propiedad <code>name</code> es una cadena que representa el nombre del desafío. La propiedad <code>activity</code> es un objeto de la clase <code>Activity</code> que representa la actividad asociada con el desafío. Las propiedades <code>tracks</code> y <code>users</code> son matrices de tipo genérico <code>T</code> que se implementan como objetos de la clase <code>UniqueList</code>.</p>
<p>El constructor de la clase Challenge toma cuatro argumentos: <code>id</code>, <code>name</code>, <code>activity</code> y <code>tracks</code>. El argumento <code>id</code> se utiliza para establecer la propiedad <code>id</code> de solo lectura. El argumento <code>name</code> se utiliza para establecer la propiedad <code>name</code>. El argumento <code>activity</code> se utiliza para establecer la propiedad <code>activity</code>. El argumento <code>tracks</code> es un número variable</p>

<a href="#coordinatets" id="coordinatets" style="color: inherit; text-decoration: none;">
  <h3>Coordinate.ts</h3>
</a>

<a href="#código-2" id="código-2" style="color: inherit; text-decoration: none;">
  <h4>Código</h4>
</a>
<pre><code class="language-TypeScript"><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-2">type</span><span class="hl-1"> </span><span class="hl-3">Coordinate</span><span class="hl-1"> = {</span><br/><br/><span class="hl-1">  </span><span class="hl-6">lat</span><span class="hl-1">: </span><span class="hl-3">number</span><br/><br/><span class="hl-1">  </span><span class="hl-6">lng</span><span class="hl-1">: </span><span class="hl-3">number</span><br/><span class="hl-1">}</span>
</code></pre>
<p>Este código define un tipo de dato llamado <code>Coordinate</code> que representa una coordenada geográfica. El tipo de dato tiene dos propiedades: <code>lat</code> y <code>lng</code>, que representan la latitud y longitud de la coordenada, respectivamente. Ambas propiedades son de tipo <code>number</code>, lo que significa que deben ser valores numéricos.</p>

<a href="#entryts" id="entryts" style="color: inherit; text-decoration: none;">
  <h3>Entry.ts</h3>
</a>

<a href="#código-3" id="código-3" style="color: inherit; text-decoration: none;">
  <h4>Código</h4>
</a>
<pre><code class="language-TypeScript"><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-6">UniqueList</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-5">&#39;./UniqueList&#39;</span><br/><br/><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-2">type</span><span class="hl-1"> </span><span class="hl-3">Entry</span><span class="hl-1">&lt;</span><span class="hl-3">T</span><span class="hl-1"> = </span><span class="hl-3">number</span><span class="hl-1">&gt; = {</span><br/><br/><span class="hl-1">  </span><span class="hl-6">date</span><span class="hl-1">: </span><span class="hl-3">string</span><br/><br/><span class="hl-1">  </span><span class="hl-6">tracks</span><span class="hl-1">: </span><span class="hl-3">UniqueList</span><span class="hl-1">&lt;</span><span class="hl-3">T</span><span class="hl-1">&gt;</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-2">type</span><span class="hl-1"> </span><span class="hl-3">ExtendedEntry</span><span class="hl-1">&lt;</span><span class="hl-3">T</span><span class="hl-1"> = </span><span class="hl-3">number</span><span class="hl-1">&gt; = </span><span class="hl-3">Entry</span><span class="hl-1">&lt;</span><span class="hl-3">T</span><span class="hl-1">&gt; &amp; {</span><br/><span class="hl-1">  </span><span class="hl-6">users</span><span class="hl-1">: </span><span class="hl-3">UniqueList</span><span class="hl-1">&lt;</span><span class="hl-3">T</span><span class="hl-1">&gt;</span><br/><span class="hl-1">  </span><span class="hl-6">km</span><span class="hl-1">: </span><span class="hl-3">number</span><br/><span class="hl-1">}</span>
</code></pre>
<p>Este código define dos tipos de datos: <code>Entry</code> y <code>ExtendedEntry</code>. Ambos tipos tienen una propiedad date que es una cadena de texto y una propiedad tracks que es una lista única de elementos de tipo <code>T</code>.</p>
<p>El tipo <code>ExtendedEntry</code> extiende el tipo Entry y agrega dos nuevas propiedades: <code>users</code>, que es una lista única de elementos de tipo <code>T</code>, y km, que es un número.`</p>

<a href="#groupts" id="groupts" style="color: inherit; text-decoration: none;">
  <h3>Group.ts</h3>
</a>

<a href="#código-4" id="código-4" style="color: inherit; text-decoration: none;">
  <h4>Código</h4>
</a>
<pre><code class="language-TypeScript"><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-6">Stats</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-5">&#39;./Stats.js&#39;</span><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-6">UniqueList</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-5">&#39;./UniqueList.js&#39;</span><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-6">ExtendedEntry</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-5">&#39;./Entry.js&#39;</span><br/><br/><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-2">interface</span><span class="hl-1"> </span><span class="hl-3">GroupInterface</span><span class="hl-1">&lt;</span><span class="hl-3">T</span><span class="hl-1"> = </span><span class="hl-3">number</span><span class="hl-1">&gt; {</span><br/><span class="hl-1">  </span><span class="hl-6">name</span><span class="hl-1">: </span><span class="hl-3">string</span><br/><span class="hl-1">  </span><span class="hl-6">users</span><span class="hl-1">: </span><span class="hl-3">Array</span><span class="hl-1">&lt;</span><span class="hl-3">T</span><span class="hl-1">&gt;</span><br/><span class="hl-1">  </span><span class="hl-6">stats</span><span class="hl-1">: </span><span class="hl-3">Stats</span><br/><span class="hl-1">  </span><span class="hl-6">ranking</span><span class="hl-1">: </span><span class="hl-3">Array</span><span class="hl-1">&lt;</span><span class="hl-3">T</span><span class="hl-1">&gt;</span><br/><span class="hl-1">  </span><span class="hl-6">tracks</span><span class="hl-1">: </span><span class="hl-3">Array</span><span class="hl-1">&lt;</span><span class="hl-3">T</span><span class="hl-1">&gt;</span><br/><span class="hl-1">  </span><span class="hl-6">records</span><span class="hl-1">: </span><span class="hl-3">Array</span><span class="hl-1">&lt;</span><span class="hl-3">ExtendedEntry</span><span class="hl-1">&lt;</span><span class="hl-3">T</span><span class="hl-1">&gt;&gt;</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-2">class</span><span class="hl-1"> </span><span class="hl-3">Group</span><span class="hl-1">&lt;</span><span class="hl-3">T</span><span class="hl-1"> = </span><span class="hl-3">number</span><span class="hl-1">&gt; </span><span class="hl-2">implements</span><span class="hl-1"> </span><span class="hl-3">GroupInterface</span><span class="hl-1">&lt;</span><span class="hl-3">T</span><span class="hl-1">&gt; {</span><br/><br/><span class="hl-1">  </span><span class="hl-2">public</span><span class="hl-1"> </span><span class="hl-2">readonly</span><span class="hl-1"> </span><span class="hl-6">id</span><span class="hl-1">: </span><span class="hl-3">number</span><br/><br/><span class="hl-1">  </span><span class="hl-2">public</span><span class="hl-1"> </span><span class="hl-6">name</span><span class="hl-1">: </span><span class="hl-3">string</span><br/><br/><span class="hl-1">  </span><span class="hl-2">public</span><span class="hl-1"> </span><span class="hl-6">users</span><span class="hl-1">: </span><span class="hl-3">UniqueList</span><span class="hl-1">&lt;</span><span class="hl-3">T</span><span class="hl-1">&gt; = </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-7">UniqueList</span><span class="hl-1">&lt;</span><span class="hl-3">T</span><span class="hl-1">&gt;()</span><br/><br/><span class="hl-1">  </span><span class="hl-2">public</span><span class="hl-1"> </span><span class="hl-6">stats</span><span class="hl-1">: </span><span class="hl-3">Stats</span><span class="hl-1"> = </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-7">Stats</span><span class="hl-1">()</span><br/><br/><span class="hl-1">  </span><span class="hl-2">public</span><span class="hl-1"> </span><span class="hl-6">tracks</span><span class="hl-1">: </span><span class="hl-3">UniqueList</span><span class="hl-1">&lt;</span><span class="hl-3">T</span><span class="hl-1">&gt; = </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-7">UniqueList</span><span class="hl-1">&lt;</span><span class="hl-3">T</span><span class="hl-1">&gt;()</span><br/><br/><span class="hl-1">  </span><span class="hl-2">public</span><span class="hl-1"> </span><span class="hl-6">records</span><span class="hl-1">: </span><span class="hl-3">UniqueList</span><span class="hl-1">&lt;</span><span class="hl-3">ExtendedEntry</span><span class="hl-1">&lt;</span><span class="hl-3">T</span><span class="hl-1">&gt;&gt; = </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-6">UniqueList</span><span class="hl-1">&lt;</span><br/><span class="hl-1">    </span><span class="hl-6">ExtendedEntry</span><span class="hl-1">&lt;</span><span class="hl-4">T</span><span class="hl-1">&gt;</span><br/><span class="hl-1">  &gt;()</span><br/><br/><span class="hl-1">  </span><span class="hl-2">public</span><span class="hl-1"> </span><span class="hl-2">constructor</span><span class="hl-1">(</span><span class="hl-6">id</span><span class="hl-1">: </span><span class="hl-3">number</span><span class="hl-1">, </span><span class="hl-6">name</span><span class="hl-1">: </span><span class="hl-3">string</span><span class="hl-1">, ...</span><span class="hl-6">users</span><span class="hl-1">: </span><span class="hl-3">T</span><span class="hl-1">[]) {</span><br/><span class="hl-1">    </span><span class="hl-2">this</span><span class="hl-1">.</span><span class="hl-6">id</span><span class="hl-1"> = </span><span class="hl-6">id</span><br/><span class="hl-1">    </span><span class="hl-2">this</span><span class="hl-1">.</span><span class="hl-6">name</span><span class="hl-1"> = </span><span class="hl-6">name</span><br/><span class="hl-1">    </span><span class="hl-0">for</span><span class="hl-1"> (</span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-4">member</span><span class="hl-1"> </span><span class="hl-2">of</span><span class="hl-1"> </span><span class="hl-6">users</span><span class="hl-1">) </span><span class="hl-2">this</span><span class="hl-1">.</span><span class="hl-6">users</span><span class="hl-1">.</span><span class="hl-7">add</span><span class="hl-1">(</span><span class="hl-6">member</span><span class="hl-1">)</span><br/><span class="hl-1">    </span><span class="hl-2">this</span><span class="hl-1">.</span><span class="hl-6">stats</span><span class="hl-1">.</span><span class="hl-6">values</span><span class="hl-1"> = {</span><br/><span class="hl-1">      </span><span class="hl-6">weekly:</span><span class="hl-1"> { </span><span class="hl-6">km:</span><span class="hl-1"> </span><span class="hl-8">0</span><span class="hl-1">, </span><span class="hl-6">slope:</span><span class="hl-1"> </span><span class="hl-8">0</span><span class="hl-1"> },</span><br/><span class="hl-1">      </span><span class="hl-6">monthly:</span><span class="hl-1"> { </span><span class="hl-6">km:</span><span class="hl-1"> </span><span class="hl-8">0</span><span class="hl-1">, </span><span class="hl-6">slope:</span><span class="hl-1"> </span><span class="hl-8">0</span><span class="hl-1"> },</span><br/><span class="hl-1">      </span><span class="hl-6">yearly:</span><span class="hl-1"> { </span><span class="hl-6">km:</span><span class="hl-1"> </span><span class="hl-8">0</span><span class="hl-1">, </span><span class="hl-6">slope:</span><span class="hl-1"> </span><span class="hl-8">0</span><span class="hl-1"> },</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  }</span><br/><br/><span class="hl-1">  </span><span class="hl-2">public</span><span class="hl-1"> </span><span class="hl-2">get</span><span class="hl-1"> </span><span class="hl-7">ranking</span><span class="hl-1">(): </span><span class="hl-3">UniqueList</span><span class="hl-1">&lt;</span><span class="hl-3">T</span><span class="hl-1">&gt; {</span><br/><span class="hl-1">    </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-4">ranking</span><span class="hl-1"> = </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-7">UniqueList</span><span class="hl-1">&lt;</span><span class="hl-3">T</span><span class="hl-1">&gt;()</span><br/><span class="hl-1">    </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-4">distances</span><span class="hl-1">: { [</span><span class="hl-6">id</span><span class="hl-1">: </span><span class="hl-3">string</span><span class="hl-1">]: </span><span class="hl-3">number</span><span class="hl-1"> } = {}</span><br/><span class="hl-1">    </span><span class="hl-0">for</span><span class="hl-1"> (</span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-4">record</span><span class="hl-1"> </span><span class="hl-2">of</span><span class="hl-1"> </span><span class="hl-2">this</span><span class="hl-1">.</span><span class="hl-6">records</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-0">for</span><span class="hl-1"> (</span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-4">user</span><span class="hl-1"> </span><span class="hl-2">of</span><span class="hl-1"> </span><span class="hl-6">record</span><span class="hl-1">.</span><span class="hl-6">users</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-6">distances</span><span class="hl-1">[</span><span class="hl-7">String</span><span class="hl-1">(</span><span class="hl-6">user</span><span class="hl-1">)]) </span><span class="hl-6">distances</span><span class="hl-1">[</span><span class="hl-7">String</span><span class="hl-1">(</span><span class="hl-6">user</span><span class="hl-1">)] += </span><span class="hl-6">record</span><span class="hl-1">.</span><span class="hl-6">km</span><br/><span class="hl-1">        </span><span class="hl-0">else</span><span class="hl-1"> </span><span class="hl-6">distances</span><span class="hl-1">[</span><span class="hl-7">String</span><span class="hl-1">(</span><span class="hl-6">user</span><span class="hl-1">)] = </span><span class="hl-6">record</span><span class="hl-1">.</span><span class="hl-6">km</span><br/><span class="hl-1">      }</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">    </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-4">sorted</span><span class="hl-1"> = </span><span class="hl-6">Object</span><span class="hl-1">.</span><span class="hl-7">keys</span><span class="hl-1">(</span><span class="hl-6">distances</span><span class="hl-1">).</span><span class="hl-7">sort</span><span class="hl-1">(</span><br/><span class="hl-1">      (</span><span class="hl-6">a</span><span class="hl-1">, </span><span class="hl-6">b</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> </span><span class="hl-6">distances</span><span class="hl-1">[</span><span class="hl-6">b</span><span class="hl-1">] - </span><span class="hl-6">distances</span><span class="hl-1">[</span><span class="hl-6">a</span><span class="hl-1">]</span><br/><span class="hl-1">    )</span><br/><span class="hl-1">    </span><span class="hl-0">for</span><span class="hl-1"> (</span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-4">id</span><span class="hl-1"> </span><span class="hl-2">of</span><span class="hl-1"> </span><span class="hl-6">sorted</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-2">this</span><span class="hl-1">.</span><span class="hl-7">convertToT</span><span class="hl-1">(</span><span class="hl-6">id</span><span class="hl-1">) &amp;&amp; </span><span class="hl-2">this</span><span class="hl-1">.</span><span class="hl-6">users</span><span class="hl-1">.</span><span class="hl-7">has</span><span class="hl-1">(</span><span class="hl-2">this</span><span class="hl-1">.</span><span class="hl-7">convertToT</span><span class="hl-1">(</span><span class="hl-6">id</span><span class="hl-1">) </span><span class="hl-0">as</span><span class="hl-1"> </span><span class="hl-3">T</span><span class="hl-1">))</span><br/><span class="hl-1">        </span><span class="hl-6">ranking</span><span class="hl-1">.</span><span class="hl-7">add</span><span class="hl-1">(</span><span class="hl-2">this</span><span class="hl-1">.</span><span class="hl-7">convertToT</span><span class="hl-1">(</span><span class="hl-6">id</span><span class="hl-1">) </span><span class="hl-0">as</span><span class="hl-1"> </span><span class="hl-3">T</span><span class="hl-1">)</span><br/><span class="hl-1">    </span><span class="hl-0">return</span><span class="hl-1"> </span><span class="hl-6">ranking</span><br/><span class="hl-1">  }</span><br/><br/><span class="hl-1">  </span><span class="hl-9">/* c8 ignore start */</span><br/><span class="hl-1">  </span><span class="hl-2">private</span><span class="hl-1"> </span><span class="hl-7">convertToT</span><span class="hl-1">(</span><span class="hl-6">value</span><span class="hl-1">: </span><span class="hl-3">any</span><span class="hl-1">): </span><span class="hl-3">T</span><span class="hl-1"> | </span><span class="hl-3">null</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-0">if</span><span class="hl-1"> (</span><br/><span class="hl-1">      </span><span class="hl-2">typeof</span><span class="hl-1"> </span><span class="hl-6">value</span><span class="hl-1"> === </span><span class="hl-5">&#39;string&#39;</span><span class="hl-1"> &amp;&amp;</span><br/><span class="hl-1">      </span><span class="hl-2">typeof</span><span class="hl-1"> </span><span class="hl-7">Number</span><span class="hl-1">(</span><span class="hl-6">value</span><span class="hl-1">) === </span><span class="hl-5">&#39;number&#39;</span><span class="hl-1"> &amp;&amp;</span><br/><span class="hl-1">      !</span><span class="hl-7">isNaN</span><span class="hl-1">(</span><span class="hl-7">Number</span><span class="hl-1">(</span><span class="hl-6">value</span><span class="hl-1">))</span><br/><span class="hl-1">    )</span><br/><span class="hl-1">      </span><span class="hl-0">return</span><span class="hl-1"> </span><span class="hl-7">Number</span><span class="hl-1">(</span><span class="hl-6">value</span><span class="hl-1">) </span><span class="hl-0">as</span><span class="hl-1"> </span><span class="hl-3">T</span><br/><span class="hl-1">    </span><span class="hl-0">return</span><span class="hl-1"> </span><span class="hl-2">null</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">  </span><span class="hl-9">/* c8 ignore stop */</span><br/><span class="hl-1">}</span>
</code></pre>
<p>Este código define una clase llamada <code>Group</code> que implementa la interfaz <code>GroupInterface</code>. La interfaz <code>GroupInterface</code> define una estructura de datos que representa un grupo de usuarios y sus estadísticas de actividad física. La clase <code>Group</code> tiene propiedades como <code>name</code>, <code>users</code>, <code>stats</code>, <code>tracks</code>, <code>records</code> y <code>ranking</code>, que representan el nombre del grupo, la lista de usuarios, las estadísticas de actividad física, las pistas, los registros y la clasificación de los usuarios en función de su actividad física.</p>
<p>La clase <code>Group</code> tiene un constructor que toma un <code>id</code>, un <code>name</code> y una lista de <code>users</code>. El constructor inicializa las propiedades <code>id</code> y <code>name</code> y agrega los usuarios a la lista de usuarios.</p>
<p>La propiedad <code>ranking</code> es una lista de usuarios ordenados por su actividad física. La propiedad <code>records</code> es una lista de registros de actividad física de los usuarios. La propiedad <code>stats</code> es un objeto que contiene las estadísticas de actividad física del grupo.</p>
<p>La clase <code>Group</code> también tiene un método privado llamado <code>convertToT</code> que convierte un valor a un tipo genérico <code>T</code>. Este método se utiliza para convertir los identificadores de usuario de tipo <code>string</code> a un tipo genérico <code>T</code>.</p>

<a href="#modelsts" id="modelsts" style="color: inherit; text-decoration: none;">
  <h3>Models.ts</h3>
</a>

<a href="#código-5" id="código-5" style="color: inherit; text-decoration: none;">
  <h4>Código</h4>
</a>
<pre><code class="language-TypeScript"><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-6">model</span><span class="hl-1">, </span><span class="hl-6">Schema</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-5">&#39;mongoose&#39;</span><br/><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-6">Activity</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-5">&#39;./Activity.js&#39;</span><br/><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-6">TrackInterface</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-5">&#39;./Track.js&#39;</span><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-6">UserInterface</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-5">&#39;./User.js&#39;</span><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-6">GroupInterface</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-5">&#39;./Group.js&#39;</span><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-6">ChallengeInterface</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-5">&#39;./Challenge.js&#39;</span><br/><br/><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-4">TrackSchema</span><span class="hl-1"> = </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-7">Schema</span><span class="hl-1">&lt;</span><span class="hl-3">TrackInterface</span><span class="hl-1">&lt;</span><span class="hl-3">string</span><span class="hl-1">&gt;&gt;({</span><br/><span class="hl-1">  </span><span class="hl-6">name:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-6">type:</span><span class="hl-1"> </span><span class="hl-6">String</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-6">required:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-6">unique:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">,</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-6">start:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-6">type:</span><span class="hl-1"> </span><span class="hl-6">Object</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-6">required:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">,</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-6">end:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-6">type:</span><span class="hl-1"> </span><span class="hl-6">Object</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-6">required:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">,</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-6">distance:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-6">type:</span><span class="hl-1"> </span><span class="hl-6">Number</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-6">required:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">,</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-6">slope:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-6">type:</span><span class="hl-1"> </span><span class="hl-6">Number</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-6">required:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">,</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-6">users:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-6">type:</span><span class="hl-1"> </span><span class="hl-6">Schema</span><span class="hl-1">.</span><span class="hl-6">Types</span><span class="hl-1">.</span><span class="hl-6">Mixed</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-6">required:</span><span class="hl-1"> </span><span class="hl-2">false</span><span class="hl-1">,</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-6">activity:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-6">type:</span><span class="hl-1"> </span><span class="hl-6">String</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-6">required:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-6">enum:</span><span class="hl-1"> </span><span class="hl-6">Object</span><span class="hl-1">.</span><span class="hl-7">values</span><span class="hl-1">(</span><span class="hl-6">Activity</span><span class="hl-1">),</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-6">score:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-6">type:</span><span class="hl-1"> </span><span class="hl-6">Number</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-6">required:</span><span class="hl-1"> </span><span class="hl-2">false</span><span class="hl-1">,</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">})</span><br/><br/><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-4">TrackModel</span><span class="hl-1"> = </span><span class="hl-7">model</span><span class="hl-1">&lt;</span><span class="hl-3">TrackInterface</span><span class="hl-1">&lt;</span><span class="hl-3">string</span><span class="hl-1">&gt;&gt;(</span><span class="hl-5">&#39;Track&#39;</span><span class="hl-1">, </span><span class="hl-6">TrackSchema</span><span class="hl-1">)</span><br/><br/><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-4">UserSchema</span><span class="hl-1"> = </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-7">Schema</span><span class="hl-1">&lt;</span><span class="hl-3">UserInterface</span><span class="hl-1">&lt;</span><span class="hl-3">string</span><span class="hl-1">&gt;&gt;({</span><br/><span class="hl-1">  </span><span class="hl-6">name:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-6">type:</span><span class="hl-1"> </span><span class="hl-6">String</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-6">required:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-6">unique:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">,</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-6">activity:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-6">type:</span><span class="hl-1"> </span><span class="hl-6">String</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-6">required:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-6">enum:</span><span class="hl-1"> </span><span class="hl-6">Object</span><span class="hl-1">.</span><span class="hl-7">values</span><span class="hl-1">(</span><span class="hl-6">Activity</span><span class="hl-1">),</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-6">users:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-6">type:</span><span class="hl-1"> </span><span class="hl-6">Schema</span><span class="hl-1">.</span><span class="hl-6">Types</span><span class="hl-1">.</span><span class="hl-6">Mixed</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-6">ref:</span><span class="hl-1"> </span><span class="hl-5">&#39;User&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-6">required:</span><span class="hl-1"> </span><span class="hl-2">false</span><span class="hl-1">,</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-6">groups:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-6">type:</span><span class="hl-1"> </span><span class="hl-6">Schema</span><span class="hl-1">.</span><span class="hl-6">Types</span><span class="hl-1">.</span><span class="hl-6">Mixed</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-6">ref:</span><span class="hl-1"> </span><span class="hl-5">&#39;Group&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-6">required:</span><span class="hl-1"> </span><span class="hl-2">false</span><span class="hl-1">,</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-6">stats:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-6">type:</span><span class="hl-1"> </span><span class="hl-6">Array</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-6">required:</span><span class="hl-1"> </span><span class="hl-2">false</span><span class="hl-1">,</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-6">tracks:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-6">type:</span><span class="hl-1"> </span><span class="hl-6">Schema</span><span class="hl-1">.</span><span class="hl-6">Types</span><span class="hl-1">.</span><span class="hl-6">Mixed</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-6">ref:</span><span class="hl-1"> </span><span class="hl-5">&#39;Track&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-6">required:</span><span class="hl-1"> </span><span class="hl-2">false</span><span class="hl-1">,</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-6">challenges:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-6">type:</span><span class="hl-1"> </span><span class="hl-6">Schema</span><span class="hl-1">.</span><span class="hl-6">Types</span><span class="hl-1">.</span><span class="hl-6">Mixed</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-6">ref:</span><span class="hl-1"> </span><span class="hl-5">&#39;Challenge&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-6">required:</span><span class="hl-1"> </span><span class="hl-2">false</span><span class="hl-1">,</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-6">records:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-6">type:</span><span class="hl-1"> </span><span class="hl-6">Schema</span><span class="hl-1">.</span><span class="hl-6">Types</span><span class="hl-1">.</span><span class="hl-6">Mixed</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-6">required:</span><span class="hl-1"> </span><span class="hl-2">false</span><span class="hl-1">,</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">})</span><br/><br/><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-4">UserModel</span><span class="hl-1"> = </span><span class="hl-7">model</span><span class="hl-1">&lt;</span><span class="hl-3">UserInterface</span><span class="hl-1">&lt;</span><span class="hl-3">string</span><span class="hl-1">&gt;&gt;(</span><span class="hl-5">&#39;User&#39;</span><span class="hl-1">, </span><span class="hl-6">UserSchema</span><span class="hl-1">)</span><br/><br/><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-4">GroupSchema</span><span class="hl-1"> = </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-7">Schema</span><span class="hl-1">&lt;</span><span class="hl-3">GroupInterface</span><span class="hl-1">&lt;</span><span class="hl-3">string</span><span class="hl-1">&gt;&gt;({</span><br/><span class="hl-1">  </span><span class="hl-6">name:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-6">type:</span><span class="hl-1"> </span><span class="hl-6">String</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-6">required:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-6">unique:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">,</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-6">users:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-6">type:</span><span class="hl-1"> </span><span class="hl-6">Schema</span><span class="hl-1">.</span><span class="hl-6">Types</span><span class="hl-1">.</span><span class="hl-6">Mixed</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-6">ref:</span><span class="hl-1"> </span><span class="hl-5">&#39;User&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-6">required:</span><span class="hl-1"> </span><span class="hl-2">false</span><span class="hl-1">,</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-6">stats:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-6">type:</span><span class="hl-1"> </span><span class="hl-6">Array</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-6">required:</span><span class="hl-1"> </span><span class="hl-2">false</span><span class="hl-1">,</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-6">ranking:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-6">type:</span><span class="hl-1"> </span><span class="hl-6">Schema</span><span class="hl-1">.</span><span class="hl-6">Types</span><span class="hl-1">.</span><span class="hl-6">Mixed</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-6">ref:</span><span class="hl-1"> </span><span class="hl-5">&#39;User&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-6">required:</span><span class="hl-1"> </span><span class="hl-2">false</span><span class="hl-1">,</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-6">tracks:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-6">type:</span><span class="hl-1"> </span><span class="hl-6">Schema</span><span class="hl-1">.</span><span class="hl-6">Types</span><span class="hl-1">.</span><span class="hl-6">Mixed</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-6">ref:</span><span class="hl-1"> </span><span class="hl-5">&#39;Track&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-6">required:</span><span class="hl-1"> </span><span class="hl-2">false</span><span class="hl-1">,</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-6">records:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-6">type:</span><span class="hl-1"> </span><span class="hl-6">Schema</span><span class="hl-1">.</span><span class="hl-6">Types</span><span class="hl-1">.</span><span class="hl-6">Mixed</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-6">required:</span><span class="hl-1"> </span><span class="hl-2">false</span><span class="hl-1">,</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">})</span><br/><br/><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-4">GroupModel</span><span class="hl-1"> = </span><span class="hl-7">model</span><span class="hl-1">&lt;</span><span class="hl-3">GroupInterface</span><span class="hl-1">&lt;</span><span class="hl-3">string</span><span class="hl-1">&gt;&gt;(</span><span class="hl-5">&#39;Group&#39;</span><span class="hl-1">, </span><span class="hl-6">GroupSchema</span><span class="hl-1">)</span><br/><br/><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-4">ChallengeSchema</span><span class="hl-1"> = </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-7">Schema</span><span class="hl-1">&lt;</span><span class="hl-3">ChallengeInterface</span><span class="hl-1">&lt;</span><span class="hl-3">string</span><span class="hl-1">&gt;&gt;({</span><br/><span class="hl-1">  </span><span class="hl-6">name:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-6">type:</span><span class="hl-1"> </span><span class="hl-6">String</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-6">required:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-6">unique:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">,</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-6">activity:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-6">type:</span><span class="hl-1"> </span><span class="hl-6">String</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-6">required:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-6">enum:</span><span class="hl-1"> </span><span class="hl-6">Object</span><span class="hl-1">.</span><span class="hl-7">values</span><span class="hl-1">(</span><span class="hl-6">Activity</span><span class="hl-1">),</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-6">tracks:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-6">type:</span><span class="hl-1"> </span><span class="hl-6">Schema</span><span class="hl-1">.</span><span class="hl-6">Types</span><span class="hl-1">.</span><span class="hl-6">Mixed</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-6">ref:</span><span class="hl-1"> </span><span class="hl-5">&#39;Track&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-6">required:</span><span class="hl-1"> </span><span class="hl-2">false</span><span class="hl-1">,</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-6">users:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-6">type:</span><span class="hl-1"> </span><span class="hl-6">Schema</span><span class="hl-1">.</span><span class="hl-6">Types</span><span class="hl-1">.</span><span class="hl-6">Mixed</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-6">ref:</span><span class="hl-1"> </span><span class="hl-5">&#39;User&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-6">required:</span><span class="hl-1"> </span><span class="hl-2">false</span><span class="hl-1">,</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">})</span><br/><br/><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-4">ChallengeModel</span><span class="hl-1"> = </span><span class="hl-7">model</span><span class="hl-1">&lt;</span><span class="hl-3">ChallengeInterface</span><span class="hl-1">&lt;</span><span class="hl-3">string</span><span class="hl-1">&gt;&gt;(</span><br/><span class="hl-1">  </span><span class="hl-5">&#39;Challenge&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-6">ChallengeSchema</span><br/><span class="hl-1">)</span>
</code></pre>
<p>En este código, se definen cuatro esquemas: <code>Track</code>, <code>User</code>, <code>Group</code> y <code>Challenge</code>. Cada uno de ellos tiene diferentes campos que definen la estructura de los documentos que se almacenarán en la base de datos. Por ejemplo, el esquema Track tiene campos como <code>name</code>, <code>start</code>, <code>end</code>, <code>distance</code>, <code>slope</code>, <code>users</code>, <code>activity</code> y <code>score</code>.</p>
<p>Cada esquema se utiliza para crear un modelo correspondiente utilizando la función <code>model</code> de Mongoose. Por ejemplo, el modelo Track se crea utilizando <code>TrackModel = model&lt;TrackInterface&lt;string&gt;&gt;(&#39;Track&#39;, TrackSchema)</code>.</p>

<a href="#serverts" id="serverts" style="color: inherit; text-decoration: none;">
  <h3>Server.ts</h3>
</a>

<a href="#código-6" id="código-6" style="color: inherit; text-decoration: none;">
  <h4>Código</h4>
</a>
<pre><code class="language-TypeScript"><span class="hl-0">import</span><span class="hl-1"> </span><span class="hl-6">express</span><span class="hl-1"> </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-5">&#39;express&#39;</span><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-6">Server</span><span class="hl-1"> </span><span class="hl-0">as</span><span class="hl-1"> </span><span class="hl-6">HttpServer</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-5">&#39;http&#39;</span><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-6">connect</span><span class="hl-1">, </span><span class="hl-6">disconnect</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-5">&#39;mongoose&#39;</span><br/><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-6">Group</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-5">&#39;./Group.js&#39;</span><br/><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-6">UniqueList</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-5">&#39;./UniqueList.js&#39;</span><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-6">ExtendedEntry</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-5">&#39;./Entry.js&#39;</span><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-6">TrackModel</span><span class="hl-1">, </span><span class="hl-6">UserModel</span><span class="hl-1">, </span><span class="hl-6">GroupModel</span><span class="hl-1">, </span><span class="hl-6">ChallengeModel</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-5">&#39;./Models.js&#39;</span><br/><br/><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-4">routes</span><span class="hl-1"> = [</span><br/><span class="hl-1">  </span><span class="hl-5">&#39;/tracks&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-5">&#39;/tracks/:id&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-5">&#39;/users&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-5">&#39;/users/:id&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-5">&#39;/groups&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-5">&#39;/groups/:id&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-5">&#39;/challenges&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-5">&#39;/challenges/:id&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">]</span><br/><br/><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-2">class</span><span class="hl-1"> </span><span class="hl-3">Server</span><span class="hl-1"> {</span><br/><br/><span class="hl-1">  </span><span class="hl-2">private</span><span class="hl-1"> </span><span class="hl-6">server</span><span class="hl-1">: </span><span class="hl-3">HttpServer</span><span class="hl-1"> = </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-7">HttpServer</span><span class="hl-1">()</span><br/><br/><span class="hl-1">  </span><span class="hl-2">public</span><span class="hl-1"> </span><span class="hl-6">app</span><span class="hl-1">: </span><span class="hl-3">express</span><span class="hl-1">.</span><span class="hl-3">Application</span><span class="hl-1"> = </span><span class="hl-7">express</span><span class="hl-1">()</span><br/><br/><span class="hl-1">  </span><span class="hl-9">/* c8 ignore start */</span><br/><span class="hl-1">  </span><span class="hl-2">public</span><span class="hl-1"> </span><span class="hl-2">constructor</span><span class="hl-1">() {</span><br/><span class="hl-1">    </span><span class="hl-2">this</span><span class="hl-1">.</span><span class="hl-6">app</span><span class="hl-1">.</span><span class="hl-7">use</span><span class="hl-1">(</span><span class="hl-6">express</span><span class="hl-1">.</span><span class="hl-7">json</span><span class="hl-1">())</span><br/><span class="hl-1">    </span><span class="hl-2">this</span><span class="hl-1">.</span><span class="hl-7">defineGet</span><span class="hl-1">()</span><br/><span class="hl-1">    </span><span class="hl-2">this</span><span class="hl-1">.</span><span class="hl-7">definePost</span><span class="hl-1">()</span><br/><span class="hl-1">    </span><span class="hl-2">this</span><span class="hl-1">.</span><span class="hl-7">defineDelete</span><span class="hl-1">()</span><br/><span class="hl-1">    </span><span class="hl-2">this</span><span class="hl-1">.</span><span class="hl-7">definePatch</span><span class="hl-1">()</span><br/><span class="hl-1">    </span><span class="hl-2">this</span><span class="hl-1">.</span><span class="hl-6">app</span><span class="hl-1">.</span><span class="hl-7">all</span><span class="hl-1">(</span><span class="hl-5">&#39;*&#39;</span><span class="hl-1">, (</span><span class="hl-6">_</span><span class="hl-1">, </span><span class="hl-6">res</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">501</span><span class="hl-1">).</span><span class="hl-7">send</span><span class="hl-1">()</span><br/><span class="hl-1">    })</span><br/><span class="hl-1">  }</span><br/><br/><span class="hl-1">  </span><span class="hl-2">private</span><span class="hl-1"> </span><span class="hl-7">defineGet</span><span class="hl-1">() {</span><br/><span class="hl-1">    </span><span class="hl-0">for</span><span class="hl-1"> (</span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-4">route</span><span class="hl-1"> </span><span class="hl-2">of</span><span class="hl-1"> </span><span class="hl-6">routes</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-2">this</span><span class="hl-1">.</span><span class="hl-6">app</span><span class="hl-1">.</span><span class="hl-7">get</span><span class="hl-1">(</span><span class="hl-6">route</span><span class="hl-1">, (</span><span class="hl-6">req</span><span class="hl-1">, </span><span class="hl-6">res</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-2">this</span><span class="hl-1">.</span><span class="hl-7">get</span><span class="hl-1">(</span><span class="hl-6">req</span><span class="hl-1">, </span><span class="hl-6">res</span><span class="hl-1">)</span><br/><span class="hl-1">          .</span><span class="hl-7">then</span><span class="hl-1">(() </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">            </span><span class="hl-6">console</span><span class="hl-1">.</span><span class="hl-7">log</span><span class="hl-1">(</span><span class="hl-5">&#39;Get request completed&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">          })</span><br/><span class="hl-1">          .</span><span class="hl-7">catch</span><span class="hl-1">((</span><span class="hl-6">err</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">            </span><span class="hl-6">console</span><span class="hl-1">.</span><span class="hl-7">log</span><span class="hl-1">(</span><span class="hl-5">&#39;Error in get request: &#39;</span><span class="hl-1"> + </span><span class="hl-6">err</span><span class="hl-1">)</span><br/><span class="hl-1">          })</span><br/><span class="hl-1">      })</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  }</span><br/><br/><span class="hl-1">  </span><span class="hl-2">private</span><span class="hl-1"> </span><span class="hl-7">definePost</span><span class="hl-1">() {</span><br/><span class="hl-1">    </span><span class="hl-0">for</span><span class="hl-1"> (</span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-4">route</span><span class="hl-1"> </span><span class="hl-2">of</span><span class="hl-1"> </span><span class="hl-6">routes</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-2">this</span><span class="hl-1">.</span><span class="hl-6">app</span><span class="hl-1">.</span><span class="hl-7">post</span><span class="hl-1">(</span><span class="hl-6">route</span><span class="hl-1">, (</span><span class="hl-6">req</span><span class="hl-1">, </span><span class="hl-6">res</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-2">this</span><span class="hl-1">.</span><span class="hl-7">post</span><span class="hl-1">(</span><span class="hl-6">req</span><span class="hl-1">, </span><span class="hl-6">res</span><span class="hl-1">)</span><br/><span class="hl-1">          .</span><span class="hl-7">then</span><span class="hl-1">(() </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">            </span><span class="hl-6">console</span><span class="hl-1">.</span><span class="hl-7">log</span><span class="hl-1">(</span><span class="hl-5">&#39;Post request completed&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">          })</span><br/><span class="hl-1">          .</span><span class="hl-7">catch</span><span class="hl-1">((</span><span class="hl-6">err</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">            </span><span class="hl-6">console</span><span class="hl-1">.</span><span class="hl-7">log</span><span class="hl-1">(</span><span class="hl-5">&#39;Error in post request: &#39;</span><span class="hl-1"> + </span><span class="hl-6">err</span><span class="hl-1">)</span><br/><span class="hl-1">          })</span><br/><span class="hl-1">      })</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  }</span><br/><br/><span class="hl-1">  </span><span class="hl-2">private</span><span class="hl-1"> </span><span class="hl-7">defineDelete</span><span class="hl-1">() {</span><br/><span class="hl-1">    </span><span class="hl-0">for</span><span class="hl-1"> (</span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-4">route</span><span class="hl-1"> </span><span class="hl-2">of</span><span class="hl-1"> </span><span class="hl-6">routes</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-2">this</span><span class="hl-1">.</span><span class="hl-6">app</span><span class="hl-1">.</span><span class="hl-7">delete</span><span class="hl-1">(</span><span class="hl-6">route</span><span class="hl-1">, (</span><span class="hl-6">req</span><span class="hl-1">, </span><span class="hl-6">res</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-2">this</span><span class="hl-1">.</span><span class="hl-7">delete</span><span class="hl-1">(</span><span class="hl-6">req</span><span class="hl-1">, </span><span class="hl-6">res</span><span class="hl-1">)</span><br/><span class="hl-1">          .</span><span class="hl-7">then</span><span class="hl-1">(() </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">            </span><span class="hl-6">console</span><span class="hl-1">.</span><span class="hl-7">log</span><span class="hl-1">(</span><span class="hl-5">&#39;Delete request completed&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">          })</span><br/><span class="hl-1">          .</span><span class="hl-7">catch</span><span class="hl-1">((</span><span class="hl-6">err</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">            </span><span class="hl-6">console</span><span class="hl-1">.</span><span class="hl-7">log</span><span class="hl-1">(</span><span class="hl-5">&#39;Error in delete request: &#39;</span><span class="hl-1"> + </span><span class="hl-6">err</span><span class="hl-1">)</span><br/><span class="hl-1">          })</span><br/><span class="hl-1">      })</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  }</span><br/><br/><span class="hl-1">  </span><span class="hl-2">private</span><span class="hl-1"> </span><span class="hl-7">definePatch</span><span class="hl-1">() {</span><br/><span class="hl-1">    </span><span class="hl-0">for</span><span class="hl-1"> (</span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-4">route</span><span class="hl-1"> </span><span class="hl-2">of</span><span class="hl-1"> </span><span class="hl-6">routes</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-2">this</span><span class="hl-1">.</span><span class="hl-6">app</span><span class="hl-1">.</span><span class="hl-7">patch</span><span class="hl-1">(</span><span class="hl-6">route</span><span class="hl-1">, (</span><span class="hl-6">req</span><span class="hl-1">, </span><span class="hl-6">res</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-2">this</span><span class="hl-1">.</span><span class="hl-7">patch</span><span class="hl-1">(</span><span class="hl-6">req</span><span class="hl-1">, </span><span class="hl-6">res</span><span class="hl-1">)</span><br/><span class="hl-1">          .</span><span class="hl-7">then</span><span class="hl-1">(() </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">            </span><span class="hl-6">console</span><span class="hl-1">.</span><span class="hl-7">log</span><span class="hl-1">(</span><span class="hl-5">&#39;Patch request completed&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">          })</span><br/><span class="hl-1">          .</span><span class="hl-7">catch</span><span class="hl-1">((</span><span class="hl-6">err</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">            </span><span class="hl-6">console</span><span class="hl-1">.</span><span class="hl-7">log</span><span class="hl-1">(</span><span class="hl-5">&#39;Error in patch request: &#39;</span><span class="hl-1"> + </span><span class="hl-6">err</span><span class="hl-1">)</span><br/><span class="hl-1">          })</span><br/><span class="hl-1">      })</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  }</span><br/><br/><span class="hl-1">  </span><span class="hl-2">public</span><span class="hl-1"> </span><span class="hl-7">start</span><span class="hl-1">(</span><span class="hl-6">port</span><span class="hl-1">: </span><span class="hl-3">number</span><span class="hl-1"> | </span><span class="hl-3">string</span><span class="hl-1">): </span><span class="hl-3">void</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-2">this</span><span class="hl-1">.</span><span class="hl-6">server</span><span class="hl-1"> = </span><span class="hl-2">this</span><span class="hl-1">.</span><span class="hl-6">app</span><span class="hl-1">.</span><span class="hl-7">listen</span><span class="hl-1">(</span><span class="hl-6">port</span><span class="hl-1">, () </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-6">console</span><span class="hl-1">.</span><span class="hl-7">log</span><span class="hl-1">(</span><span class="hl-5">`Server listening on port </span><span class="hl-2">${</span><span class="hl-6">port</span><span class="hl-2">}</span><span class="hl-5">`</span><span class="hl-1">)</span><br/><span class="hl-1">    })</span><br/><span class="hl-1">  }</span><br/><br/><span class="hl-1">  </span><span class="hl-9">/**</span><br/><span class="hl-9">   * Shuts down the server</span><br/><span class="hl-9">   */</span><br/><span class="hl-1">  </span><span class="hl-2">public</span><span class="hl-1"> </span><span class="hl-7">stop</span><span class="hl-1">(): </span><span class="hl-3">void</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-7">disconnect</span><span class="hl-1">()</span><br/><span class="hl-1">    </span><span class="hl-2">this</span><span class="hl-1">.</span><span class="hl-6">server</span><span class="hl-1">.</span><span class="hl-7">close</span><span class="hl-1">()</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">  </span><span class="hl-9">/* c8 ignore stop */</span><br/><br/><span class="hl-1">  </span><span class="hl-2">private</span><span class="hl-1"> </span><span class="hl-7">get</span><span class="hl-1"> = </span><span class="hl-2">async</span><span class="hl-1"> (</span><span class="hl-6">req</span><span class="hl-1">: </span><span class="hl-3">express</span><span class="hl-1">.</span><span class="hl-3">Request</span><span class="hl-1">, </span><span class="hl-6">res</span><span class="hl-1">: </span><span class="hl-3">express</span><span class="hl-1">.</span><span class="hl-3">Response</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-7">connect</span><span class="hl-1">(</span><span class="hl-6">process</span><span class="hl-1">.</span><span class="hl-6">env</span><span class="hl-1">.</span><span class="hl-4">MONGODB_URL</span><span class="hl-1">!)</span><br/><span class="hl-1">      .</span><span class="hl-7">then</span><span class="hl-1">(() </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-6">console</span><span class="hl-1">.</span><span class="hl-7">log</span><span class="hl-1">(</span><span class="hl-5">&#39;Connected to database &#39;</span><span class="hl-1"> + </span><span class="hl-6">process</span><span class="hl-1">.</span><span class="hl-6">env</span><span class="hl-1">.</span><span class="hl-4">MONGODB_URL</span><span class="hl-1">!)</span><br/><span class="hl-1">        </span><span class="hl-2">let</span><span class="hl-1"> </span><span class="hl-6">model</span><br/><span class="hl-1">        </span><span class="hl-2">let</span><span class="hl-1"> </span><span class="hl-6">url</span><span class="hl-1"> = </span><span class="hl-6">req</span><span class="hl-1">.</span><span class="hl-6">url</span><br/><span class="hl-1">        </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-6">req</span><span class="hl-1">.</span><span class="hl-6">url</span><span class="hl-1">.</span><span class="hl-7">includes</span><span class="hl-1">(</span><span class="hl-5">&#39;?&#39;</span><span class="hl-1">))</span><br/><span class="hl-1">          </span><span class="hl-6">url</span><span class="hl-1"> = </span><span class="hl-6">req</span><span class="hl-1">.</span><span class="hl-6">url</span><span class="hl-1">.</span><span class="hl-7">substring</span><span class="hl-1">(</span><span class="hl-8">0</span><span class="hl-1">, </span><span class="hl-6">req</span><span class="hl-1">.</span><span class="hl-6">url</span><span class="hl-1">.</span><span class="hl-7">indexOf</span><span class="hl-1">(</span><span class="hl-5">&#39;?&#39;</span><span class="hl-1">))</span><br/><span class="hl-1">        </span><span class="hl-0">switch</span><span class="hl-1"> (</span><span class="hl-6">url</span><span class="hl-1">) {</span><br/><span class="hl-1">          </span><span class="hl-0">case</span><span class="hl-1"> </span><span class="hl-5">&#39;/tracks&#39;</span><span class="hl-1">:</span><br/><span class="hl-1">            </span><span class="hl-6">model</span><span class="hl-1"> = </span><span class="hl-6">TrackModel</span><br/><span class="hl-1">            </span><span class="hl-0">break</span><br/><span class="hl-1">          </span><span class="hl-0">case</span><span class="hl-1"> </span><span class="hl-5">&#39;/users&#39;</span><span class="hl-1">:</span><br/><span class="hl-1">            </span><span class="hl-6">model</span><span class="hl-1"> = </span><span class="hl-6">UserModel</span><br/><span class="hl-1">            </span><span class="hl-0">break</span><br/><span class="hl-1">          </span><span class="hl-0">case</span><span class="hl-1"> </span><span class="hl-5">&#39;/groups&#39;</span><span class="hl-1">:</span><br/><span class="hl-1">            </span><span class="hl-6">model</span><span class="hl-1"> = </span><span class="hl-6">GroupModel</span><br/><span class="hl-1">            </span><span class="hl-0">break</span><br/><span class="hl-1">          </span><span class="hl-0">case</span><span class="hl-1"> </span><span class="hl-5">&#39;/challenges&#39;</span><span class="hl-1">:</span><br/><span class="hl-1">            </span><span class="hl-6">model</span><span class="hl-1"> = </span><span class="hl-6">ChallengeModel</span><br/><span class="hl-1">            </span><span class="hl-0">break</span><br/><span class="hl-1">          </span><span class="hl-0">default</span><span class="hl-1">:</span><br/><span class="hl-1">            </span><span class="hl-0">break</span><br/><span class="hl-1">        }</span><br/><span class="hl-1">        </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-6">model</span><span class="hl-1"> &amp;&amp; </span><span class="hl-6">req</span><span class="hl-1">.</span><span class="hl-6">params</span><span class="hl-1">.</span><span class="hl-6">id</span><span class="hl-1">)</span><br/><span class="hl-1">          </span><span class="hl-6">model</span><br/><span class="hl-1">            .</span><span class="hl-7">findById</span><span class="hl-1">(</span><span class="hl-6">req</span><span class="hl-1">.</span><span class="hl-6">params</span><span class="hl-1">.</span><span class="hl-6">id</span><span class="hl-1">)</span><br/><span class="hl-1">            .</span><span class="hl-7">then</span><span class="hl-1">((</span><span class="hl-6">result</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">              </span><span class="hl-2">this</span><span class="hl-1">.</span><span class="hl-7">searchResult</span><span class="hl-1">(</span><span class="hl-6">result</span><span class="hl-1">, </span><span class="hl-6">res</span><span class="hl-1">)</span><br/><span class="hl-1">            })</span><br/><span class="hl-1">            .</span><span class="hl-7">catch</span><span class="hl-1">((</span><span class="hl-6">err</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">              </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">500</span><span class="hl-1">).</span><span class="hl-7">json</span><span class="hl-1">({ </span><span class="hl-6">message:</span><span class="hl-1"> </span><span class="hl-6">err</span><span class="hl-1"> })</span><br/><span class="hl-1">            })</span><br/><span class="hl-1">        </span><span class="hl-0">else</span><span class="hl-1"> </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-6">model</span><span class="hl-1"> &amp;&amp; </span><span class="hl-6">req</span><span class="hl-1">.</span><span class="hl-6">query</span><span class="hl-1">.</span><span class="hl-6">name</span><span class="hl-1">)</span><br/><span class="hl-1">          </span><span class="hl-6">model</span><br/><span class="hl-1">            .</span><span class="hl-7">find</span><span class="hl-1">({ </span><span class="hl-6">name:</span><span class="hl-1"> </span><span class="hl-6">req</span><span class="hl-1">.</span><span class="hl-6">query</span><span class="hl-1">.</span><span class="hl-6">name</span><span class="hl-1">.</span><span class="hl-7">toString</span><span class="hl-1">() })</span><br/><span class="hl-1">            .</span><span class="hl-7">then</span><span class="hl-1">((</span><span class="hl-6">result</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">              </span><span class="hl-2">this</span><span class="hl-1">.</span><span class="hl-7">searchResult</span><span class="hl-1">(</span><span class="hl-6">result</span><span class="hl-1">, </span><span class="hl-6">res</span><span class="hl-1">)</span><br/><span class="hl-1">            })</span><br/><span class="hl-1">            .</span><span class="hl-7">catch</span><span class="hl-1">((</span><span class="hl-6">err</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">              </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">500</span><span class="hl-1">).</span><span class="hl-7">json</span><span class="hl-1">({ </span><span class="hl-6">message:</span><span class="hl-1"> </span><span class="hl-6">err</span><span class="hl-1"> })</span><br/><span class="hl-1">            })</span><br/><span class="hl-1">        </span><span class="hl-0">else</span><span class="hl-1"> </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-6">model</span><span class="hl-1">)</span><br/><span class="hl-1">          </span><span class="hl-6">model</span><br/><span class="hl-1">            .</span><span class="hl-7">find</span><span class="hl-1">()</span><br/><span class="hl-1">            .</span><span class="hl-7">then</span><span class="hl-1">((</span><span class="hl-6">result</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">              </span><span class="hl-2">this</span><span class="hl-1">.</span><span class="hl-7">searchResult</span><span class="hl-1">(</span><span class="hl-6">result</span><span class="hl-1">, </span><span class="hl-6">res</span><span class="hl-1">)</span><br/><span class="hl-1">            })</span><br/><span class="hl-1">            .</span><span class="hl-7">catch</span><span class="hl-1">((</span><span class="hl-6">err</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">              </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">500</span><span class="hl-1">).</span><span class="hl-7">json</span><span class="hl-1">({ </span><span class="hl-6">message:</span><span class="hl-1"> </span><span class="hl-6">err</span><span class="hl-1"> })</span><br/><span class="hl-1">            })</span><br/><span class="hl-1">        </span><span class="hl-0">else</span><span class="hl-1"> </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">400</span><span class="hl-1">).</span><span class="hl-7">json</span><span class="hl-1">({ </span><span class="hl-6">message:</span><span class="hl-1"> </span><span class="hl-5">&#39;Bad parameters&#39;</span><span class="hl-1"> })</span><br/><span class="hl-1">      })</span><br/><span class="hl-1">      .</span><span class="hl-7">catch</span><span class="hl-1">((</span><span class="hl-6">err</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-6">console</span><span class="hl-1">.</span><span class="hl-7">log</span><span class="hl-1">(</span><span class="hl-5">&#39;Error connecting to database: &#39;</span><span class="hl-1"> + </span><span class="hl-6">err</span><span class="hl-1">)</span><br/><span class="hl-1">      })</span><br/><span class="hl-1">  }</span><br/><br/><span class="hl-1">  </span><span class="hl-2">private</span><span class="hl-1"> </span><span class="hl-7">post</span><span class="hl-1"> = </span><span class="hl-2">async</span><span class="hl-1"> (</span><span class="hl-6">req</span><span class="hl-1">: </span><span class="hl-3">express</span><span class="hl-1">.</span><span class="hl-3">Request</span><span class="hl-1">, </span><span class="hl-6">res</span><span class="hl-1">: </span><span class="hl-3">express</span><span class="hl-1">.</span><span class="hl-3">Response</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-7">connect</span><span class="hl-1">(</span><span class="hl-6">process</span><span class="hl-1">.</span><span class="hl-6">env</span><span class="hl-1">.</span><span class="hl-4">MONGODB_URL</span><span class="hl-1">!)</span><br/><span class="hl-1">      .</span><span class="hl-7">then</span><span class="hl-1">(() </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-6">console</span><span class="hl-1">.</span><span class="hl-7">log</span><span class="hl-1">(</span><span class="hl-5">&#39;Connected to database &#39;</span><span class="hl-1"> + </span><span class="hl-6">process</span><span class="hl-1">.</span><span class="hl-6">env</span><span class="hl-1">.</span><span class="hl-4">MONGODB_URL</span><span class="hl-1">!)</span><br/><span class="hl-1">        </span><span class="hl-2">let</span><span class="hl-1"> </span><span class="hl-6">document</span><br/><span class="hl-1">        </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-4">url</span><span class="hl-1"> = </span><span class="hl-6">req</span><span class="hl-1">.</span><span class="hl-6">url</span><br/><span class="hl-1">        </span><span class="hl-2">let</span><span class="hl-1"> </span><span class="hl-6">body</span><span class="hl-1"> = </span><span class="hl-6">req</span><span class="hl-1">.</span><span class="hl-6">body</span><br/><span class="hl-1">        </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-6">url</span><span class="hl-1">.</span><span class="hl-7">includes</span><span class="hl-1">(</span><span class="hl-5">&#39;?&#39;</span><span class="hl-1">))</span><br/><span class="hl-1">          </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">400</span><span class="hl-1">).</span><span class="hl-7">json</span><span class="hl-1">({ </span><span class="hl-6">message:</span><span class="hl-1"> </span><span class="hl-5">&#39;Bad parameters&#39;</span><span class="hl-1"> })</span><br/><span class="hl-1">        </span><span class="hl-0">try</span><span class="hl-1"> {</span><br/><span class="hl-1">          </span><span class="hl-0">switch</span><span class="hl-1"> (</span><span class="hl-6">url</span><span class="hl-1">) {</span><br/><span class="hl-1">            </span><span class="hl-0">case</span><span class="hl-1"> </span><span class="hl-5">&#39;/tracks&#39;</span><span class="hl-1">:</span><br/><span class="hl-1">              </span><span class="hl-6">document</span><span class="hl-1"> = </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-7">TrackModel</span><span class="hl-1">(</span><span class="hl-6">body</span><span class="hl-1">)</span><br/><span class="hl-1">              </span><span class="hl-2">this</span><span class="hl-1">.</span><span class="hl-7">createReferencesToTrack</span><span class="hl-1">(</span><span class="hl-6">document</span><span class="hl-1">)</span><br/><span class="hl-1">              </span><span class="hl-0">break</span><br/><span class="hl-1">            </span><span class="hl-0">case</span><span class="hl-1"> </span><span class="hl-5">&#39;/users&#39;</span><span class="hl-1">:</span><br/><span class="hl-1">              </span><span class="hl-6">document</span><span class="hl-1"> = </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-7">UserModel</span><span class="hl-1">(</span><span class="hl-6">body</span><span class="hl-1">)</span><br/><span class="hl-1">              </span><span class="hl-2">this</span><span class="hl-1">.</span><span class="hl-7">createReferencesToUser</span><span class="hl-1">(</span><span class="hl-6">document</span><span class="hl-1">)</span><br/><span class="hl-1">              </span><span class="hl-0">break</span><br/><span class="hl-1">            </span><span class="hl-0">case</span><span class="hl-1"> </span><span class="hl-5">&#39;/groups&#39;</span><span class="hl-1">:</span><br/><span class="hl-1">              </span><span class="hl-6">body</span><span class="hl-1"> = </span><span class="hl-2">this</span><span class="hl-1">.</span><span class="hl-7">updateRanking</span><span class="hl-1">(</span><span class="hl-6">body</span><span class="hl-1">)</span><br/><span class="hl-1">              </span><span class="hl-6">document</span><span class="hl-1"> = </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-7">GroupModel</span><span class="hl-1">(</span><span class="hl-6">body</span><span class="hl-1">)</span><br/><span class="hl-1">              </span><span class="hl-2">this</span><span class="hl-1">.</span><span class="hl-7">createReferencesToGroup</span><span class="hl-1">(</span><span class="hl-6">document</span><span class="hl-1">)</span><br/><span class="hl-1">              </span><span class="hl-0">break</span><br/><span class="hl-1">            </span><span class="hl-0">case</span><span class="hl-1"> </span><span class="hl-5">&#39;/challenges&#39;</span><span class="hl-1">:</span><br/><span class="hl-1">              </span><span class="hl-6">document</span><span class="hl-1"> = </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-7">ChallengeModel</span><span class="hl-1">(</span><span class="hl-6">body</span><span class="hl-1">)</span><br/><span class="hl-1">              </span><span class="hl-2">this</span><span class="hl-1">.</span><span class="hl-7">createReferencesToChallenge</span><span class="hl-1">(</span><span class="hl-6">document</span><span class="hl-1">)</span><br/><span class="hl-1">              </span><span class="hl-0">break</span><br/><span class="hl-1">            </span><span class="hl-0">default</span><span class="hl-1">:</span><br/><span class="hl-1">              </span><span class="hl-0">break</span><br/><span class="hl-1">          }</span><br/><span class="hl-1">        } </span><span class="hl-0">catch</span><span class="hl-1"> (</span><span class="hl-6">err</span><span class="hl-1">) {</span><br/><span class="hl-1">          </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">400</span><span class="hl-1">).</span><span class="hl-7">json</span><span class="hl-1">({ </span><span class="hl-6">message:</span><span class="hl-1"> </span><span class="hl-5">&#39;Bad parameters&#39;</span><span class="hl-1">, </span><span class="hl-6">error:</span><span class="hl-1"> </span><span class="hl-6">err</span><span class="hl-1"> })</span><br/><span class="hl-1">        }</span><br/><span class="hl-1">        </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-6">document</span><span class="hl-1">) {</span><br/><span class="hl-1">          </span><span class="hl-6">document</span><br/><span class="hl-1">            .</span><span class="hl-7">save</span><span class="hl-1">()</span><br/><span class="hl-1">            .</span><span class="hl-7">then</span><span class="hl-1">((</span><span class="hl-6">result</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">              </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">201</span><span class="hl-1">).</span><span class="hl-7">json</span><span class="hl-1">({ </span><span class="hl-6">message:</span><span class="hl-1"> </span><span class="hl-5">&#39;Created&#39;</span><span class="hl-1">, </span><span class="hl-6">result:</span><span class="hl-1"> </span><span class="hl-6">result</span><span class="hl-1"> })</span><br/><span class="hl-1">            })</span><br/><span class="hl-1">            .</span><span class="hl-7">catch</span><span class="hl-1">((</span><span class="hl-6">err</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">              </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">500</span><span class="hl-1">).</span><span class="hl-7">json</span><span class="hl-1">({ </span><span class="hl-6">message:</span><span class="hl-1"> </span><span class="hl-6">err</span><span class="hl-1"> })</span><br/><span class="hl-1">            })</span><br/><span class="hl-1">        } </span><span class="hl-0">else</span><span class="hl-1"> </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">400</span><span class="hl-1">).</span><span class="hl-7">json</span><span class="hl-1">({ </span><span class="hl-6">message:</span><span class="hl-1"> </span><span class="hl-5">&#39;Bad parameters&#39;</span><span class="hl-1"> })</span><br/><span class="hl-1">      })</span><br/><span class="hl-1">      .</span><span class="hl-7">catch</span><span class="hl-1">((</span><span class="hl-6">err</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-6">console</span><span class="hl-1">.</span><span class="hl-7">log</span><span class="hl-1">(</span><span class="hl-5">&#39;Error connecting to database: &#39;</span><span class="hl-1"> + </span><span class="hl-6">err</span><span class="hl-1">)</span><br/><span class="hl-1">      })</span><br/><span class="hl-1">  }</span><br/><br/><span class="hl-1">  </span><span class="hl-2">private</span><span class="hl-1"> </span><span class="hl-7">createReferencesToTrack</span><span class="hl-1">(</span><span class="hl-6">document</span><span class="hl-1">: </span><span class="hl-3">any</span><span class="hl-1">): </span><span class="hl-3">void</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-6">UserModel</span><span class="hl-1">.</span><span class="hl-7">find</span><span class="hl-1">({ </span><span class="hl-6">_id:</span><span class="hl-1"> { </span><span class="hl-6">$in:</span><span class="hl-1"> </span><span class="hl-6">document</span><span class="hl-1">.</span><span class="hl-6">users</span><span class="hl-1"> } }).</span><span class="hl-7">then</span><span class="hl-1">((</span><span class="hl-6">users</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-6">users</span><span class="hl-1"> &amp;&amp; </span><span class="hl-6">document</span><span class="hl-1">.</span><span class="hl-6">users</span><span class="hl-1"> &amp;&amp; </span><span class="hl-6">users</span><span class="hl-1">.</span><span class="hl-6">length</span><span class="hl-1"> !== </span><span class="hl-6">document</span><span class="hl-1">.</span><span class="hl-6">users</span><span class="hl-1">.</span><span class="hl-6">length</span><span class="hl-1">)</span><br/><span class="hl-1">        </span><span class="hl-0">throw</span><span class="hl-1"> </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-7">Error</span><span class="hl-1">(</span><span class="hl-5">&#39;User not found&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">    })</span><br/><span class="hl-1">    </span><span class="hl-6">UserModel</span><span class="hl-1">.</span><span class="hl-7">updateMany</span><span class="hl-1">(</span><br/><span class="hl-1">      { </span><span class="hl-6">_id:</span><span class="hl-1"> { </span><span class="hl-6">$in:</span><span class="hl-1"> </span><span class="hl-6">document</span><span class="hl-1">.</span><span class="hl-6">users</span><span class="hl-1"> } },</span><br/><span class="hl-1">      { </span><span class="hl-6">$push:</span><span class="hl-1"> { </span><span class="hl-6">tracks:</span><span class="hl-1"> </span><span class="hl-6">document</span><span class="hl-1">.</span><span class="hl-6">_id</span><span class="hl-1"> } },</span><br/><span class="hl-1">      { </span><span class="hl-6">multi:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">, </span><span class="hl-6">runValidators:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1"> }</span><br/><span class="hl-1">    )</span><br/><span class="hl-1">  }</span><br/><br/><span class="hl-1">  </span><span class="hl-2">private</span><span class="hl-1"> </span><span class="hl-7">createReferencesToUser</span><span class="hl-1">(</span><span class="hl-6">document</span><span class="hl-1">: </span><span class="hl-3">any</span><span class="hl-1">): </span><span class="hl-3">void</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-6">TrackModel</span><span class="hl-1">.</span><span class="hl-7">find</span><span class="hl-1">({ </span><span class="hl-6">_id:</span><span class="hl-1"> { </span><span class="hl-6">$in:</span><span class="hl-1"> </span><span class="hl-6">document</span><span class="hl-1">.</span><span class="hl-6">tracks</span><span class="hl-1"> } }).</span><span class="hl-7">then</span><span class="hl-1">((</span><span class="hl-6">tracks</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-6">tracks</span><span class="hl-1"> &amp;&amp; </span><span class="hl-6">document</span><span class="hl-1">.</span><span class="hl-6">tracks</span><span class="hl-1"> &amp;&amp; </span><span class="hl-6">tracks</span><span class="hl-1">.</span><span class="hl-6">length</span><span class="hl-1"> !== </span><span class="hl-6">document</span><span class="hl-1">.</span><span class="hl-6">tracks</span><span class="hl-1">.</span><span class="hl-6">length</span><span class="hl-1">)</span><br/><span class="hl-1">        </span><span class="hl-0">throw</span><span class="hl-1"> </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-7">Error</span><span class="hl-1">(</span><span class="hl-5">&#39;Track not found&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">    })</span><br/><span class="hl-1">    </span><span class="hl-6">TrackModel</span><span class="hl-1">.</span><span class="hl-7">updateMany</span><span class="hl-1">(</span><br/><span class="hl-1">      { </span><span class="hl-6">_id:</span><span class="hl-1"> { </span><span class="hl-6">$in:</span><span class="hl-1"> </span><span class="hl-6">document</span><span class="hl-1">.</span><span class="hl-6">tracks</span><span class="hl-1"> } },</span><br/><span class="hl-1">      { </span><span class="hl-6">$push:</span><span class="hl-1"> { </span><span class="hl-6">users:</span><span class="hl-1"> </span><span class="hl-6">document</span><span class="hl-1">.</span><span class="hl-6">_id</span><span class="hl-1"> } },</span><br/><span class="hl-1">      { </span><span class="hl-6">multi:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">, </span><span class="hl-6">runValidators:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1"> }</span><br/><span class="hl-1">    )</span><br/><span class="hl-1">    </span><span class="hl-6">ChallengeModel</span><span class="hl-1">.</span><span class="hl-7">find</span><span class="hl-1">({ </span><span class="hl-6">_id:</span><span class="hl-1"> { </span><span class="hl-6">$in:</span><span class="hl-1"> </span><span class="hl-6">document</span><span class="hl-1">.</span><span class="hl-6">challenges</span><span class="hl-1"> } }).</span><span class="hl-7">then</span><span class="hl-1">(</span><br/><span class="hl-1">      (</span><span class="hl-6">challenges</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-0">if</span><span class="hl-1"> (</span><br/><span class="hl-1">          </span><span class="hl-6">challenges</span><span class="hl-1"> &amp;&amp;</span><br/><span class="hl-1">          </span><span class="hl-6">document</span><span class="hl-1">.</span><span class="hl-6">challenges</span><span class="hl-1"> &amp;&amp;</span><br/><span class="hl-1">          </span><span class="hl-6">challenges</span><span class="hl-1">.</span><span class="hl-6">length</span><span class="hl-1"> !== </span><span class="hl-6">document</span><span class="hl-1">.</span><span class="hl-6">challenges</span><span class="hl-1">.</span><span class="hl-6">length</span><br/><span class="hl-1">        )</span><br/><span class="hl-1">          </span><span class="hl-0">throw</span><span class="hl-1"> </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-7">Error</span><span class="hl-1">(</span><span class="hl-5">&#39;Challenge not found&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">      }</span><br/><span class="hl-1">    )</span><br/><span class="hl-1">    </span><span class="hl-6">ChallengeModel</span><span class="hl-1">.</span><span class="hl-7">updateMany</span><span class="hl-1">(</span><br/><span class="hl-1">      { </span><span class="hl-6">_id:</span><span class="hl-1"> { </span><span class="hl-6">$in:</span><span class="hl-1"> </span><span class="hl-6">document</span><span class="hl-1">.</span><span class="hl-6">challenges</span><span class="hl-1"> } },</span><br/><span class="hl-1">      { </span><span class="hl-6">$push:</span><span class="hl-1"> { </span><span class="hl-6">users:</span><span class="hl-1"> </span><span class="hl-6">document</span><span class="hl-1">.</span><span class="hl-6">_id</span><span class="hl-1"> } },</span><br/><span class="hl-1">      { </span><span class="hl-6">multi:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">, </span><span class="hl-6">runValidators:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1"> }</span><br/><span class="hl-1">    )</span><br/><span class="hl-1">    </span><span class="hl-6">GroupModel</span><span class="hl-1">.</span><span class="hl-7">find</span><span class="hl-1">({ </span><span class="hl-6">_id:</span><span class="hl-1"> { </span><span class="hl-6">$in:</span><span class="hl-1"> </span><span class="hl-6">document</span><span class="hl-1">.</span><span class="hl-6">groups</span><span class="hl-1"> } }).</span><span class="hl-7">then</span><span class="hl-1">((</span><span class="hl-6">groups</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-6">groups</span><span class="hl-1"> &amp;&amp; </span><span class="hl-6">document</span><span class="hl-1">.</span><span class="hl-6">groups</span><span class="hl-1"> &amp;&amp; </span><span class="hl-6">groups</span><span class="hl-1">.</span><span class="hl-6">length</span><span class="hl-1"> !== </span><span class="hl-6">document</span><span class="hl-1">.</span><span class="hl-6">groups</span><span class="hl-1">.</span><span class="hl-6">length</span><span class="hl-1">)</span><br/><span class="hl-1">        </span><span class="hl-0">throw</span><span class="hl-1"> </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-7">Error</span><span class="hl-1">(</span><span class="hl-5">&#39;Group not found&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">    })</span><br/><span class="hl-1">    </span><span class="hl-6">GroupModel</span><span class="hl-1">.</span><span class="hl-7">updateMany</span><span class="hl-1">(</span><br/><span class="hl-1">      { </span><span class="hl-6">_id:</span><span class="hl-1"> { </span><span class="hl-6">$in:</span><span class="hl-1"> </span><span class="hl-6">document</span><span class="hl-1">.</span><span class="hl-6">groups</span><span class="hl-1"> } },</span><br/><span class="hl-1">      { </span><span class="hl-6">$push:</span><span class="hl-1"> { </span><span class="hl-6">users:</span><span class="hl-1"> </span><span class="hl-6">document</span><span class="hl-1">.</span><span class="hl-6">_id</span><span class="hl-1"> } },</span><br/><span class="hl-1">      { </span><span class="hl-6">multi:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">, </span><span class="hl-6">runValidators:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1"> }</span><br/><span class="hl-1">    )</span><br/><span class="hl-1">  }</span><br/><br/><span class="hl-1">  </span><span class="hl-2">private</span><span class="hl-1"> </span><span class="hl-7">createReferencesToGroup</span><span class="hl-1">(</span><span class="hl-6">document</span><span class="hl-1">: </span><span class="hl-3">any</span><span class="hl-1">): </span><span class="hl-3">void</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-6">UserModel</span><span class="hl-1">.</span><span class="hl-7">find</span><span class="hl-1">({ </span><span class="hl-6">_id:</span><span class="hl-1"> { </span><span class="hl-6">$in:</span><span class="hl-1"> </span><span class="hl-6">document</span><span class="hl-1">.</span><span class="hl-6">users</span><span class="hl-1"> } }).</span><span class="hl-7">then</span><span class="hl-1">((</span><span class="hl-6">users</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-6">users</span><span class="hl-1"> &amp;&amp; </span><span class="hl-6">document</span><span class="hl-1">.</span><span class="hl-6">users</span><span class="hl-1"> &amp;&amp; </span><span class="hl-6">users</span><span class="hl-1">.</span><span class="hl-6">length</span><span class="hl-1"> !== </span><span class="hl-6">document</span><span class="hl-1">.</span><span class="hl-6">users</span><span class="hl-1">.</span><span class="hl-6">length</span><span class="hl-1">)</span><br/><span class="hl-1">        </span><span class="hl-0">throw</span><span class="hl-1"> </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-7">Error</span><span class="hl-1">(</span><span class="hl-5">&#39;User not found&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">    })</span><br/><span class="hl-1">    </span><span class="hl-6">UserModel</span><span class="hl-1">.</span><span class="hl-7">updateMany</span><span class="hl-1">(</span><br/><span class="hl-1">      { </span><span class="hl-6">_id:</span><span class="hl-1"> { </span><span class="hl-6">$in:</span><span class="hl-1"> </span><span class="hl-6">document</span><span class="hl-1">.</span><span class="hl-6">users</span><span class="hl-1"> } },</span><br/><span class="hl-1">      { </span><span class="hl-6">$push:</span><span class="hl-1"> { </span><span class="hl-6">groups:</span><span class="hl-1"> </span><span class="hl-6">document</span><span class="hl-1">.</span><span class="hl-6">_id</span><span class="hl-1"> } },</span><br/><span class="hl-1">      { </span><span class="hl-6">multi:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">, </span><span class="hl-6">runValidators:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1"> }</span><br/><span class="hl-1">    )</span><br/><span class="hl-1">  }</span><br/><br/><span class="hl-1">  </span><span class="hl-2">private</span><span class="hl-1"> </span><span class="hl-7">createReferencesToChallenge</span><span class="hl-1">(</span><span class="hl-6">document</span><span class="hl-1">: </span><span class="hl-3">any</span><span class="hl-1">): </span><span class="hl-3">void</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-6">UserModel</span><span class="hl-1">.</span><span class="hl-7">find</span><span class="hl-1">({ </span><span class="hl-6">_id:</span><span class="hl-1"> { </span><span class="hl-6">$in:</span><span class="hl-1"> </span><span class="hl-6">document</span><span class="hl-1">.</span><span class="hl-6">users</span><span class="hl-1"> } }).</span><span class="hl-7">then</span><span class="hl-1">((</span><span class="hl-6">users</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-6">users</span><span class="hl-1"> &amp;&amp; </span><span class="hl-6">document</span><span class="hl-1">.</span><span class="hl-6">users</span><span class="hl-1"> &amp;&amp; </span><span class="hl-6">users</span><span class="hl-1">.</span><span class="hl-6">length</span><span class="hl-1"> !== </span><span class="hl-6">document</span><span class="hl-1">.</span><span class="hl-6">users</span><span class="hl-1">.</span><span class="hl-6">length</span><span class="hl-1">)</span><br/><span class="hl-1">        </span><span class="hl-0">throw</span><span class="hl-1"> </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-7">Error</span><span class="hl-1">(</span><span class="hl-5">&#39;User not found&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">    })</span><br/><span class="hl-1">    </span><span class="hl-6">UserModel</span><span class="hl-1">.</span><span class="hl-7">updateMany</span><span class="hl-1">(</span><br/><span class="hl-1">      { </span><span class="hl-6">_id:</span><span class="hl-1"> { </span><span class="hl-6">$in:</span><span class="hl-1"> </span><span class="hl-6">document</span><span class="hl-1">.</span><span class="hl-6">users</span><span class="hl-1"> } },</span><br/><span class="hl-1">      { </span><span class="hl-6">$push:</span><span class="hl-1"> { </span><span class="hl-6">challenges:</span><span class="hl-1"> </span><span class="hl-6">document</span><span class="hl-1">.</span><span class="hl-6">_id</span><span class="hl-1"> } },</span><br/><span class="hl-1">      { </span><span class="hl-6">multi:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">, </span><span class="hl-6">runValidators:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1"> }</span><br/><span class="hl-1">    )</span><br/><span class="hl-1">  }</span><br/><br/><span class="hl-1">  </span><span class="hl-2">private</span><span class="hl-1"> </span><span class="hl-7">delete</span><span class="hl-1"> = </span><span class="hl-2">async</span><span class="hl-1"> (</span><span class="hl-6">req</span><span class="hl-1">: </span><span class="hl-3">express</span><span class="hl-1">.</span><span class="hl-3">Request</span><span class="hl-1">, </span><span class="hl-6">res</span><span class="hl-1">: </span><span class="hl-3">express</span><span class="hl-1">.</span><span class="hl-3">Response</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-7">connect</span><span class="hl-1">(</span><span class="hl-6">process</span><span class="hl-1">.</span><span class="hl-6">env</span><span class="hl-1">.</span><span class="hl-4">MONGODB_URL</span><span class="hl-1">!)</span><br/><span class="hl-1">      .</span><span class="hl-7">then</span><span class="hl-1">(() </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-6">console</span><span class="hl-1">.</span><span class="hl-7">log</span><span class="hl-1">(</span><span class="hl-5">&#39;Connected to database &#39;</span><span class="hl-1"> + </span><span class="hl-6">process</span><span class="hl-1">.</span><span class="hl-6">env</span><span class="hl-1">.</span><span class="hl-4">MONGODB_URL</span><span class="hl-1">!)</span><br/><span class="hl-1">        </span><span class="hl-2">let</span><span class="hl-1"> </span><span class="hl-6">model</span><br/><span class="hl-1">        </span><span class="hl-2">let</span><span class="hl-1"> </span><span class="hl-6">url</span><span class="hl-1"> = </span><span class="hl-6">req</span><span class="hl-1">.</span><span class="hl-6">url</span><br/><span class="hl-1">        </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-6">req</span><span class="hl-1">.</span><span class="hl-6">url</span><span class="hl-1">.</span><span class="hl-7">includes</span><span class="hl-1">(</span><span class="hl-5">&#39;?&#39;</span><span class="hl-1">))</span><br/><span class="hl-1">          </span><span class="hl-6">url</span><span class="hl-1"> = </span><span class="hl-6">req</span><span class="hl-1">.</span><span class="hl-6">url</span><span class="hl-1">.</span><span class="hl-7">substring</span><span class="hl-1">(</span><span class="hl-8">0</span><span class="hl-1">, </span><span class="hl-6">req</span><span class="hl-1">.</span><span class="hl-6">url</span><span class="hl-1">.</span><span class="hl-7">indexOf</span><span class="hl-1">(</span><span class="hl-5">&#39;?&#39;</span><span class="hl-1">))</span><br/><span class="hl-1">        </span><span class="hl-0">switch</span><span class="hl-1"> (</span><span class="hl-6">url</span><span class="hl-1">) {</span><br/><span class="hl-1">          </span><span class="hl-0">case</span><span class="hl-1"> </span><span class="hl-5">&#39;/tracks&#39;</span><span class="hl-1">:</span><br/><span class="hl-1">            </span><span class="hl-6">model</span><span class="hl-1"> = </span><span class="hl-6">TrackModel</span><br/><span class="hl-1">            </span><span class="hl-0">break</span><br/><span class="hl-1">          </span><span class="hl-0">case</span><span class="hl-1"> </span><span class="hl-5">&#39;/users&#39;</span><span class="hl-1">:</span><br/><span class="hl-1">            </span><span class="hl-6">model</span><span class="hl-1"> = </span><span class="hl-6">UserModel</span><br/><span class="hl-1">            </span><span class="hl-0">break</span><br/><span class="hl-1">          </span><span class="hl-0">case</span><span class="hl-1"> </span><span class="hl-5">&#39;/groups&#39;</span><span class="hl-1">:</span><br/><span class="hl-1">            </span><span class="hl-6">model</span><span class="hl-1"> = </span><span class="hl-6">GroupModel</span><br/><span class="hl-1">            </span><span class="hl-0">break</span><br/><span class="hl-1">          </span><span class="hl-0">case</span><span class="hl-1"> </span><span class="hl-5">&#39;/challenges&#39;</span><span class="hl-1">:</span><br/><span class="hl-1">            </span><span class="hl-6">model</span><span class="hl-1"> = </span><span class="hl-6">ChallengeModel</span><br/><span class="hl-1">            </span><span class="hl-0">break</span><br/><span class="hl-1">          </span><span class="hl-0">default</span><span class="hl-1">:</span><br/><span class="hl-1">            </span><span class="hl-0">break</span><br/><span class="hl-1">        }</span><br/><span class="hl-1">        </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-6">model</span><span class="hl-1"> &amp;&amp; </span><span class="hl-6">req</span><span class="hl-1">.</span><span class="hl-6">params</span><span class="hl-1">.</span><span class="hl-6">id</span><span class="hl-1">) {</span><br/><span class="hl-1">          </span><span class="hl-6">model</span><br/><span class="hl-1">            .</span><span class="hl-7">deleteOne</span><span class="hl-1">({ </span><span class="hl-6">id:</span><span class="hl-1"> </span><span class="hl-7">parseInt</span><span class="hl-1">(</span><span class="hl-6">req</span><span class="hl-1">.</span><span class="hl-6">params</span><span class="hl-1">.</span><span class="hl-6">id</span><span class="hl-1"> </span><span class="hl-0">as</span><span class="hl-1"> </span><span class="hl-3">string</span><span class="hl-1">) })</span><br/><span class="hl-1">            .</span><span class="hl-7">then</span><span class="hl-1">((</span><span class="hl-6">result</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">              </span><span class="hl-2">this</span><span class="hl-1">.</span><span class="hl-7">deleteReferencesFromUser</span><span class="hl-1">(</span><span class="hl-6">req</span><span class="hl-1">.</span><span class="hl-6">params</span><span class="hl-1">.</span><span class="hl-6">id</span><span class="hl-1">)</span><br/><span class="hl-1">              </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">200</span><span class="hl-1">).</span><span class="hl-7">json</span><span class="hl-1">({ </span><span class="hl-6">message:</span><span class="hl-1"> </span><span class="hl-5">&#39;Deleted&#39;</span><span class="hl-1">, </span><span class="hl-6">result:</span><span class="hl-1"> </span><span class="hl-6">result</span><span class="hl-1"> })</span><br/><span class="hl-1">            })</span><br/><span class="hl-1">            .</span><span class="hl-7">catch</span><span class="hl-1">((</span><span class="hl-6">err</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">              </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">500</span><span class="hl-1">).</span><span class="hl-7">json</span><span class="hl-1">({ </span><span class="hl-6">message:</span><span class="hl-1"> </span><span class="hl-6">err</span><span class="hl-1"> })</span><br/><span class="hl-1">            })</span><br/><span class="hl-1">        } </span><span class="hl-0">else</span><span class="hl-1"> </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-6">model</span><span class="hl-1"> &amp;&amp; </span><span class="hl-6">req</span><span class="hl-1">.</span><span class="hl-6">query</span><span class="hl-1">.</span><span class="hl-6">name</span><span class="hl-1">) {</span><br/><span class="hl-1">          </span><span class="hl-6">model</span><br/><span class="hl-1">            .</span><span class="hl-7">findOne</span><span class="hl-1">({ </span><span class="hl-6">name:</span><span class="hl-1"> </span><span class="hl-6">req</span><span class="hl-1">.</span><span class="hl-6">query</span><span class="hl-1">.</span><span class="hl-6">name</span><span class="hl-1"> })</span><br/><span class="hl-1">            .</span><span class="hl-7">then</span><span class="hl-1">((</span><span class="hl-6">result</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">              </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-6">result</span><span class="hl-1">) {</span><br/><span class="hl-1">                </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-6">model</span><span class="hl-1"> === </span><span class="hl-6">UserModel</span><span class="hl-1">)</span><br/><span class="hl-1">                  </span><span class="hl-2">this</span><span class="hl-1">.</span><span class="hl-7">deleteReferencesFromUser</span><span class="hl-1">(</span><span class="hl-6">result</span><span class="hl-1">.</span><span class="hl-6">id</span><span class="hl-1">)</span><br/><span class="hl-1">              }</span><br/><span class="hl-1">            })</span><br/><span class="hl-1">            .</span><span class="hl-7">catch</span><span class="hl-1">((</span><span class="hl-6">err</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">              </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">500</span><span class="hl-1">).</span><span class="hl-7">json</span><span class="hl-1">({ </span><span class="hl-6">message:</span><span class="hl-1"> </span><span class="hl-6">err</span><span class="hl-1"> })</span><br/><span class="hl-1">            })</span><br/><span class="hl-1">          </span><span class="hl-6">model</span><br/><span class="hl-1">            .</span><span class="hl-7">deleteOne</span><span class="hl-1">({ </span><span class="hl-6">name:</span><span class="hl-1"> </span><span class="hl-6">req</span><span class="hl-1">.</span><span class="hl-6">query</span><span class="hl-1">.</span><span class="hl-6">name</span><span class="hl-1"> })</span><br/><span class="hl-1">            .</span><span class="hl-7">then</span><span class="hl-1">((</span><span class="hl-6">result</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">              </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-6">result</span><span class="hl-1">.</span><span class="hl-6">deletedCount</span><span class="hl-1"> === </span><span class="hl-8">0</span><span class="hl-1">)</span><br/><span class="hl-1">                </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">404</span><span class="hl-1">).</span><span class="hl-7">json</span><span class="hl-1">({ </span><span class="hl-6">message:</span><span class="hl-1"> </span><span class="hl-5">&#39;Not found&#39;</span><span class="hl-1"> })</span><br/><span class="hl-1">              </span><span class="hl-0">else</span><span class="hl-1"> </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">200</span><span class="hl-1">).</span><span class="hl-7">json</span><span class="hl-1">({ </span><span class="hl-6">message:</span><span class="hl-1"> </span><span class="hl-5">&#39;Deleted&#39;</span><span class="hl-1">, </span><span class="hl-6">result:</span><span class="hl-1"> </span><span class="hl-6">result</span><span class="hl-1"> })</span><br/><span class="hl-1">            })</span><br/><span class="hl-1">            .</span><span class="hl-7">catch</span><span class="hl-1">((</span><span class="hl-6">err</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">              </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">500</span><span class="hl-1">).</span><span class="hl-7">json</span><span class="hl-1">({ </span><span class="hl-6">message:</span><span class="hl-1"> </span><span class="hl-6">err</span><span class="hl-1"> })</span><br/><span class="hl-1">            })</span><br/><span class="hl-1">        } </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">          </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">400</span><span class="hl-1">).</span><span class="hl-7">json</span><span class="hl-1">({ </span><span class="hl-6">message:</span><span class="hl-1"> </span><span class="hl-5">&#39;Bad parameters&#39;</span><span class="hl-1"> })</span><br/><span class="hl-1">        }</span><br/><span class="hl-1">      })</span><br/><span class="hl-1">      .</span><span class="hl-7">catch</span><span class="hl-1">((</span><span class="hl-6">err</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-6">console</span><span class="hl-1">.</span><span class="hl-7">log</span><span class="hl-1">(</span><span class="hl-5">&#39;Error connecting to database: &#39;</span><span class="hl-1"> + </span><span class="hl-6">err</span><span class="hl-1">)</span><br/><span class="hl-1">      })</span><br/><span class="hl-1">  }</span><br/><br/><span class="hl-1">  </span><span class="hl-2">private</span><span class="hl-1"> </span><span class="hl-7">deleteReferencesFromUser</span><span class="hl-1">(</span><span class="hl-6">id</span><span class="hl-1">: </span><span class="hl-3">string</span><span class="hl-1">): </span><span class="hl-3">void</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-6">TrackModel</span><span class="hl-1">.</span><span class="hl-7">find</span><span class="hl-1">({ </span><span class="hl-6">users:</span><span class="hl-1"> { </span><span class="hl-6">$in:</span><span class="hl-1"> [</span><span class="hl-6">id</span><span class="hl-1">] } }).</span><span class="hl-7">then</span><span class="hl-1">((</span><span class="hl-6">tracks</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-6">tracks</span><span class="hl-1">.</span><span class="hl-7">forEach</span><span class="hl-1">((</span><span class="hl-6">track</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-6">track</span><span class="hl-1">.</span><span class="hl-6">users</span><span class="hl-1"> = </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-7">UniqueList</span><span class="hl-1">&lt;</span><span class="hl-3">string</span><span class="hl-1">&gt;(</span><br/><span class="hl-1">          ...</span><span class="hl-6">track</span><span class="hl-1">.</span><span class="hl-6">users</span><span class="hl-1">.</span><span class="hl-7">filter</span><span class="hl-1">((</span><span class="hl-6">user</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> </span><span class="hl-6">user</span><span class="hl-1"> !== </span><span class="hl-6">id</span><span class="hl-1">)</span><br/><span class="hl-1">        )</span><br/><span class="hl-1">        </span><span class="hl-6">track</span><span class="hl-1">.</span><span class="hl-7">save</span><span class="hl-1">()</span><br/><span class="hl-1">      })</span><br/><span class="hl-1">    })</span><br/><span class="hl-1">    </span><span class="hl-6">UserModel</span><span class="hl-1">.</span><span class="hl-7">find</span><span class="hl-1">({ </span><span class="hl-6">users:</span><span class="hl-1"> { </span><span class="hl-6">$in:</span><span class="hl-1"> [</span><span class="hl-6">id</span><span class="hl-1">] } }).</span><span class="hl-7">then</span><span class="hl-1">((</span><span class="hl-6">users</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-6">users</span><span class="hl-1">.</span><span class="hl-7">forEach</span><span class="hl-1">((</span><span class="hl-6">user</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-6">user</span><span class="hl-1">.</span><span class="hl-6">users</span><span class="hl-1"> = </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-7">UniqueList</span><span class="hl-1">&lt;</span><span class="hl-3">string</span><span class="hl-1">&gt;(</span><br/><span class="hl-1">          ...</span><span class="hl-6">user</span><span class="hl-1">.</span><span class="hl-6">users</span><span class="hl-1">.</span><span class="hl-7">filter</span><span class="hl-1">((</span><span class="hl-6">friend</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> </span><span class="hl-6">friend</span><span class="hl-1"> !== </span><span class="hl-6">id</span><span class="hl-1">)</span><br/><span class="hl-1">        )</span><br/><span class="hl-1">        </span><span class="hl-6">user</span><span class="hl-1">.</span><span class="hl-7">save</span><span class="hl-1">()</span><br/><span class="hl-1">      })</span><br/><span class="hl-1">    })</span><br/><span class="hl-1">    </span><span class="hl-6">GroupModel</span><span class="hl-1">.</span><span class="hl-7">find</span><span class="hl-1">({ </span><span class="hl-6">users:</span><span class="hl-1"> { </span><span class="hl-6">$in:</span><span class="hl-1"> [</span><span class="hl-6">id</span><span class="hl-1">] } }).</span><span class="hl-7">then</span><span class="hl-1">((</span><span class="hl-6">groups</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-6">groups</span><span class="hl-1">.</span><span class="hl-7">forEach</span><span class="hl-1">((</span><span class="hl-6">group</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-6">group</span><span class="hl-1">.</span><span class="hl-6">users</span><span class="hl-1"> = </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-7">UniqueList</span><span class="hl-1">&lt;</span><span class="hl-3">string</span><span class="hl-1">&gt;(</span><br/><span class="hl-1">          ...</span><span class="hl-6">group</span><span class="hl-1">.</span><span class="hl-6">users</span><span class="hl-1">.</span><span class="hl-7">filter</span><span class="hl-1">((</span><span class="hl-6">member</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> </span><span class="hl-6">member</span><span class="hl-1"> !== </span><span class="hl-6">id</span><span class="hl-1">)</span><br/><span class="hl-1">        )</span><br/><span class="hl-1">        </span><span class="hl-6">group</span><span class="hl-1">.</span><span class="hl-6">ranking</span><span class="hl-1">.</span><span class="hl-7">splice</span><span class="hl-1">(</span><span class="hl-6">group</span><span class="hl-1">.</span><span class="hl-6">ranking</span><span class="hl-1">.</span><span class="hl-7">indexOf</span><span class="hl-1">(</span><span class="hl-6">id</span><span class="hl-1">), </span><span class="hl-8">1</span><span class="hl-1">)</span><br/><span class="hl-1">        </span><span class="hl-6">group</span><span class="hl-1">.</span><span class="hl-6">records</span><span class="hl-1">.</span><span class="hl-7">forEach</span><span class="hl-1">((</span><span class="hl-6">record</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">          </span><span class="hl-6">record</span><span class="hl-1">.</span><span class="hl-6">users</span><span class="hl-1">.</span><span class="hl-7">splice</span><span class="hl-1">(</span><span class="hl-6">record</span><span class="hl-1">.</span><span class="hl-6">users</span><span class="hl-1">.</span><span class="hl-7">indexOf</span><span class="hl-1">(</span><span class="hl-6">id</span><span class="hl-1">), </span><span class="hl-8">1</span><span class="hl-1">)</span><br/><span class="hl-1">        })</span><br/><span class="hl-1">      })</span><br/><span class="hl-1">    })</span><br/><span class="hl-1">    </span><span class="hl-6">ChallengeModel</span><span class="hl-1">.</span><span class="hl-7">find</span><span class="hl-1">({ </span><span class="hl-6">users:</span><span class="hl-1"> { </span><span class="hl-6">$in:</span><span class="hl-1"> [</span><span class="hl-6">id</span><span class="hl-1">] } }).</span><span class="hl-7">then</span><span class="hl-1">((</span><span class="hl-6">challenges</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-6">challenges</span><span class="hl-1">.</span><span class="hl-7">forEach</span><span class="hl-1">((</span><span class="hl-6">challenge</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-6">challenge</span><span class="hl-1">.</span><span class="hl-6">users</span><span class="hl-1"> = </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-7">UniqueList</span><span class="hl-1">&lt;</span><span class="hl-3">string</span><span class="hl-1">&gt;(</span><br/><span class="hl-1">          ...</span><span class="hl-6">challenge</span><span class="hl-1">.</span><span class="hl-6">users</span><span class="hl-1">.</span><span class="hl-7">filter</span><span class="hl-1">((</span><span class="hl-6">user</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> </span><span class="hl-6">user</span><span class="hl-1"> !== </span><span class="hl-6">id</span><span class="hl-1">)</span><br/><span class="hl-1">        )</span><br/><span class="hl-1">      })</span><br/><span class="hl-1">    })</span><br/><span class="hl-1">  }</span><br/><br/><span class="hl-1">  </span><span class="hl-2">private</span><span class="hl-1"> </span><span class="hl-7">patch</span><span class="hl-1"> = </span><span class="hl-2">async</span><span class="hl-1"> (</span><span class="hl-6">req</span><span class="hl-1">: </span><span class="hl-3">express</span><span class="hl-1">.</span><span class="hl-3">Request</span><span class="hl-1">, </span><span class="hl-6">res</span><span class="hl-1">: </span><span class="hl-3">express</span><span class="hl-1">.</span><span class="hl-3">Response</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-7">connect</span><span class="hl-1">(</span><span class="hl-6">process</span><span class="hl-1">.</span><span class="hl-6">env</span><span class="hl-1">.</span><span class="hl-4">MONGODB_URL</span><span class="hl-1">!)</span><br/><span class="hl-1">      .</span><span class="hl-7">then</span><span class="hl-1">(() </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-6">console</span><span class="hl-1">.</span><span class="hl-7">log</span><span class="hl-1">(</span><span class="hl-5">&#39;Connected to database &#39;</span><span class="hl-1"> + </span><span class="hl-6">process</span><span class="hl-1">.</span><span class="hl-6">env</span><span class="hl-1">.</span><span class="hl-4">MONGODB_URL</span><span class="hl-1">!)</span><br/><span class="hl-1">        </span><span class="hl-2">let</span><span class="hl-1"> </span><span class="hl-6">model</span><br/><span class="hl-1">        </span><span class="hl-2">let</span><span class="hl-1"> </span><span class="hl-6">url</span><span class="hl-1"> = </span><span class="hl-6">req</span><span class="hl-1">.</span><span class="hl-6">url</span><br/><span class="hl-1">        </span><span class="hl-2">let</span><span class="hl-1"> </span><span class="hl-6">body</span><span class="hl-1"> = </span><span class="hl-6">req</span><span class="hl-1">.</span><span class="hl-6">body</span><br/><span class="hl-1">        </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-6">req</span><span class="hl-1">.</span><span class="hl-6">url</span><span class="hl-1">.</span><span class="hl-7">includes</span><span class="hl-1">(</span><span class="hl-5">&#39;?&#39;</span><span class="hl-1">))</span><br/><span class="hl-1">          </span><span class="hl-6">url</span><span class="hl-1"> = </span><span class="hl-6">req</span><span class="hl-1">.</span><span class="hl-6">url</span><span class="hl-1">.</span><span class="hl-7">substring</span><span class="hl-1">(</span><span class="hl-8">0</span><span class="hl-1">, </span><span class="hl-6">req</span><span class="hl-1">.</span><span class="hl-6">url</span><span class="hl-1">.</span><span class="hl-7">indexOf</span><span class="hl-1">(</span><span class="hl-5">&#39;?&#39;</span><span class="hl-1">))</span><br/><span class="hl-1">        </span><span class="hl-0">switch</span><span class="hl-1"> (</span><span class="hl-6">url</span><span class="hl-1">) {</span><br/><span class="hl-1">          </span><span class="hl-0">case</span><span class="hl-1"> </span><span class="hl-5">&#39;/tracks&#39;</span><span class="hl-1">:</span><br/><span class="hl-1">            </span><span class="hl-6">model</span><span class="hl-1"> = </span><span class="hl-6">TrackModel</span><br/><span class="hl-1">            </span><span class="hl-0">break</span><br/><span class="hl-1">          </span><span class="hl-0">case</span><span class="hl-1"> </span><span class="hl-5">&#39;/users&#39;</span><span class="hl-1">:</span><br/><span class="hl-1">            </span><span class="hl-6">model</span><span class="hl-1"> = </span><span class="hl-6">UserModel</span><br/><span class="hl-1">            </span><span class="hl-0">break</span><br/><span class="hl-1">          </span><span class="hl-0">case</span><span class="hl-1"> </span><span class="hl-5">&#39;/groups&#39;</span><span class="hl-1">:</span><br/><span class="hl-1">            </span><span class="hl-6">model</span><span class="hl-1"> = </span><span class="hl-6">GroupModel</span><br/><span class="hl-1">            </span><span class="hl-6">body</span><span class="hl-1"> = </span><span class="hl-2">this</span><span class="hl-1">.</span><span class="hl-7">updateRanking</span><span class="hl-1">(</span><span class="hl-6">body</span><span class="hl-1">)</span><br/><span class="hl-1">            </span><span class="hl-0">break</span><br/><span class="hl-1">          </span><span class="hl-0">case</span><span class="hl-1"> </span><span class="hl-5">&#39;/challenges&#39;</span><span class="hl-1">:</span><br/><span class="hl-1">            </span><span class="hl-6">model</span><span class="hl-1"> = </span><span class="hl-6">ChallengeModel</span><br/><span class="hl-1">            </span><span class="hl-0">break</span><br/><span class="hl-1">          </span><span class="hl-0">default</span><span class="hl-1">:</span><br/><span class="hl-1">            </span><span class="hl-0">break</span><br/><span class="hl-1">        }</span><br/><span class="hl-1">        </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-6">model</span><span class="hl-1"> &amp;&amp; </span><span class="hl-6">req</span><span class="hl-1">.</span><span class="hl-6">params</span><span class="hl-1">.</span><span class="hl-6">id</span><span class="hl-1">)</span><br/><span class="hl-1">          </span><span class="hl-6">model</span><br/><span class="hl-1">            .</span><span class="hl-7">findByIdAndUpdate</span><span class="hl-1">(</span><span class="hl-6">req</span><span class="hl-1">.</span><span class="hl-6">params</span><span class="hl-1">.</span><span class="hl-6">id</span><span class="hl-1">, </span><span class="hl-6">body</span><span class="hl-1">, {</span><br/><span class="hl-1">              </span><span class="hl-6">new:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">,</span><br/><span class="hl-1">              </span><span class="hl-6">runValidators:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">,</span><br/><span class="hl-1">            })</span><br/><span class="hl-1">            .</span><span class="hl-7">then</span><span class="hl-1">((</span><span class="hl-6">result</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">              </span><span class="hl-2">this</span><span class="hl-1">.</span><span class="hl-7">searchResult</span><span class="hl-1">(</span><span class="hl-6">result</span><span class="hl-1">, </span><span class="hl-6">res</span><span class="hl-1">)</span><br/><span class="hl-1">            })</span><br/><span class="hl-1">            .</span><span class="hl-7">catch</span><span class="hl-1">((</span><span class="hl-6">err</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">              </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">500</span><span class="hl-1">).</span><span class="hl-7">json</span><span class="hl-1">({ </span><span class="hl-6">message:</span><span class="hl-1"> </span><span class="hl-6">err</span><span class="hl-1"> })</span><br/><span class="hl-1">            })</span><br/><span class="hl-1">        </span><span class="hl-0">else</span><span class="hl-1"> </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-6">model</span><span class="hl-1"> &amp;&amp; </span><span class="hl-6">req</span><span class="hl-1">.</span><span class="hl-6">query</span><span class="hl-1">.</span><span class="hl-6">name</span><span class="hl-1">)</span><br/><span class="hl-1">          </span><span class="hl-6">model</span><br/><span class="hl-1">            .</span><span class="hl-7">findOneAndUpdate</span><span class="hl-1">({ </span><span class="hl-6">name:</span><span class="hl-1"> </span><span class="hl-6">req</span><span class="hl-1">.</span><span class="hl-6">query</span><span class="hl-1">.</span><span class="hl-6">name</span><span class="hl-1">.</span><span class="hl-7">toString</span><span class="hl-1">() }, </span><span class="hl-6">body</span><span class="hl-1">, {</span><br/><span class="hl-1">              </span><span class="hl-6">new:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">,</span><br/><span class="hl-1">              </span><span class="hl-6">runValidators:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">,</span><br/><span class="hl-1">            })</span><br/><span class="hl-1">            .</span><span class="hl-7">then</span><span class="hl-1">((</span><span class="hl-6">result</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">              </span><span class="hl-2">this</span><span class="hl-1">.</span><span class="hl-7">searchResult</span><span class="hl-1">(</span><span class="hl-6">result</span><span class="hl-1">, </span><span class="hl-6">res</span><span class="hl-1">)</span><br/><span class="hl-1">            })</span><br/><span class="hl-1">            .</span><span class="hl-7">catch</span><span class="hl-1">((</span><span class="hl-6">err</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">              </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">500</span><span class="hl-1">).</span><span class="hl-7">json</span><span class="hl-1">({ </span><span class="hl-6">message:</span><span class="hl-1"> </span><span class="hl-6">err</span><span class="hl-1"> })</span><br/><span class="hl-1">            })</span><br/><span class="hl-1">        </span><span class="hl-0">else</span><span class="hl-1"> </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">400</span><span class="hl-1">).</span><span class="hl-7">json</span><span class="hl-1">({ </span><span class="hl-6">message:</span><span class="hl-1"> </span><span class="hl-5">&#39;Bad parameters&#39;</span><span class="hl-1"> })</span><br/><span class="hl-1">      })</span><br/><span class="hl-1">      .</span><span class="hl-7">catch</span><span class="hl-1">((</span><span class="hl-6">err</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-6">console</span><span class="hl-1">.</span><span class="hl-7">log</span><span class="hl-1">(</span><span class="hl-5">&#39;Error connecting to database: &#39;</span><span class="hl-1"> + </span><span class="hl-6">err</span><span class="hl-1">)</span><br/><span class="hl-1">      })</span><br/><span class="hl-1">  }</span><br/><br/><span class="hl-1">  </span><span class="hl-2">private</span><span class="hl-1"> </span><span class="hl-7">searchResult</span><span class="hl-1">(</span><span class="hl-6">result</span><span class="hl-1">: </span><span class="hl-3">any</span><span class="hl-1">, </span><span class="hl-6">res</span><span class="hl-1">: </span><span class="hl-3">express</span><span class="hl-1">.</span><span class="hl-3">Response</span><span class="hl-1">): </span><span class="hl-3">void</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-0">if</span><span class="hl-1"> (!</span><span class="hl-6">result</span><span class="hl-1">) </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">404</span><span class="hl-1">).</span><span class="hl-7">json</span><span class="hl-1">({ </span><span class="hl-6">message:</span><span class="hl-1"> </span><span class="hl-5">&#39;Not found&#39;</span><span class="hl-1"> })</span><br/><span class="hl-1">    </span><span class="hl-0">else</span><span class="hl-1"> </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-7">status</span><span class="hl-1">(</span><span class="hl-8">200</span><span class="hl-1">).</span><span class="hl-7">json</span><span class="hl-1">({ </span><span class="hl-6">message:</span><span class="hl-1"> </span><span class="hl-5">&#39;Found&#39;</span><span class="hl-1">, </span><span class="hl-6">result:</span><span class="hl-1"> </span><span class="hl-6">result</span><span class="hl-1"> })</span><br/><span class="hl-1">  }</span><br/><br/><span class="hl-1">  </span><span class="hl-2">private</span><span class="hl-1"> </span><span class="hl-7">updateRanking</span><span class="hl-1">(</span><span class="hl-6">body</span><span class="hl-1">: </span><span class="hl-3">any</span><span class="hl-1">): </span><span class="hl-3">any</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-2">const</span><span class="hl-1"> { </span><span class="hl-4">id</span><span class="hl-1">, </span><span class="hl-4">name</span><span class="hl-1">, </span><span class="hl-4">users</span><span class="hl-1"> } = </span><span class="hl-6">body</span><br/><span class="hl-1">    </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-4">group</span><span class="hl-1"> = </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-7">Group</span><span class="hl-1">(</span><span class="hl-6">id</span><span class="hl-1">, </span><span class="hl-6">name</span><span class="hl-1">, ...</span><span class="hl-6">users</span><span class="hl-1">)</span><br/><span class="hl-1">    </span><span class="hl-0">for</span><span class="hl-1"> (</span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-4">record</span><span class="hl-1"> </span><span class="hl-2">of</span><span class="hl-1"> </span><span class="hl-6">body</span><span class="hl-1">.</span><span class="hl-6">records</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-6">record</span><span class="hl-1">.</span><span class="hl-6">users</span><span class="hl-1"> = </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-7">UniqueList</span><span class="hl-1">(...</span><span class="hl-6">record</span><span class="hl-1">.</span><span class="hl-6">users</span><span class="hl-1">)</span><br/><span class="hl-1">    </span><span class="hl-6">group</span><span class="hl-1">.</span><span class="hl-6">records</span><span class="hl-1"> = </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-7">UniqueList</span><span class="hl-1">&lt;</span><span class="hl-3">ExtendedEntry</span><span class="hl-1">&gt;(...</span><span class="hl-6">body</span><span class="hl-1">.</span><span class="hl-6">records</span><span class="hl-1">)</span><br/><span class="hl-1">    </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-4">ranking</span><span class="hl-1"> = </span><span class="hl-6">group</span><span class="hl-1">.</span><span class="hl-6">ranking</span><span class="hl-1">.</span><span class="hl-6">values</span><br/><span class="hl-1">    </span><span class="hl-6">body</span><span class="hl-1">.</span><span class="hl-6">ranking</span><span class="hl-1"> = </span><span class="hl-6">ranking</span><br/><span class="hl-1">    </span><span class="hl-0">return</span><span class="hl-1"> </span><span class="hl-6">body</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span>
</code></pre>

<a href="#statsts" id="statsts" style="color: inherit; text-decoration: none;">
  <h3>Stats.ts</h3>
</a>

<a href="#código-7" id="código-7" style="color: inherit; text-decoration: none;">
  <h4>Código</h4>
</a>
<pre><code class="language-TypeScript"><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-2">type</span><span class="hl-1"> </span><span class="hl-3">Stat</span><span class="hl-1"> = {</span><br/><br/><span class="hl-1">  </span><span class="hl-6">km</span><span class="hl-1">: </span><span class="hl-3">number</span><br/><br/><span class="hl-1">  </span><span class="hl-6">slope</span><span class="hl-1">: </span><span class="hl-3">number</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-2">class</span><span class="hl-1"> </span><span class="hl-3">Stats</span><span class="hl-1"> {</span><br/><br/><span class="hl-1">  </span><span class="hl-2">public</span><span class="hl-1"> </span><span class="hl-6">values</span><span class="hl-1">: { [</span><span class="hl-6">key</span><span class="hl-1">: </span><span class="hl-3">string</span><span class="hl-1">]: </span><span class="hl-3">Stat</span><span class="hl-1"> }</span><br/><br/><span class="hl-1">  </span><span class="hl-2">public</span><span class="hl-1"> </span><span class="hl-2">constructor</span><span class="hl-1">() {</span><br/><span class="hl-1">    </span><span class="hl-2">this</span><span class="hl-1">.</span><span class="hl-6">values</span><span class="hl-1"> = {}</span><br/><span class="hl-1">  }</span><br/><br/><span class="hl-1">  </span><span class="hl-2">public</span><span class="hl-1"> </span><span class="hl-7">reset</span><span class="hl-1">(): </span><span class="hl-3">void</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-0">for</span><span class="hl-1"> (</span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-4">key</span><span class="hl-1"> </span><span class="hl-2">in</span><span class="hl-1"> </span><span class="hl-2">this</span><span class="hl-1">.</span><span class="hl-6">values</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-2">this</span><span class="hl-1">.</span><span class="hl-6">values</span><span class="hl-1">[</span><span class="hl-6">key</span><span class="hl-1">].</span><span class="hl-6">km</span><span class="hl-1"> = </span><span class="hl-8">0</span><br/><span class="hl-1">      </span><span class="hl-2">this</span><span class="hl-1">.</span><span class="hl-6">values</span><span class="hl-1">[</span><span class="hl-6">key</span><span class="hl-1">].</span><span class="hl-6">slope</span><span class="hl-1"> = </span><span class="hl-8">0</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span>
</code></pre>
<p>Este código define una interfaz <code>Stat</code> y una clase <code>Stats</code>.</p>
<p>La interfaz <code>Stat</code> define un objeto que tiene dos propiedades: <code>km</code> y <code>slope</code>, ambas de tipo número.</p>
<p>La clase <code>Stats</code> tiene una propiedad pública llamada <code>values</code> que es un objeto que tiene claves de tipo string y valores de tipo <code>Stat</code>. El constructor de la clase inicializa la propiedad <code>values</code> como un objeto vacío.</p>
<p>La clase <code>Stats</code> también tiene un método público llamado <code>reset()</code> que no devuelve nada (void). Este método itera sobre todas las claves del objeto <code>values</code> y establece los valores de <code>km</code> y <code>slope</code> en cero.</p>

<a href="#trackts" id="trackts" style="color: inherit; text-decoration: none;">
  <h3>Track.ts</h3>
</a>

<a href="#código-8" id="código-8" style="color: inherit; text-decoration: none;">
  <h4>Código</h4>
</a>
<pre><code class="language-TypeScript"><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-6">Coordinate</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-5">&#39;./Coordinate.js&#39;</span><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-6">Activity</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-5">&#39;./Activity.js&#39;</span><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-6">UniqueList</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-5">&#39;./UniqueList.js&#39;</span><br/><br/><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-2">interface</span><span class="hl-1"> </span><span class="hl-3">TrackInterface</span><span class="hl-1">&lt;</span><span class="hl-3">T</span><span class="hl-1"> = </span><span class="hl-3">number</span><span class="hl-1">&gt; {</span><br/><span class="hl-1">  </span><span class="hl-6">name</span><span class="hl-1">: </span><span class="hl-3">string</span><br/><span class="hl-1">  </span><span class="hl-6">start</span><span class="hl-1">: </span><span class="hl-3">Coordinate</span><br/><span class="hl-1">  </span><span class="hl-6">end</span><span class="hl-1">: </span><span class="hl-3">Coordinate</span><br/><span class="hl-1">  </span><span class="hl-6">distance</span><span class="hl-1">: </span><span class="hl-3">number</span><br/><span class="hl-1">  </span><span class="hl-6">slope</span><span class="hl-1">: </span><span class="hl-3">number</span><br/><span class="hl-1">  </span><span class="hl-6">users</span><span class="hl-1">: </span><span class="hl-3">Array</span><span class="hl-1">&lt;</span><span class="hl-3">T</span><span class="hl-1">&gt;</span><br/><span class="hl-1">  </span><span class="hl-6">activity</span><span class="hl-1">: </span><span class="hl-3">Activity</span><br/><span class="hl-1">  </span><span class="hl-6">score</span><span class="hl-1">: </span><span class="hl-3">number</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-2">class</span><span class="hl-1"> </span><span class="hl-3">Track</span><span class="hl-1">&lt;</span><span class="hl-3">T</span><span class="hl-1"> = </span><span class="hl-3">number</span><span class="hl-1">&gt; </span><span class="hl-2">implements</span><span class="hl-1"> </span><span class="hl-3">TrackInterface</span><span class="hl-1">&lt;</span><span class="hl-3">T</span><span class="hl-1">&gt; {</span><br/><br/><span class="hl-1">  </span><span class="hl-2">public</span><span class="hl-1"> </span><span class="hl-2">readonly</span><span class="hl-1"> </span><span class="hl-6">id</span><span class="hl-1">: </span><span class="hl-3">number</span><br/><br/><span class="hl-1">  </span><span class="hl-2">public</span><span class="hl-1"> </span><span class="hl-6">name</span><span class="hl-1">: </span><span class="hl-3">string</span><br/><br/><span class="hl-1">  </span><span class="hl-2">public</span><span class="hl-1"> </span><span class="hl-6">start</span><span class="hl-1">: </span><span class="hl-3">Coordinate</span><br/><br/><span class="hl-1">  </span><span class="hl-2">public</span><span class="hl-1"> </span><span class="hl-6">end</span><span class="hl-1">: </span><span class="hl-3">Coordinate</span><br/><br/><span class="hl-1">  </span><span class="hl-2">public</span><span class="hl-1"> </span><span class="hl-6">distance</span><span class="hl-1">: </span><span class="hl-3">number</span><br/><br/><span class="hl-1">  </span><span class="hl-2">public</span><span class="hl-1"> </span><span class="hl-6">slope</span><span class="hl-1">: </span><span class="hl-3">number</span><br/><br/><span class="hl-1">  </span><span class="hl-2">public</span><span class="hl-1"> </span><span class="hl-6">users</span><span class="hl-1">: </span><span class="hl-3">UniqueList</span><span class="hl-1">&lt;</span><span class="hl-3">T</span><span class="hl-1">&gt; = </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-7">UniqueList</span><span class="hl-1">&lt;</span><span class="hl-3">T</span><span class="hl-1">&gt;()</span><br/><br/><span class="hl-1">  </span><span class="hl-2">public</span><span class="hl-1"> </span><span class="hl-6">activity</span><span class="hl-1">: </span><span class="hl-3">Activity</span><br/><br/><span class="hl-1">  </span><span class="hl-2">public</span><span class="hl-1"> </span><span class="hl-6">score</span><span class="hl-1"> = </span><span class="hl-8">0</span><br/><br/><span class="hl-1">  </span><span class="hl-2">public</span><span class="hl-1"> </span><span class="hl-2">constructor</span><span class="hl-1">(</span><br/><span class="hl-1">    </span><span class="hl-6">id</span><span class="hl-1">: </span><span class="hl-3">number</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-6">name</span><span class="hl-1">: </span><span class="hl-3">string</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-6">start</span><span class="hl-1">: </span><span class="hl-3">Coordinate</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-6">end</span><span class="hl-1">: </span><span class="hl-3">Coordinate</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-6">distance</span><span class="hl-1">: </span><span class="hl-3">number</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-6">slope</span><span class="hl-1">: </span><span class="hl-3">number</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-6">activity</span><span class="hl-1">: </span><span class="hl-3">Activity</span><br/><span class="hl-1">  ) {</span><br/><span class="hl-1">    </span><span class="hl-2">this</span><span class="hl-1">.</span><span class="hl-6">id</span><span class="hl-1"> = </span><span class="hl-6">id</span><br/><span class="hl-1">    </span><span class="hl-2">this</span><span class="hl-1">.</span><span class="hl-6">name</span><span class="hl-1"> = </span><span class="hl-6">name</span><br/><span class="hl-1">    </span><span class="hl-2">this</span><span class="hl-1">.</span><span class="hl-6">start</span><span class="hl-1"> = </span><span class="hl-6">start</span><br/><span class="hl-1">    </span><span class="hl-2">this</span><span class="hl-1">.</span><span class="hl-6">end</span><span class="hl-1"> = </span><span class="hl-6">end</span><br/><span class="hl-1">    </span><span class="hl-2">this</span><span class="hl-1">.</span><span class="hl-6">distance</span><span class="hl-1"> = </span><span class="hl-6">distance</span><br/><span class="hl-1">    </span><span class="hl-2">this</span><span class="hl-1">.</span><span class="hl-6">slope</span><span class="hl-1"> = </span><span class="hl-6">slope</span><br/><span class="hl-1">    </span><span class="hl-2">this</span><span class="hl-1">.</span><span class="hl-6">activity</span><span class="hl-1"> = </span><span class="hl-6">activity</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span>
</code></pre>
<p>Este código define una interfaz <code>TrackInterface</code> y una clase <code>Track</code>.</p>
<p>La interfaz <code>TrackInterface</code> define un objeto que tiene varias propiedades, incluyendo <code>name</code>, <code>start</code>, <code>end</code>, <code>distance</code>, <code>slope</code>, <code>users</code>, <code>activity</code> y <code>score</code>. Algunas de estas propiedades tienen tipos genéricos, lo que significa que pueden ser de cualquier tipo.</p>
<p>La clase <code>Track</code> implementa la interfaz <code>TrackInterface</code> y tiene varias propiedades públicas, incluyendo <code>id</code>, <code>name</code>, <code>start</code>, <code>end</code>, <code>distance</code>, <code>slope</code>, <code>users</code>, <code>activity</code> y <code>score</code>. La propiedad <code>id</code> es de solo lectura y se establece en el constructor. Las propiedades <code>name</code>, <code>start</code>, <code>end</code>, <code>distance</code>, <code>slope</code> y <code>activity</code> se establecen en el constructor y se pueden modificar posteriormente. La propiedad <code>users</code> es una instancia de la clase <code>UniqueList</code>, que es una lista que solo permite valores únicos.</p>
<p>La clase <code>Track</code> también tiene un constructor que toma varios argumentos, incluyendo <code>id</code>, <code>name</code>, <code>start</code>, <code>end</code>, <code>distance</code>, <code>slope</code> y <code>activity</code>. Este constructor inicializa las propiedades correspondientes con los valores proporcionados.</p>

<a href="#uniquelistts" id="uniquelistts" style="color: inherit; text-decoration: none;">
  <h3>UniqueList.ts</h3>
</a>

<a href="#código-9" id="código-9" style="color: inherit; text-decoration: none;">
  <h4>Código</h4>
</a>
<pre><code class="language-TypeScript"><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-2">class</span><span class="hl-1"> </span><span class="hl-3">UniqueList</span><span class="hl-1">&lt;</span><span class="hl-3">T</span><span class="hl-1"> = </span><span class="hl-3">number</span><span class="hl-1">&gt; </span><span class="hl-2">extends</span><span class="hl-1"> </span><span class="hl-3">Array</span><span class="hl-1">&lt;</span><span class="hl-3">T</span><span class="hl-1">&gt; {</span><br/><br/><span class="hl-1">  </span><span class="hl-2">public</span><span class="hl-1"> </span><span class="hl-2">constructor</span><span class="hl-1">(...</span><span class="hl-6">values</span><span class="hl-1">: </span><span class="hl-3">T</span><span class="hl-1">[]) {</span><br/><span class="hl-1">    </span><span class="hl-2">super</span><span class="hl-1">()</span><br/><span class="hl-1">    </span><span class="hl-0">for</span><span class="hl-1"> (</span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-4">value</span><span class="hl-1"> </span><span class="hl-2">of</span><span class="hl-1"> </span><span class="hl-6">values</span><span class="hl-1">) </span><span class="hl-2">this</span><span class="hl-1">.</span><span class="hl-7">add</span><span class="hl-1">(</span><span class="hl-6">value</span><span class="hl-1">)</span><br/><span class="hl-1">  }</span><br/><br/><span class="hl-1">  </span><span class="hl-2">public</span><span class="hl-1"> </span><span class="hl-7">has</span><span class="hl-1">(</span><span class="hl-6">value</span><span class="hl-1">: </span><span class="hl-3">T</span><span class="hl-1">): </span><span class="hl-3">boolean</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-0">for</span><span class="hl-1"> (</span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-4">v</span><span class="hl-1"> </span><span class="hl-2">of</span><span class="hl-1"> </span><span class="hl-2">this</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-4">JSON</span><span class="hl-1">.</span><span class="hl-7">stringify</span><span class="hl-1">(</span><span class="hl-6">v</span><span class="hl-1">) === </span><span class="hl-4">JSON</span><span class="hl-1">.</span><span class="hl-7">stringify</span><span class="hl-1">(</span><span class="hl-6">value</span><span class="hl-1">)) </span><span class="hl-0">return</span><span class="hl-1"> </span><span class="hl-2">true</span><br/><span class="hl-1">    </span><span class="hl-0">return</span><span class="hl-1"> </span><span class="hl-2">false</span><br/><span class="hl-1">  }</span><br/><br/><span class="hl-1">  </span><span class="hl-2">public</span><span class="hl-1"> </span><span class="hl-7">add</span><span class="hl-1">(</span><span class="hl-6">value</span><span class="hl-1">: </span><span class="hl-3">T</span><span class="hl-1">): </span><span class="hl-3">boolean</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-2">this</span><span class="hl-1">.</span><span class="hl-7">has</span><span class="hl-1">(</span><span class="hl-6">value</span><span class="hl-1">)) </span><span class="hl-0">return</span><span class="hl-1"> </span><span class="hl-2">false</span><br/><span class="hl-1">    </span><span class="hl-2">this</span><span class="hl-1">.</span><span class="hl-7">push</span><span class="hl-1">(</span><span class="hl-6">value</span><span class="hl-1">)</span><br/><span class="hl-1">    </span><span class="hl-0">return</span><span class="hl-1"> </span><span class="hl-2">true</span><br/><span class="hl-1">  }</span><br/><br/><span class="hl-1">  </span><span class="hl-2">public</span><span class="hl-1"> </span><span class="hl-7">remove</span><span class="hl-1">(</span><span class="hl-6">value</span><span class="hl-1">: </span><span class="hl-3">T</span><span class="hl-1">): </span><span class="hl-3">boolean</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-0">if</span><span class="hl-1"> (!</span><span class="hl-2">this</span><span class="hl-1">.</span><span class="hl-7">has</span><span class="hl-1">(</span><span class="hl-6">value</span><span class="hl-1">)) </span><span class="hl-0">return</span><span class="hl-1"> </span><span class="hl-2">false</span><br/><span class="hl-1">    </span><span class="hl-2">this</span><span class="hl-1">.</span><span class="hl-7">splice</span><span class="hl-1">(</span><span class="hl-2">this</span><span class="hl-1">.</span><span class="hl-7">indexOf</span><span class="hl-1">(</span><span class="hl-6">value</span><span class="hl-1">), </span><span class="hl-8">1</span><span class="hl-1">)</span><br/><span class="hl-1">    </span><span class="hl-0">return</span><span class="hl-1"> </span><span class="hl-2">true</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span>
</code></pre>
<p>Este código define una clase <code>UniqueList</code> en TypeScript que extiende la clase nativa <code>Array</code>. Esta clase se utiliza para almacenar una lista de valores únicos.</p>
<p>El constructor de la clase acepta un número variable de argumentos y los agrega a la lista utilizando el método <code>add()</code>.
La clase tiene tres métodos públicos: <code>has()</code>, <code>add()</code> y <code>remove()</code>.</p>
<ul>
<li><p>El método <code>has()</code> se utiliza para verificar si un valor ya está en la lista. El método itera sobre la lista y compara cada valor con el valor proporcionado utilizando <code>JSON.stringify()</code>. Si encuentra una coincidencia, devuelve <code>true</code>, de lo contrario, devuelve <code>false</code>.</p>
</li>
<li><p>El método <code>add()</code> se utiliza para agregar un valor a la lista. Primero, verifica si el valor ya está en la lista utilizando el método <code>has()</code>. Si el valor ya está en la lista, devuelve <code>false</code>. De lo contrario, agrega el valor a la lista utilizando el método <code>push()</code> y devuelve <code>true</code>.</p>
</li>
<li><p>El método <code>remove()</code> se utiliza para eliminar un valor de la lista. Primero, verifica si el valor está en la lista utilizando el método <code>has()</code>. Si el valor no está en la lista, devuelve <code>false</code>. De lo contrario, utiliza el método <code>splice()</code> para eliminar el valor de la lista y devuelve <code>true</code>.</p>
</li>
</ul>

<a href="#userts" id="userts" style="color: inherit; text-decoration: none;">
  <h3>User.ts</h3>
</a>

<a href="#código-10" id="código-10" style="color: inherit; text-decoration: none;">
  <h4>Código</h4>
</a>
<pre><code class="language-TypeScript"><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-6">Activity</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-5">&#39;./Activity.js&#39;</span><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-6">Stats</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-5">&#39;./Stats.js&#39;</span><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-6">UniqueList</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-5">&#39;./UniqueList.js&#39;</span><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-6">Entry</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-5">&#39;./Entry.js&#39;</span><br/><br/><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-2">interface</span><span class="hl-1"> </span><span class="hl-3">UserInterface</span><span class="hl-1">&lt;</span><span class="hl-3">T</span><span class="hl-1"> = </span><span class="hl-3">number</span><span class="hl-1">&gt; {</span><br/><span class="hl-1">  </span><span class="hl-6">name</span><span class="hl-1">: </span><span class="hl-3">string</span><br/><span class="hl-1">  </span><span class="hl-6">activity</span><span class="hl-1">: </span><span class="hl-3">Activity</span><br/><span class="hl-1">  </span><span class="hl-6">stats</span><span class="hl-1">: </span><span class="hl-3">Stats</span><br/><span class="hl-1">  </span><span class="hl-6">users</span><span class="hl-1">: </span><span class="hl-3">T</span><span class="hl-1">[]</span><br/><span class="hl-1">  </span><span class="hl-6">groups</span><span class="hl-1">: </span><span class="hl-3">T</span><span class="hl-1">[]</span><br/><span class="hl-1">  </span><span class="hl-6">tracks</span><span class="hl-1">: </span><span class="hl-3">T</span><span class="hl-1">[]</span><br/><span class="hl-1">  </span><span class="hl-6">challenges</span><span class="hl-1">: </span><span class="hl-3">T</span><span class="hl-1">[]</span><br/><span class="hl-1">  </span><span class="hl-6">records</span><span class="hl-1">: </span><span class="hl-3">Entry</span><span class="hl-1">&lt;</span><span class="hl-3">T</span><span class="hl-1">&gt;[]</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-2">class</span><span class="hl-1"> </span><span class="hl-3">User</span><span class="hl-1">&lt;</span><span class="hl-3">T</span><span class="hl-1"> = </span><span class="hl-3">number</span><span class="hl-1">&gt; </span><span class="hl-2">implements</span><span class="hl-1"> </span><span class="hl-3">UserInterface</span><span class="hl-1">&lt;</span><span class="hl-3">T</span><span class="hl-1">&gt; {</span><br/><br/><span class="hl-1">  </span><span class="hl-2">public</span><span class="hl-1"> </span><span class="hl-2">readonly</span><span class="hl-1"> </span><span class="hl-6">id</span><span class="hl-1">: </span><span class="hl-3">number</span><br/><br/><span class="hl-1">  </span><span class="hl-2">public</span><span class="hl-1"> </span><span class="hl-6">name</span><span class="hl-1">: </span><span class="hl-3">string</span><br/><br/><span class="hl-1">  </span><span class="hl-2">public</span><span class="hl-1"> </span><span class="hl-6">activity</span><span class="hl-1">: </span><span class="hl-3">Activity</span><br/><br/><span class="hl-1">  </span><span class="hl-2">public</span><span class="hl-1"> </span><span class="hl-6">users</span><span class="hl-1">: </span><span class="hl-3">UniqueList</span><span class="hl-1">&lt;</span><span class="hl-3">T</span><span class="hl-1">&gt; = </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-7">UniqueList</span><span class="hl-1">&lt;</span><span class="hl-3">T</span><span class="hl-1">&gt;()</span><br/><br/><span class="hl-1">  </span><span class="hl-2">public</span><span class="hl-1"> </span><span class="hl-6">groups</span><span class="hl-1">: </span><span class="hl-3">UniqueList</span><span class="hl-1">&lt;</span><span class="hl-3">T</span><span class="hl-1">&gt; = </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-7">UniqueList</span><span class="hl-1">&lt;</span><span class="hl-3">T</span><span class="hl-1">&gt;()</span><br/><br/><span class="hl-1">  </span><span class="hl-2">public</span><span class="hl-1"> </span><span class="hl-6">stats</span><span class="hl-1">: </span><span class="hl-3">Stats</span><span class="hl-1"> = </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-7">Stats</span><span class="hl-1">()</span><br/><br/><span class="hl-1">  </span><span class="hl-2">public</span><span class="hl-1"> </span><span class="hl-6">tracks</span><span class="hl-1">: </span><span class="hl-3">UniqueList</span><span class="hl-1">&lt;</span><span class="hl-3">T</span><span class="hl-1">&gt; = </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-7">UniqueList</span><span class="hl-1">&lt;</span><span class="hl-3">T</span><span class="hl-1">&gt;()</span><br/><br/><span class="hl-1">  </span><span class="hl-2">public</span><span class="hl-1"> </span><span class="hl-6">challenges</span><span class="hl-1">: </span><span class="hl-3">UniqueList</span><span class="hl-1">&lt;</span><span class="hl-3">T</span><span class="hl-1">&gt; = </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-7">UniqueList</span><span class="hl-1">&lt;</span><span class="hl-3">T</span><span class="hl-1">&gt;()</span><br/><br/><span class="hl-1">  </span><span class="hl-2">public</span><span class="hl-1"> </span><span class="hl-6">records</span><span class="hl-1">: </span><span class="hl-3">UniqueList</span><span class="hl-1">&lt;</span><span class="hl-3">Entry</span><span class="hl-1">&lt;</span><span class="hl-3">T</span><span class="hl-1">&gt;&gt; = </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-7">UniqueList</span><span class="hl-1">&lt;</span><span class="hl-3">Entry</span><span class="hl-1">&lt;</span><span class="hl-3">T</span><span class="hl-1">&gt;&gt;()</span><br/><br/><span class="hl-1">  </span><span class="hl-2">public</span><span class="hl-1"> </span><span class="hl-2">constructor</span><span class="hl-1">(</span><span class="hl-6">id</span><span class="hl-1">: </span><span class="hl-3">number</span><span class="hl-1">, </span><span class="hl-6">name</span><span class="hl-1">: </span><span class="hl-3">string</span><span class="hl-1">, </span><span class="hl-6">activity</span><span class="hl-1">: </span><span class="hl-3">Activity</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-2">this</span><span class="hl-1">.</span><span class="hl-6">id</span><span class="hl-1"> = </span><span class="hl-6">id</span><br/><span class="hl-1">    </span><span class="hl-2">this</span><span class="hl-1">.</span><span class="hl-6">name</span><span class="hl-1"> = </span><span class="hl-6">name</span><br/><span class="hl-1">    </span><span class="hl-2">this</span><span class="hl-1">.</span><span class="hl-6">activity</span><span class="hl-1"> = </span><span class="hl-6">activity</span><br/><span class="hl-1">    </span><span class="hl-2">this</span><span class="hl-1">.</span><span class="hl-6">stats</span><span class="hl-1">.</span><span class="hl-6">values</span><span class="hl-1"> = {</span><br/><span class="hl-1">      </span><span class="hl-6">weekly:</span><span class="hl-1"> { </span><span class="hl-6">km:</span><span class="hl-1"> </span><span class="hl-8">0</span><span class="hl-1">, </span><span class="hl-6">slope:</span><span class="hl-1"> </span><span class="hl-8">0</span><span class="hl-1"> },</span><br/><span class="hl-1">      </span><span class="hl-6">monthly:</span><span class="hl-1"> { </span><span class="hl-6">km:</span><span class="hl-1"> </span><span class="hl-8">0</span><span class="hl-1">, </span><span class="hl-6">slope:</span><span class="hl-1"> </span><span class="hl-8">0</span><span class="hl-1"> },</span><br/><span class="hl-1">      </span><span class="hl-6">yearly:</span><span class="hl-1"> { </span><span class="hl-6">km:</span><span class="hl-1"> </span><span class="hl-8">0</span><span class="hl-1">, </span><span class="hl-6">slope:</span><span class="hl-1"> </span><span class="hl-8">0</span><span class="hl-1"> },</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span>
</code></pre>
<p>Este código define una interfaz <code>UserInterface</code> y una clase <code>User</code>.</p>
<p>La interfaz <code>UserInterface</code> define un objeto que tiene varias propiedades, incluyendo <code>name</code>, <code>activity</code>, <code>stats</code>, <code>users</code>, <code>groups</code>, <code>tracks</code>, <code>challenges</code> y <code>records</code>. Algunas de estas propiedades tienen tipos genéricos, lo que significa que pueden ser de cualquier tipo.</p>
<p>La clase <code>User</code> implementa la interfaz <code>UserInterface</code> y tiene varias propiedades públicas, incluyendo <code>id</code>, <code>name</code>, <code>activity</code>, <code>users</code>, <code>groups</code>, <code>stats</code>, <code>tracks</code>, <code>challenges</code> y <code>records</code>. Las propiedades <code>id</code>, <code>name</code> y <code>activity</code> se establecen en el constructor y se pueden modificar posteriormente. Las propiedades <code>users</code>, <code>groups</code>, <code>tracks</code>, <code>challenges</code> y <code>records</code> son instancias de la clase <code>UniqueList</code>, que es una lista que solo permite valores únicos. La propiedad <code>stats</code> es una instancia de la clase <code>Stats</code>, que se utiliza para almacenar estadísticas de actividad física.</p>
<p>El constructor de la clase <code>User</code> toma tres argumentos: <code>id</code>, <code>name</code> y <code>activity</code>. Este constructor inicializa las propiedades correspondientes con los valores proporcionados. También inicializa la propiedad <code>stats</code> con valores predeterminados para las estadísticas semanales, mensuales y anuales.</p>

<a href="#maints" id="maints" style="color: inherit; text-decoration: none;">
  <h3>main.ts</h3>
</a>

<a href="#código-11" id="código-11" style="color: inherit; text-decoration: none;">
  <h4>Código</h4>
</a>
<pre><code class="language-TypeScript"><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-6">Server</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-5">&#39;./Server.js&#39;</span><br/><br/><span class="hl-2">function</span><span class="hl-1"> </span><span class="hl-7">main</span><span class="hl-1">() {</span><br/><span class="hl-1">  </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-7">Server</span><span class="hl-1">().</span><span class="hl-7">start</span><span class="hl-1">(</span><span class="hl-8">3000</span><span class="hl-1">)</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-7">main</span><span class="hl-1">()</span>
</code></pre>
<p>Este código define una función <code>main()</code> que crea una instancia de la clase <code>Server</code> y llama al método <code>start()</code> con el argumento 3000. Luego, la función <code>main()</code> se llama para iniciar el servidor.</p>
<p>La clase <code>Server</code> se utiliza para crear un servidor web utilizando Node.js y Express. El método <code>start()</code> se utiliza para iniciar el servidor en un puerto específico. En este caso, el servidor se iniciará en el puerto 3000.</p>
<p>La función <code>main()</code> es la función principal del programa y se llama para iniciar el servidor. Al llamar a la función <code>main()</code>, se crea una instancia de la clase <code>Server</code> y se inicia el servidor en el puerto 3000.</p>

<a href="#pruebas-y-cubrimiento" id="pruebas-y-cubrimiento" style="color: inherit; text-decoration: none;">
  <h2>Pruebas y cubrimiento</h2>
</a>
<p>Han sido realiazadas pruebas con mocha y chai con el fin de verificar el correcto funcionamiento de todos y cada uno de los ficheros del proyecto. A continuación se muestras las pruebas realizadas que están todas en un mismo fichero llamado <code>Destravate.spec.ts</code>:</p>
<pre><code class="language-TypeScript"><span class="hl-0">import</span><span class="hl-1"> </span><span class="hl-5">&#39;mocha&#39;</span><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-6">expect</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-5">&#39;chai&#39;</span><br/><span class="hl-0">import</span><span class="hl-1"> </span><span class="hl-6">request</span><span class="hl-1"> </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-5">&#39;supertest&#39;</span><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-6">connect</span><span class="hl-1">, </span><span class="hl-6">disconnect</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-5">&#39;mongoose&#39;</span><br/><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-6">UniqueList</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-5">&#39;../src/UniqueList.js&#39;</span><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-6">Activity</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-5">&#39;../src/Activity.js&#39;</span><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-6">Coordinate</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-5">&#39;../src/Coordinate.js&#39;</span><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-6">Track</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-5">&#39;../src/Track.js&#39;</span><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-6">User</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-5">&#39;../src/User.js&#39;</span><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-6">Group</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-5">&#39;../src/Group.js&#39;</span><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-6">Challenge</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-5">&#39;../src/Challenge.js&#39;</span><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-6">Server</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-5">&#39;../src/Server.js&#39;</span><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-6">TrackModel</span><span class="hl-1">, </span><span class="hl-6">UserModel</span><span class="hl-1">, </span><span class="hl-6">GroupModel</span><span class="hl-1">, </span><span class="hl-6">ChallengeModel</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-5">&#39;../src/Models.js&#39;</span><br/><br/><span class="hl-2">let</span><span class="hl-1"> </span><span class="hl-6">server</span><span class="hl-1">: </span><span class="hl-3">Server</span><br/><span class="hl-7">before</span><span class="hl-1">(</span><span class="hl-2">async</span><span class="hl-1"> </span><span class="hl-2">function</span><span class="hl-1"> () {</span><br/><span class="hl-1">  </span><span class="hl-6">server</span><span class="hl-1"> = </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-7">Server</span><span class="hl-1">()</span><br/><span class="hl-1">  </span><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-6">server</span><span class="hl-1">.</span><span class="hl-7">start</span><span class="hl-1">(</span><span class="hl-6">process</span><span class="hl-1">.</span><span class="hl-6">env</span><span class="hl-1">.</span><span class="hl-4">PORT</span><span class="hl-1"> || </span><span class="hl-8">3000</span><span class="hl-1">)</span><br/><span class="hl-1">  </span><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-7">connect</span><span class="hl-1">(</span><span class="hl-6">process</span><span class="hl-1">.</span><span class="hl-6">env</span><span class="hl-1">.</span><span class="hl-4">MONGODB_URL</span><span class="hl-1">!)</span><br/><span class="hl-1">  </span><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-6">TrackModel</span><span class="hl-1">.</span><span class="hl-7">deleteMany</span><span class="hl-1">()</span><br/><span class="hl-1">  </span><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-6">UserModel</span><span class="hl-1">.</span><span class="hl-7">deleteMany</span><span class="hl-1">()</span><br/><span class="hl-1">  </span><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-6">GroupModel</span><span class="hl-1">.</span><span class="hl-7">deleteMany</span><span class="hl-1">()</span><br/><span class="hl-1">  </span><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-6">ChallengeModel</span><span class="hl-1">.</span><span class="hl-7">deleteMany</span><span class="hl-1">()</span><br/><span class="hl-1">})</span><br/><br/><span class="hl-7">describe</span><span class="hl-1">(</span><span class="hl-5">&#39;Destravate app tests&#39;</span><span class="hl-1">, () </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-7">describe</span><span class="hl-1">(</span><span class="hl-5">&#39;Track class tests&#39;</span><span class="hl-1">, () </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-4">coord1</span><span class="hl-1">: </span><span class="hl-3">Coordinate</span><span class="hl-1"> = {</span><br/><span class="hl-1">      </span><span class="hl-6">lat:</span><span class="hl-1"> </span><span class="hl-8">40.4167</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-6">lng:</span><span class="hl-1"> -</span><span class="hl-8">3.70325</span><span class="hl-1">,</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">    </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-4">coord2</span><span class="hl-1">: </span><span class="hl-3">Coordinate</span><span class="hl-1"> = {</span><br/><span class="hl-1">      </span><span class="hl-6">lat:</span><span class="hl-1"> </span><span class="hl-8">52.520008</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-6">lng:</span><span class="hl-1"> </span><span class="hl-8">13.404954</span><span class="hl-1">,</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">    </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-4">track1</span><span class="hl-1">: </span><span class="hl-3">Track</span><span class="hl-1"> = </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-7">Track</span><span class="hl-1">(</span><br/><span class="hl-1">      </span><span class="hl-8">0</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-5">&#39;Route to El Dorado&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-6">coord1</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-6">coord2</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-8">100</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-8">0.5</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-6">Activity</span><span class="hl-1">.</span><span class="hl-6">running</span><br/><span class="hl-1">    )</span><br/><span class="hl-1">    </span><span class="hl-7">it</span><span class="hl-1">(</span><span class="hl-5">&#39;Track Objects should have an id&#39;</span><span class="hl-1">, () </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">track1</span><span class="hl-1">.</span><span class="hl-6">id</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">be</span><span class="hl-1">.</span><span class="hl-7">a</span><span class="hl-1">(</span><span class="hl-5">&#39;number&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">track1</span><span class="hl-1">.</span><span class="hl-6">id</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-7">equal</span><span class="hl-1">(</span><span class="hl-8">0</span><span class="hl-1">)</span><br/><span class="hl-1">    })</span><br/><span class="hl-1">    </span><span class="hl-7">it</span><span class="hl-1">(</span><span class="hl-5">&#39;Track Objects should have a name&#39;</span><span class="hl-1">, () </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">track1</span><span class="hl-1">.</span><span class="hl-6">name</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">be</span><span class="hl-1">.</span><span class="hl-7">a</span><span class="hl-1">(</span><span class="hl-5">&#39;string&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">track1</span><span class="hl-1">.</span><span class="hl-6">name</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-7">equal</span><span class="hl-1">(</span><span class="hl-5">&#39;Route to El Dorado&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">    })</span><br/><span class="hl-1">    </span><span class="hl-7">it</span><span class="hl-1">(</span><span class="hl-5">&#39;Track Objects should have a start and end points, and both should be Coordinates&#39;</span><span class="hl-1">, () </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">track1</span><span class="hl-1">.</span><span class="hl-6">start</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">be</span><span class="hl-1">.</span><span class="hl-7">a</span><span class="hl-1">(</span><span class="hl-5">&#39;object&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">track1</span><span class="hl-1">.</span><span class="hl-6">start</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">have</span><span class="hl-1">.</span><span class="hl-7">property</span><span class="hl-1">(</span><span class="hl-5">&#39;lat&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">track1</span><span class="hl-1">.</span><span class="hl-6">start</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">have</span><span class="hl-1">.</span><span class="hl-7">property</span><span class="hl-1">(</span><span class="hl-5">&#39;lng&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">track1</span><span class="hl-1">.</span><span class="hl-6">start</span><span class="hl-1">.</span><span class="hl-6">lat</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">be</span><span class="hl-1">.</span><span class="hl-7">a</span><span class="hl-1">(</span><span class="hl-5">&#39;number&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">track1</span><span class="hl-1">.</span><span class="hl-6">start</span><span class="hl-1">.</span><span class="hl-6">lng</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">be</span><span class="hl-1">.</span><span class="hl-7">a</span><span class="hl-1">(</span><span class="hl-5">&#39;number&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">track1</span><span class="hl-1">.</span><span class="hl-6">start</span><span class="hl-1">.</span><span class="hl-6">lat</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-7">equal</span><span class="hl-1">(</span><span class="hl-8">40.4167</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">track1</span><span class="hl-1">.</span><span class="hl-6">start</span><span class="hl-1">.</span><span class="hl-6">lng</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-7">equal</span><span class="hl-1">(-</span><span class="hl-8">3.70325</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">track1</span><span class="hl-1">.</span><span class="hl-6">end</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">be</span><span class="hl-1">.</span><span class="hl-7">a</span><span class="hl-1">(</span><span class="hl-5">&#39;object&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">track1</span><span class="hl-1">.</span><span class="hl-6">end</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">have</span><span class="hl-1">.</span><span class="hl-7">property</span><span class="hl-1">(</span><span class="hl-5">&#39;lat&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">track1</span><span class="hl-1">.</span><span class="hl-6">end</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">have</span><span class="hl-1">.</span><span class="hl-7">property</span><span class="hl-1">(</span><span class="hl-5">&#39;lng&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">track1</span><span class="hl-1">.</span><span class="hl-6">end</span><span class="hl-1">.</span><span class="hl-6">lat</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">be</span><span class="hl-1">.</span><span class="hl-7">a</span><span class="hl-1">(</span><span class="hl-5">&#39;number&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">track1</span><span class="hl-1">.</span><span class="hl-6">end</span><span class="hl-1">.</span><span class="hl-6">lng</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">be</span><span class="hl-1">.</span><span class="hl-7">a</span><span class="hl-1">(</span><span class="hl-5">&#39;number&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">track1</span><span class="hl-1">.</span><span class="hl-6">end</span><span class="hl-1">.</span><span class="hl-6">lat</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-7">equal</span><span class="hl-1">(</span><span class="hl-8">52.520008</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">track1</span><span class="hl-1">.</span><span class="hl-6">end</span><span class="hl-1">.</span><span class="hl-6">lng</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-7">equal</span><span class="hl-1">(</span><span class="hl-8">13.404954</span><span class="hl-1">)</span><br/><span class="hl-1">    })</span><br/><span class="hl-1">    </span><span class="hl-7">it</span><span class="hl-1">(</span><span class="hl-5">&#39;Track Objects should have a distance&#39;</span><span class="hl-1">, () </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">track1</span><span class="hl-1">.</span><span class="hl-6">distance</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">be</span><span class="hl-1">.</span><span class="hl-7">a</span><span class="hl-1">(</span><span class="hl-5">&#39;number&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">track1</span><span class="hl-1">.</span><span class="hl-6">distance</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-7">equal</span><span class="hl-1">(</span><span class="hl-8">100</span><span class="hl-1">)</span><br/><span class="hl-1">    })</span><br/><span class="hl-1">    </span><span class="hl-7">it</span><span class="hl-1">(</span><span class="hl-5">&#39;Track Objects should have a slope&#39;</span><span class="hl-1">, () </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">track1</span><span class="hl-1">.</span><span class="hl-6">slope</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">be</span><span class="hl-1">.</span><span class="hl-7">a</span><span class="hl-1">(</span><span class="hl-5">&#39;number&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">track1</span><span class="hl-1">.</span><span class="hl-6">slope</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-7">equal</span><span class="hl-1">(</span><span class="hl-8">0.5</span><span class="hl-1">)</span><br/><span class="hl-1">    })</span><br/><span class="hl-1">    </span><span class="hl-7">it</span><span class="hl-1">(</span><span class="hl-5">&#39;Track Objects should have a list of users that have done the track&#39;</span><span class="hl-1">, () </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">track1</span><span class="hl-1">.</span><span class="hl-6">users</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">be</span><span class="hl-1">.</span><span class="hl-7">a</span><span class="hl-1">(</span><span class="hl-5">&#39;array&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">track1</span><span class="hl-1">.</span><span class="hl-6">users</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">have</span><span class="hl-1">.</span><span class="hl-7">lengthOf</span><span class="hl-1">(</span><span class="hl-8">0</span><span class="hl-1">)</span><br/><span class="hl-1">    })</span><br/><span class="hl-1">    </span><span class="hl-7">it</span><span class="hl-1">(</span><span class="hl-5">&#39;Track Objects should have an activity&#39;</span><span class="hl-1">, () </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">Object</span><span class="hl-1">.</span><span class="hl-7">values</span><span class="hl-1">(</span><span class="hl-6">Activity</span><span class="hl-1">)).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-7">include</span><span class="hl-1">(</span><span class="hl-6">track1</span><span class="hl-1">.</span><span class="hl-6">activity</span><span class="hl-1">)</span><br/><span class="hl-1">    })</span><br/><span class="hl-1">    </span><span class="hl-7">it</span><span class="hl-1">(</span><span class="hl-5">&#39;Track Objects should have a score&#39;</span><span class="hl-1">, () </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">track1</span><span class="hl-1">.</span><span class="hl-6">score</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">be</span><span class="hl-1">.</span><span class="hl-7">a</span><span class="hl-1">(</span><span class="hl-5">&#39;number&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">track1</span><span class="hl-1">.</span><span class="hl-6">score</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-7">equal</span><span class="hl-1">(</span><span class="hl-8">0</span><span class="hl-1">)</span><br/><span class="hl-1">    })</span><br/><span class="hl-1">  })</span><br/><br/><span class="hl-1">  </span><span class="hl-7">describe</span><span class="hl-1">(</span><span class="hl-5">&#39;User class tests&#39;</span><span class="hl-1">, () </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-4">user</span><span class="hl-1"> = </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-7">User</span><span class="hl-1">(</span><span class="hl-8">0</span><span class="hl-1">, </span><span class="hl-5">&#39;Iluzio&#39;</span><span class="hl-1">, </span><span class="hl-6">Activity</span><span class="hl-1">.</span><span class="hl-6">running</span><span class="hl-1">)</span><br/><span class="hl-1">    </span><span class="hl-7">it</span><span class="hl-1">(</span><span class="hl-5">&#39;User Objects should have an id&#39;</span><span class="hl-1">, () </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">user</span><span class="hl-1">.</span><span class="hl-6">id</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">be</span><span class="hl-1">.</span><span class="hl-7">a</span><span class="hl-1">(</span><span class="hl-5">&#39;number&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">user</span><span class="hl-1">.</span><span class="hl-6">id</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-7">equal</span><span class="hl-1">(</span><span class="hl-8">0</span><span class="hl-1">)</span><br/><span class="hl-1">    })</span><br/><span class="hl-1">    </span><span class="hl-7">it</span><span class="hl-1">(</span><span class="hl-5">&#39;User Objects should have a name&#39;</span><span class="hl-1">, () </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">user</span><span class="hl-1">.</span><span class="hl-6">name</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">be</span><span class="hl-1">.</span><span class="hl-7">a</span><span class="hl-1">(</span><span class="hl-5">&#39;string&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">user</span><span class="hl-1">.</span><span class="hl-6">name</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-7">equal</span><span class="hl-1">(</span><span class="hl-5">&#39;Iluzio&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">    })</span><br/><span class="hl-1">    </span><span class="hl-7">it</span><span class="hl-1">(</span><span class="hl-5">&#39;User Objects should have an sport activity&#39;</span><span class="hl-1">, () </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">Object</span><span class="hl-1">.</span><span class="hl-7">values</span><span class="hl-1">(</span><span class="hl-6">Activity</span><span class="hl-1">)).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-7">include</span><span class="hl-1">(</span><span class="hl-6">user</span><span class="hl-1">.</span><span class="hl-6">activity</span><span class="hl-1">)</span><br/><span class="hl-1">    })</span><br/><br/><span class="hl-1">    </span><span class="hl-7">it</span><span class="hl-1">(</span><span class="hl-5">&#39;User Objects should have a list of users&#39;</span><span class="hl-1">, () </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">user</span><span class="hl-1">.</span><span class="hl-6">users</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">be</span><span class="hl-1">.</span><span class="hl-7">a</span><span class="hl-1">(</span><span class="hl-5">&#39;array&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">user</span><span class="hl-1">.</span><span class="hl-6">users</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">have</span><span class="hl-1">.</span><span class="hl-7">lengthOf</span><span class="hl-1">(</span><span class="hl-8">0</span><span class="hl-1">)</span><br/><span class="hl-1">    })</span><br/><span class="hl-1">    </span><span class="hl-7">it</span><span class="hl-1">(</span><span class="hl-5">&#39;User Objects should be able to add users&#39;</span><span class="hl-1">, () </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-6">user</span><span class="hl-1">.</span><span class="hl-6">users</span><span class="hl-1">.</span><span class="hl-7">add</span><span class="hl-1">(</span><span class="hl-8">1</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">user</span><span class="hl-1">.</span><span class="hl-6">users</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">have</span><span class="hl-1">.</span><span class="hl-7">lengthOf</span><span class="hl-1">(</span><span class="hl-8">1</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">user</span><span class="hl-1">.</span><span class="hl-6">users</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-7">include</span><span class="hl-1">(</span><span class="hl-8">1</span><span class="hl-1">)</span><br/><span class="hl-1">    })</span><br/><span class="hl-1">    </span><span class="hl-7">it</span><span class="hl-1">(</span><span class="hl-5">&#39;User Objects should be able to remove users&#39;</span><span class="hl-1">, () </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-6">user</span><span class="hl-1">.</span><span class="hl-6">users</span><span class="hl-1">.</span><span class="hl-7">remove</span><span class="hl-1">(</span><span class="hl-8">1</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">user</span><span class="hl-1">.</span><span class="hl-6">users</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">have</span><span class="hl-1">.</span><span class="hl-7">lengthOf</span><span class="hl-1">(</span><span class="hl-8">0</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">user</span><span class="hl-1">.</span><span class="hl-6">users</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">not</span><span class="hl-1">.</span><span class="hl-7">include</span><span class="hl-1">(</span><span class="hl-8">1</span><span class="hl-1">)</span><br/><span class="hl-1">    })</span><br/><span class="hl-1">    </span><span class="hl-7">it</span><span class="hl-1">(</span><span class="hl-5">&#39;User Objects should have a list of groups in which the user is&#39;</span><span class="hl-1">, () </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">user</span><span class="hl-1">.</span><span class="hl-6">groups</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">be</span><span class="hl-1">.</span><span class="hl-7">a</span><span class="hl-1">(</span><span class="hl-5">&#39;array&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">user</span><span class="hl-1">.</span><span class="hl-6">groups</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">have</span><span class="hl-1">.</span><span class="hl-7">lengthOf</span><span class="hl-1">(</span><span class="hl-8">0</span><span class="hl-1">)</span><br/><span class="hl-1">    })</span><br/><span class="hl-1">    </span><span class="hl-7">it</span><span class="hl-1">(</span><span class="hl-5">&#39;User Objects should be able to add groups&#39;</span><span class="hl-1">, () </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-6">user</span><span class="hl-1">.</span><span class="hl-6">groups</span><span class="hl-1">.</span><span class="hl-7">add</span><span class="hl-1">(</span><span class="hl-8">1</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">user</span><span class="hl-1">.</span><span class="hl-6">groups</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">have</span><span class="hl-1">.</span><span class="hl-7">lengthOf</span><span class="hl-1">(</span><span class="hl-8">1</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">user</span><span class="hl-1">.</span><span class="hl-6">groups</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-7">include</span><span class="hl-1">(</span><span class="hl-8">1</span><span class="hl-1">)</span><br/><span class="hl-1">    })</span><br/><span class="hl-1">    </span><span class="hl-7">it</span><span class="hl-1">(</span><span class="hl-5">&#39;User Objects should be able to remove groups&#39;</span><span class="hl-1">, () </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-6">user</span><span class="hl-1">.</span><span class="hl-6">groups</span><span class="hl-1">.</span><span class="hl-7">remove</span><span class="hl-1">(</span><span class="hl-8">1</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">user</span><span class="hl-1">.</span><span class="hl-6">groups</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">have</span><span class="hl-1">.</span><span class="hl-7">lengthOf</span><span class="hl-1">(</span><span class="hl-8">0</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">user</span><span class="hl-1">.</span><span class="hl-6">groups</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">not</span><span class="hl-1">.</span><span class="hl-7">include</span><span class="hl-1">(</span><span class="hl-8">1</span><span class="hl-1">)</span><br/><span class="hl-1">    })</span><br/><span class="hl-1">    </span><span class="hl-7">it</span><span class="hl-1">(</span><span class="hl-5">&#39;User Objects should have stats&#39;</span><span class="hl-1">, () </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">Object</span><span class="hl-1">.</span><span class="hl-7">keys</span><span class="hl-1">(</span><span class="hl-6">user</span><span class="hl-1">.</span><span class="hl-6">stats</span><span class="hl-1">.</span><span class="hl-6">values</span><span class="hl-1">)).</span><span class="hl-7">includes</span><span class="hl-1">(</span><span class="hl-5">&#39;weekly&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">Object</span><span class="hl-1">.</span><span class="hl-7">keys</span><span class="hl-1">(</span><span class="hl-6">user</span><span class="hl-1">.</span><span class="hl-6">stats</span><span class="hl-1">.</span><span class="hl-6">values</span><span class="hl-1">)).</span><span class="hl-7">includes</span><span class="hl-1">(</span><span class="hl-5">&#39;monthly&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">Object</span><span class="hl-1">.</span><span class="hl-7">keys</span><span class="hl-1">(</span><span class="hl-6">user</span><span class="hl-1">.</span><span class="hl-6">stats</span><span class="hl-1">.</span><span class="hl-6">values</span><span class="hl-1">)).</span><span class="hl-7">includes</span><span class="hl-1">(</span><span class="hl-5">&#39;yearly&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">    })</span><br/><span class="hl-1">    </span><span class="hl-7">it</span><span class="hl-1">(</span><span class="hl-5">&#39;User Objects should be able to reset stats&#39;</span><span class="hl-1">, () </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-6">user</span><span class="hl-1">.</span><span class="hl-6">stats</span><span class="hl-1">.</span><span class="hl-7">reset</span><span class="hl-1">()</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">user</span><span class="hl-1">.</span><span class="hl-6">stats</span><span class="hl-1">.</span><span class="hl-6">values</span><span class="hl-1">[</span><span class="hl-5">&#39;weekly&#39;</span><span class="hl-1">]).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">be</span><span class="hl-1">.</span><span class="hl-6">deep</span><span class="hl-1">.</span><span class="hl-7">equal</span><span class="hl-1">({ </span><span class="hl-6">km:</span><span class="hl-1"> </span><span class="hl-8">0</span><span class="hl-1">, </span><span class="hl-6">slope:</span><span class="hl-1"> </span><span class="hl-8">0</span><span class="hl-1"> })</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">user</span><span class="hl-1">.</span><span class="hl-6">stats</span><span class="hl-1">.</span><span class="hl-6">values</span><span class="hl-1">[</span><span class="hl-5">&#39;monthly&#39;</span><span class="hl-1">]).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">be</span><span class="hl-1">.</span><span class="hl-6">deep</span><span class="hl-1">.</span><span class="hl-7">equal</span><span class="hl-1">({ </span><span class="hl-6">km:</span><span class="hl-1"> </span><span class="hl-8">0</span><span class="hl-1">, </span><span class="hl-6">slope:</span><span class="hl-1"> </span><span class="hl-8">0</span><span class="hl-1"> })</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">user</span><span class="hl-1">.</span><span class="hl-6">stats</span><span class="hl-1">.</span><span class="hl-6">values</span><span class="hl-1">[</span><span class="hl-5">&#39;yearly&#39;</span><span class="hl-1">]).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">be</span><span class="hl-1">.</span><span class="hl-6">deep</span><span class="hl-1">.</span><span class="hl-7">equal</span><span class="hl-1">({ </span><span class="hl-6">km:</span><span class="hl-1"> </span><span class="hl-8">0</span><span class="hl-1">, </span><span class="hl-6">slope:</span><span class="hl-1"> </span><span class="hl-8">0</span><span class="hl-1"> })</span><br/><span class="hl-1">    })</span><br/><span class="hl-1">    </span><span class="hl-7">it</span><span class="hl-1">(</span><span class="hl-5">&#39;User Objects should have a list of favorite tracks&#39;</span><span class="hl-1">, () </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">user</span><span class="hl-1">.</span><span class="hl-6">tracks</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">be</span><span class="hl-1">.</span><span class="hl-7">a</span><span class="hl-1">(</span><span class="hl-5">&#39;array&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">user</span><span class="hl-1">.</span><span class="hl-6">tracks</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">have</span><span class="hl-1">.</span><span class="hl-7">lengthOf</span><span class="hl-1">(</span><span class="hl-8">0</span><span class="hl-1">)</span><br/><span class="hl-1">    })</span><br/><span class="hl-1">    </span><span class="hl-7">it</span><span class="hl-1">(</span><span class="hl-5">&#39;User Objects should be able to add favorite tracks&#39;</span><span class="hl-1">, () </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-6">user</span><span class="hl-1">.</span><span class="hl-6">tracks</span><span class="hl-1">.</span><span class="hl-7">add</span><span class="hl-1">(</span><span class="hl-8">1</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">user</span><span class="hl-1">.</span><span class="hl-6">tracks</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">have</span><span class="hl-1">.</span><span class="hl-7">lengthOf</span><span class="hl-1">(</span><span class="hl-8">1</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">user</span><span class="hl-1">.</span><span class="hl-6">tracks</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-7">include</span><span class="hl-1">(</span><span class="hl-8">1</span><span class="hl-1">)</span><br/><span class="hl-1">    })</span><br/><span class="hl-1">    </span><span class="hl-7">it</span><span class="hl-1">(</span><span class="hl-5">&#39;User Objects should be able to remove favorite tracks&#39;</span><span class="hl-1">, () </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-6">user</span><span class="hl-1">.</span><span class="hl-6">tracks</span><span class="hl-1">.</span><span class="hl-7">remove</span><span class="hl-1">(</span><span class="hl-8">1</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">user</span><span class="hl-1">.</span><span class="hl-6">tracks</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">have</span><span class="hl-1">.</span><span class="hl-7">lengthOf</span><span class="hl-1">(</span><span class="hl-8">0</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">user</span><span class="hl-1">.</span><span class="hl-6">tracks</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">not</span><span class="hl-1">.</span><span class="hl-7">include</span><span class="hl-1">(</span><span class="hl-8">1</span><span class="hl-1">)</span><br/><span class="hl-1">    })</span><br/><span class="hl-1">    </span><span class="hl-7">it</span><span class="hl-1">(</span><span class="hl-5">&#39;User Objects should have a list of active challenges&#39;</span><span class="hl-1">, () </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">user</span><span class="hl-1">.</span><span class="hl-6">challenges</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">be</span><span class="hl-1">.</span><span class="hl-7">a</span><span class="hl-1">(</span><span class="hl-5">&#39;array&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">user</span><span class="hl-1">.</span><span class="hl-6">challenges</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">have</span><span class="hl-1">.</span><span class="hl-7">lengthOf</span><span class="hl-1">(</span><span class="hl-8">0</span><span class="hl-1">)</span><br/><span class="hl-1">    })</span><br/><span class="hl-1">    </span><span class="hl-7">it</span><span class="hl-1">(</span><span class="hl-5">&#39;User Objects should be able to add active challenges&#39;</span><span class="hl-1">, () </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-6">user</span><span class="hl-1">.</span><span class="hl-6">challenges</span><span class="hl-1">.</span><span class="hl-7">add</span><span class="hl-1">(</span><span class="hl-8">1</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">user</span><span class="hl-1">.</span><span class="hl-6">challenges</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">have</span><span class="hl-1">.</span><span class="hl-7">lengthOf</span><span class="hl-1">(</span><span class="hl-8">1</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">user</span><span class="hl-1">.</span><span class="hl-6">challenges</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-7">include</span><span class="hl-1">(</span><span class="hl-8">1</span><span class="hl-1">)</span><br/><span class="hl-1">    })</span><br/><span class="hl-1">    </span><span class="hl-7">it</span><span class="hl-1">(</span><span class="hl-5">&#39;User Objects should be able to remove active challenges&#39;</span><span class="hl-1">, () </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-6">user</span><span class="hl-1">.</span><span class="hl-6">challenges</span><span class="hl-1">.</span><span class="hl-7">remove</span><span class="hl-1">(</span><span class="hl-8">1</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">user</span><span class="hl-1">.</span><span class="hl-6">challenges</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">have</span><span class="hl-1">.</span><span class="hl-7">lengthOf</span><span class="hl-1">(</span><span class="hl-8">0</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">user</span><span class="hl-1">.</span><span class="hl-6">challenges</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">not</span><span class="hl-1">.</span><span class="hl-7">include</span><span class="hl-1">(</span><span class="hl-8">1</span><span class="hl-1">)</span><br/><span class="hl-1">    })</span><br/><span class="hl-1">    </span><span class="hl-7">it</span><span class="hl-1">(</span><span class="hl-5">&#39;User Objects should have a record of the tracks done&#39;</span><span class="hl-1">, () </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">user</span><span class="hl-1">.</span><span class="hl-6">records</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">be</span><span class="hl-1">.</span><span class="hl-7">a</span><span class="hl-1">(</span><span class="hl-5">&#39;array&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">user</span><span class="hl-1">.</span><span class="hl-6">records</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">have</span><span class="hl-1">.</span><span class="hl-7">lengthOf</span><span class="hl-1">(</span><span class="hl-8">0</span><span class="hl-1">)</span><br/><span class="hl-1">    })</span><br/><span class="hl-1">    </span><span class="hl-7">it</span><span class="hl-1">(</span><span class="hl-5">&#39;User Objects should be able to add records&#39;</span><span class="hl-1">, () </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-6">user</span><span class="hl-1">.</span><span class="hl-6">records</span><span class="hl-1">.</span><span class="hl-7">add</span><span class="hl-1">({ </span><span class="hl-6">date:</span><span class="hl-1"> </span><span class="hl-5">&#39;2019-01-01&#39;</span><span class="hl-1">, </span><span class="hl-6">tracks:</span><span class="hl-1"> </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-7">UniqueList</span><span class="hl-1">(</span><span class="hl-8">1</span><span class="hl-1">, </span><span class="hl-8">2</span><span class="hl-1">, </span><span class="hl-8">3</span><span class="hl-1">) })</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">user</span><span class="hl-1">.</span><span class="hl-6">records</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">have</span><span class="hl-1">.</span><span class="hl-7">lengthOf</span><span class="hl-1">(</span><span class="hl-8">1</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">user</span><span class="hl-1">.</span><span class="hl-6">records</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">be</span><span class="hl-1">.</span><span class="hl-6">deep</span><span class="hl-1">.</span><span class="hl-7">equal</span><span class="hl-1">([</span><br/><span class="hl-1">        { </span><span class="hl-6">date:</span><span class="hl-1"> </span><span class="hl-5">&#39;2019-01-01&#39;</span><span class="hl-1">, </span><span class="hl-6">tracks:</span><span class="hl-1"> </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-7">UniqueList</span><span class="hl-1">(</span><span class="hl-8">1</span><span class="hl-1">, </span><span class="hl-8">2</span><span class="hl-1">, </span><span class="hl-8">3</span><span class="hl-1">) },</span><br/><span class="hl-1">      ])</span><br/><span class="hl-1">    })</span><br/><span class="hl-1">    </span><span class="hl-7">it</span><span class="hl-1">(</span><span class="hl-5">&#39;User Objects should know if the friend/group/favorite/challenge/record is in the list when adding&#39;</span><span class="hl-1">, () </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-6">user</span><span class="hl-1">.</span><span class="hl-6">users</span><span class="hl-1">.</span><span class="hl-7">add</span><span class="hl-1">(</span><span class="hl-8">1</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">user</span><span class="hl-1">.</span><span class="hl-6">users</span><span class="hl-1">.</span><span class="hl-7">add</span><span class="hl-1">(</span><span class="hl-8">1</span><span class="hl-1">)).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">be</span><span class="hl-1">.</span><span class="hl-6">false</span><br/><span class="hl-1">      </span><span class="hl-6">user</span><span class="hl-1">.</span><span class="hl-6">groups</span><span class="hl-1">.</span><span class="hl-7">add</span><span class="hl-1">(</span><span class="hl-8">1</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">user</span><span class="hl-1">.</span><span class="hl-6">groups</span><span class="hl-1">.</span><span class="hl-7">add</span><span class="hl-1">(</span><span class="hl-8">1</span><span class="hl-1">)).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">be</span><span class="hl-1">.</span><span class="hl-6">false</span><br/><span class="hl-1">      </span><span class="hl-6">user</span><span class="hl-1">.</span><span class="hl-6">tracks</span><span class="hl-1">.</span><span class="hl-7">add</span><span class="hl-1">(</span><span class="hl-8">1</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">user</span><span class="hl-1">.</span><span class="hl-6">tracks</span><span class="hl-1">.</span><span class="hl-7">add</span><span class="hl-1">(</span><span class="hl-8">1</span><span class="hl-1">)).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">be</span><span class="hl-1">.</span><span class="hl-6">false</span><br/><span class="hl-1">      </span><span class="hl-6">user</span><span class="hl-1">.</span><span class="hl-6">challenges</span><span class="hl-1">.</span><span class="hl-7">add</span><span class="hl-1">(</span><span class="hl-8">1</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">user</span><span class="hl-1">.</span><span class="hl-6">challenges</span><span class="hl-1">.</span><span class="hl-7">add</span><span class="hl-1">(</span><span class="hl-8">1</span><span class="hl-1">)).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">be</span><span class="hl-1">.</span><span class="hl-6">false</span><br/><span class="hl-1">      </span><span class="hl-6">user</span><span class="hl-1">.</span><span class="hl-6">records</span><span class="hl-1">.</span><span class="hl-7">add</span><span class="hl-1">({ </span><span class="hl-6">date:</span><span class="hl-1"> </span><span class="hl-5">&#39;2019-01-01&#39;</span><span class="hl-1">, </span><span class="hl-6">tracks:</span><span class="hl-1"> </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-7">UniqueList</span><span class="hl-1">(</span><span class="hl-8">1</span><span class="hl-1">, </span><span class="hl-8">2</span><span class="hl-1">, </span><span class="hl-8">3</span><span class="hl-1">) })</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><br/><span class="hl-1">        </span><span class="hl-6">user</span><span class="hl-1">.</span><span class="hl-6">records</span><span class="hl-1">.</span><span class="hl-7">add</span><span class="hl-1">({</span><br/><span class="hl-1">          </span><span class="hl-6">date:</span><span class="hl-1"> </span><span class="hl-5">&#39;2019-01-01&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">          </span><span class="hl-6">tracks:</span><span class="hl-1"> </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-7">UniqueList</span><span class="hl-1">(</span><span class="hl-8">1</span><span class="hl-1">, </span><span class="hl-8">2</span><span class="hl-1">, </span><span class="hl-8">3</span><span class="hl-1">),</span><br/><span class="hl-1">        })</span><br/><span class="hl-1">      ).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">be</span><span class="hl-1">.</span><span class="hl-6">false</span><br/><span class="hl-1">    })</span><br/><span class="hl-1">    </span><span class="hl-7">it</span><span class="hl-1">(</span><span class="hl-5">&#39;User Objects should know if the friend/group/favorite/challenge/record is not in the list when removing&#39;</span><span class="hl-1">, () </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">user</span><span class="hl-1">.</span><span class="hl-6">users</span><span class="hl-1">.</span><span class="hl-7">remove</span><span class="hl-1">(</span><span class="hl-8">2</span><span class="hl-1">)).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">be</span><span class="hl-1">.</span><span class="hl-6">false</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">user</span><span class="hl-1">.</span><span class="hl-6">groups</span><span class="hl-1">.</span><span class="hl-7">remove</span><span class="hl-1">(</span><span class="hl-8">2</span><span class="hl-1">)).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">be</span><span class="hl-1">.</span><span class="hl-6">false</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">user</span><span class="hl-1">.</span><span class="hl-6">tracks</span><span class="hl-1">.</span><span class="hl-7">remove</span><span class="hl-1">(</span><span class="hl-8">2</span><span class="hl-1">)).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">be</span><span class="hl-1">.</span><span class="hl-6">false</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">user</span><span class="hl-1">.</span><span class="hl-6">challenges</span><span class="hl-1">.</span><span class="hl-7">remove</span><span class="hl-1">(</span><span class="hl-8">2</span><span class="hl-1">)).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">be</span><span class="hl-1">.</span><span class="hl-6">false</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><br/><span class="hl-1">        </span><span class="hl-6">user</span><span class="hl-1">.</span><span class="hl-6">records</span><span class="hl-1">.</span><span class="hl-7">remove</span><span class="hl-1">({</span><br/><span class="hl-1">          </span><span class="hl-6">date:</span><span class="hl-1"> </span><span class="hl-5">&#39;2019-01-01&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">          </span><span class="hl-6">tracks:</span><span class="hl-1"> </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-7">UniqueList</span><span class="hl-1">(</span><span class="hl-8">1</span><span class="hl-1">, </span><span class="hl-8">2</span><span class="hl-1">),</span><br/><span class="hl-1">        })</span><br/><span class="hl-1">      ).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">be</span><span class="hl-1">.</span><span class="hl-6">false</span><br/><span class="hl-1">    })</span><br/><span class="hl-1">  })</span><br/><br/><span class="hl-1">  </span><span class="hl-7">describe</span><span class="hl-1">(</span><span class="hl-5">&#39;Group class tests&#39;</span><span class="hl-1">, () </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-4">group</span><span class="hl-1"> = </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-7">Group</span><span class="hl-1">(</span><span class="hl-8">0</span><span class="hl-1">, </span><span class="hl-5">&#39;Canary Team&#39;</span><span class="hl-1">, </span><span class="hl-8">3</span><span class="hl-1">, </span><span class="hl-8">4</span><span class="hl-1">)</span><br/><span class="hl-1">    </span><span class="hl-7">it</span><span class="hl-1">(</span><span class="hl-5">&#39;Group Objects should have an id&#39;</span><span class="hl-1">, () </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">group</span><span class="hl-1">.</span><span class="hl-6">id</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">be</span><span class="hl-1">.</span><span class="hl-7">a</span><span class="hl-1">(</span><span class="hl-5">&#39;number&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">group</span><span class="hl-1">.</span><span class="hl-6">id</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-7">equal</span><span class="hl-1">(</span><span class="hl-8">0</span><span class="hl-1">)</span><br/><span class="hl-1">    })</span><br/><span class="hl-1">    </span><span class="hl-7">it</span><span class="hl-1">(</span><span class="hl-5">&#39;Group Objects should have a name&#39;</span><span class="hl-1">, () </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">group</span><span class="hl-1">.</span><span class="hl-6">name</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">be</span><span class="hl-1">.</span><span class="hl-7">a</span><span class="hl-1">(</span><span class="hl-5">&#39;string&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">group</span><span class="hl-1">.</span><span class="hl-6">name</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-7">equal</span><span class="hl-1">(</span><span class="hl-5">&#39;Canary Team&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">    })</span><br/><span class="hl-1">    </span><span class="hl-7">it</span><span class="hl-1">(</span><span class="hl-5">&#39;Group Objects should have a list of users&#39;</span><span class="hl-1">, () </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">group</span><span class="hl-1">.</span><span class="hl-6">users</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">be</span><span class="hl-1">.</span><span class="hl-7">a</span><span class="hl-1">(</span><span class="hl-5">&#39;array&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">group</span><span class="hl-1">.</span><span class="hl-6">users</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">have</span><span class="hl-1">.</span><span class="hl-7">lengthOf</span><span class="hl-1">(</span><span class="hl-8">2</span><span class="hl-1">)</span><br/><span class="hl-1">    })</span><br/><span class="hl-1">    </span><span class="hl-7">it</span><span class="hl-1">(</span><span class="hl-5">&#39;Group Objects should be able to add users&#39;</span><span class="hl-1">, () </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-6">group</span><span class="hl-1">.</span><span class="hl-6">users</span><span class="hl-1">.</span><span class="hl-7">add</span><span class="hl-1">(</span><span class="hl-8">1</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">group</span><span class="hl-1">.</span><span class="hl-6">users</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">have</span><span class="hl-1">.</span><span class="hl-7">lengthOf</span><span class="hl-1">(</span><span class="hl-8">3</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">group</span><span class="hl-1">.</span><span class="hl-6">users</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-7">include</span><span class="hl-1">(</span><span class="hl-8">1</span><span class="hl-1">)</span><br/><span class="hl-1">    })</span><br/><span class="hl-1">    </span><span class="hl-7">it</span><span class="hl-1">(</span><span class="hl-5">&#39;Group Objects should be able to remove users&#39;</span><span class="hl-1">, () </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-6">group</span><span class="hl-1">.</span><span class="hl-6">users</span><span class="hl-1">.</span><span class="hl-7">remove</span><span class="hl-1">(</span><span class="hl-8">1</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">group</span><span class="hl-1">.</span><span class="hl-6">users</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">have</span><span class="hl-1">.</span><span class="hl-7">lengthOf</span><span class="hl-1">(</span><span class="hl-8">2</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">group</span><span class="hl-1">.</span><span class="hl-6">users</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">not</span><span class="hl-1">.</span><span class="hl-7">include</span><span class="hl-1">(</span><span class="hl-8">1</span><span class="hl-1">)</span><br/><span class="hl-1">    })</span><br/><span class="hl-1">    </span><span class="hl-7">it</span><span class="hl-1">(</span><span class="hl-5">&#39;Group Objects should have stats&#39;</span><span class="hl-1">, () </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">Object</span><span class="hl-1">.</span><span class="hl-7">keys</span><span class="hl-1">(</span><span class="hl-6">group</span><span class="hl-1">.</span><span class="hl-6">stats</span><span class="hl-1">.</span><span class="hl-6">values</span><span class="hl-1">)).</span><span class="hl-7">includes</span><span class="hl-1">(</span><span class="hl-5">&#39;weekly&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">Object</span><span class="hl-1">.</span><span class="hl-7">keys</span><span class="hl-1">(</span><span class="hl-6">group</span><span class="hl-1">.</span><span class="hl-6">stats</span><span class="hl-1">.</span><span class="hl-6">values</span><span class="hl-1">)).</span><span class="hl-7">includes</span><span class="hl-1">(</span><span class="hl-5">&#39;monthly&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">Object</span><span class="hl-1">.</span><span class="hl-7">keys</span><span class="hl-1">(</span><span class="hl-6">group</span><span class="hl-1">.</span><span class="hl-6">stats</span><span class="hl-1">.</span><span class="hl-6">values</span><span class="hl-1">)).</span><span class="hl-7">includes</span><span class="hl-1">(</span><span class="hl-5">&#39;yearly&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">    })</span><br/><span class="hl-1">    </span><span class="hl-7">it</span><span class="hl-1">(</span><span class="hl-5">&#39;Group Objects should be able to reset stats&#39;</span><span class="hl-1">, () </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-6">group</span><span class="hl-1">.</span><span class="hl-6">stats</span><span class="hl-1">.</span><span class="hl-7">reset</span><span class="hl-1">()</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">group</span><span class="hl-1">.</span><span class="hl-6">stats</span><span class="hl-1">.</span><span class="hl-6">values</span><span class="hl-1">[</span><span class="hl-5">&#39;weekly&#39;</span><span class="hl-1">]).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">be</span><span class="hl-1">.</span><span class="hl-6">deep</span><span class="hl-1">.</span><span class="hl-7">equal</span><span class="hl-1">({ </span><span class="hl-6">km:</span><span class="hl-1"> </span><span class="hl-8">0</span><span class="hl-1">, </span><span class="hl-6">slope:</span><span class="hl-1"> </span><span class="hl-8">0</span><span class="hl-1"> })</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">group</span><span class="hl-1">.</span><span class="hl-6">stats</span><span class="hl-1">.</span><span class="hl-6">values</span><span class="hl-1">[</span><span class="hl-5">&#39;monthly&#39;</span><span class="hl-1">]).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">be</span><span class="hl-1">.</span><span class="hl-6">deep</span><span class="hl-1">.</span><span class="hl-7">equal</span><span class="hl-1">({</span><br/><span class="hl-1">        </span><span class="hl-6">km:</span><span class="hl-1"> </span><span class="hl-8">0</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-6">slope:</span><span class="hl-1"> </span><span class="hl-8">0</span><span class="hl-1">,</span><br/><span class="hl-1">      })</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">group</span><span class="hl-1">.</span><span class="hl-6">stats</span><span class="hl-1">.</span><span class="hl-6">values</span><span class="hl-1">[</span><span class="hl-5">&#39;yearly&#39;</span><span class="hl-1">]).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">be</span><span class="hl-1">.</span><span class="hl-6">deep</span><span class="hl-1">.</span><span class="hl-7">equal</span><span class="hl-1">({ </span><span class="hl-6">km:</span><span class="hl-1"> </span><span class="hl-8">0</span><span class="hl-1">, </span><span class="hl-6">slope:</span><span class="hl-1"> </span><span class="hl-8">0</span><span class="hl-1"> })</span><br/><span class="hl-1">    })</span><br/><span class="hl-1">    </span><span class="hl-7">it</span><span class="hl-1">(</span><span class="hl-5">&#39;Group Objects should have a list of favorite tracks&#39;</span><span class="hl-1">, () </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">group</span><span class="hl-1">.</span><span class="hl-6">tracks</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">be</span><span class="hl-1">.</span><span class="hl-7">a</span><span class="hl-1">(</span><span class="hl-5">&#39;array&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">group</span><span class="hl-1">.</span><span class="hl-6">tracks</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">have</span><span class="hl-1">.</span><span class="hl-7">lengthOf</span><span class="hl-1">(</span><span class="hl-8">0</span><span class="hl-1">)</span><br/><span class="hl-1">    })</span><br/><span class="hl-1">    </span><span class="hl-7">it</span><span class="hl-1">(</span><span class="hl-5">&#39;Group Objects should be able to add favorite tracks&#39;</span><span class="hl-1">, () </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-6">group</span><span class="hl-1">.</span><span class="hl-6">tracks</span><span class="hl-1">.</span><span class="hl-7">add</span><span class="hl-1">(</span><span class="hl-8">1</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">group</span><span class="hl-1">.</span><span class="hl-6">tracks</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">have</span><span class="hl-1">.</span><span class="hl-7">lengthOf</span><span class="hl-1">(</span><span class="hl-8">1</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">group</span><span class="hl-1">.</span><span class="hl-6">tracks</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-7">include</span><span class="hl-1">(</span><span class="hl-8">1</span><span class="hl-1">)</span><br/><span class="hl-1">    })</span><br/><span class="hl-1">    </span><span class="hl-7">it</span><span class="hl-1">(</span><span class="hl-5">&#39;Group Objects should be able to remove favorite tracks&#39;</span><span class="hl-1">, () </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-6">group</span><span class="hl-1">.</span><span class="hl-6">tracks</span><span class="hl-1">.</span><span class="hl-7">remove</span><span class="hl-1">(</span><span class="hl-8">1</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">group</span><span class="hl-1">.</span><span class="hl-6">tracks</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">have</span><span class="hl-1">.</span><span class="hl-7">lengthOf</span><span class="hl-1">(</span><span class="hl-8">0</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">group</span><span class="hl-1">.</span><span class="hl-6">tracks</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">not</span><span class="hl-1">.</span><span class="hl-7">include</span><span class="hl-1">(</span><span class="hl-8">1</span><span class="hl-1">)</span><br/><span class="hl-1">    })</span><br/><span class="hl-1">    </span><span class="hl-7">it</span><span class="hl-1">(</span><span class="hl-5">&#39;Group Objects should have a record of the tracks done&#39;</span><span class="hl-1">, () </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">group</span><span class="hl-1">.</span><span class="hl-6">records</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">be</span><span class="hl-1">.</span><span class="hl-7">a</span><span class="hl-1">(</span><span class="hl-5">&#39;array&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">group</span><span class="hl-1">.</span><span class="hl-6">records</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">have</span><span class="hl-1">.</span><span class="hl-7">lengthOf</span><span class="hl-1">(</span><span class="hl-8">0</span><span class="hl-1">)</span><br/><span class="hl-1">    })</span><br/><span class="hl-1">    </span><span class="hl-7">it</span><span class="hl-1">(</span><span class="hl-5">&#39;Group Objects should be able to add records&#39;</span><span class="hl-1">, () </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-6">group</span><span class="hl-1">.</span><span class="hl-6">records</span><span class="hl-1">.</span><span class="hl-7">add</span><span class="hl-1">({</span><br/><span class="hl-1">        </span><span class="hl-6">date:</span><span class="hl-1"> </span><span class="hl-5">&#39;2019-01-01&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-6">tracks:</span><span class="hl-1"> </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-7">UniqueList</span><span class="hl-1">(</span><span class="hl-8">1</span><span class="hl-1">, </span><span class="hl-8">2</span><span class="hl-1">, </span><span class="hl-8">3</span><span class="hl-1">),</span><br/><span class="hl-1">        </span><span class="hl-6">users:</span><span class="hl-1"> </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-7">UniqueList</span><span class="hl-1">(</span><span class="hl-8">1</span><span class="hl-1">, </span><span class="hl-8">2</span><span class="hl-1">, </span><span class="hl-8">3</span><span class="hl-1">),</span><br/><span class="hl-1">        </span><span class="hl-6">km:</span><span class="hl-1"> </span><span class="hl-8">10</span><span class="hl-1">,</span><br/><span class="hl-1">      })</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">group</span><span class="hl-1">.</span><span class="hl-6">records</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">have</span><span class="hl-1">.</span><span class="hl-7">lengthOf</span><span class="hl-1">(</span><span class="hl-8">1</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">group</span><span class="hl-1">.</span><span class="hl-6">records</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">be</span><span class="hl-1">.</span><span class="hl-6">deep</span><span class="hl-1">.</span><span class="hl-7">equal</span><span class="hl-1">([</span><br/><span class="hl-1">        {</span><br/><span class="hl-1">          </span><span class="hl-6">date:</span><span class="hl-1"> </span><span class="hl-5">&#39;2019-01-01&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">          </span><span class="hl-6">tracks:</span><span class="hl-1"> </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-7">UniqueList</span><span class="hl-1">(</span><span class="hl-8">1</span><span class="hl-1">, </span><span class="hl-8">2</span><span class="hl-1">, </span><span class="hl-8">3</span><span class="hl-1">),</span><br/><span class="hl-1">          </span><span class="hl-6">users:</span><span class="hl-1"> </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-7">UniqueList</span><span class="hl-1">(</span><span class="hl-8">1</span><span class="hl-1">, </span><span class="hl-8">2</span><span class="hl-1">, </span><span class="hl-8">3</span><span class="hl-1">),</span><br/><span class="hl-1">          </span><span class="hl-6">km:</span><span class="hl-1"> </span><span class="hl-8">10</span><span class="hl-1">,</span><br/><span class="hl-1">        },</span><br/><span class="hl-1">      ])</span><br/><span class="hl-1">    })</span><br/><span class="hl-1">    </span><span class="hl-7">it</span><span class="hl-1">(</span><span class="hl-5">&#39;Group Objects should know if the user/favorite/record is in the list when adding&#39;</span><span class="hl-1">, () </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-6">group</span><span class="hl-1">.</span><span class="hl-6">users</span><span class="hl-1">.</span><span class="hl-7">add</span><span class="hl-1">(</span><span class="hl-8">1</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">group</span><span class="hl-1">.</span><span class="hl-6">users</span><span class="hl-1">.</span><span class="hl-7">add</span><span class="hl-1">(</span><span class="hl-8">1</span><span class="hl-1">)).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">be</span><span class="hl-1">.</span><span class="hl-6">false</span><br/><span class="hl-1">      </span><span class="hl-6">group</span><span class="hl-1">.</span><span class="hl-6">tracks</span><span class="hl-1">.</span><span class="hl-7">add</span><span class="hl-1">(</span><span class="hl-8">1</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">group</span><span class="hl-1">.</span><span class="hl-6">tracks</span><span class="hl-1">.</span><span class="hl-7">add</span><span class="hl-1">(</span><span class="hl-8">1</span><span class="hl-1">)).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">be</span><span class="hl-1">.</span><span class="hl-6">false</span><br/><span class="hl-1">      </span><span class="hl-6">group</span><span class="hl-1">.</span><span class="hl-6">records</span><span class="hl-1">.</span><span class="hl-7">add</span><span class="hl-1">({</span><br/><span class="hl-1">        </span><span class="hl-6">date:</span><span class="hl-1"> </span><span class="hl-5">&#39;2019-01-01&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-6">tracks:</span><span class="hl-1"> </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-7">UniqueList</span><span class="hl-1">(</span><span class="hl-8">1</span><span class="hl-1">, </span><span class="hl-8">2</span><span class="hl-1">, </span><span class="hl-8">3</span><span class="hl-1">),</span><br/><span class="hl-1">        </span><span class="hl-6">users:</span><span class="hl-1"> </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-7">UniqueList</span><span class="hl-1">(</span><span class="hl-8">1</span><span class="hl-1">, </span><span class="hl-8">2</span><span class="hl-1">, </span><span class="hl-8">3</span><span class="hl-1">),</span><br/><span class="hl-1">        </span><span class="hl-6">km:</span><span class="hl-1"> </span><span class="hl-8">10</span><span class="hl-1">,</span><br/><span class="hl-1">      })</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><br/><span class="hl-1">        </span><span class="hl-6">group</span><span class="hl-1">.</span><span class="hl-6">records</span><span class="hl-1">.</span><span class="hl-7">add</span><span class="hl-1">({</span><br/><span class="hl-1">          </span><span class="hl-6">date:</span><span class="hl-1"> </span><span class="hl-5">&#39;2019-01-01&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">          </span><span class="hl-6">tracks:</span><span class="hl-1"> </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-7">UniqueList</span><span class="hl-1">(</span><span class="hl-8">1</span><span class="hl-1">, </span><span class="hl-8">2</span><span class="hl-1">, </span><span class="hl-8">3</span><span class="hl-1">),</span><br/><span class="hl-1">          </span><span class="hl-6">users:</span><span class="hl-1"> </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-7">UniqueList</span><span class="hl-1">(</span><span class="hl-8">1</span><span class="hl-1">, </span><span class="hl-8">2</span><span class="hl-1">, </span><span class="hl-8">3</span><span class="hl-1">),</span><br/><span class="hl-1">          </span><span class="hl-6">km:</span><span class="hl-1"> </span><span class="hl-8">10</span><span class="hl-1">,</span><br/><span class="hl-1">        })</span><br/><span class="hl-1">      ).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">be</span><span class="hl-1">.</span><span class="hl-6">false</span><br/><span class="hl-1">    })</span><br/><span class="hl-1">    </span><span class="hl-7">it</span><span class="hl-1">(</span><span class="hl-5">&#39;Group Objects should know if the user/favorite/record is not in the list when removing&#39;</span><span class="hl-1">, () </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">group</span><span class="hl-1">.</span><span class="hl-6">users</span><span class="hl-1">.</span><span class="hl-7">remove</span><span class="hl-1">(</span><span class="hl-8">2</span><span class="hl-1">)).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">be</span><span class="hl-1">.</span><span class="hl-6">false</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">group</span><span class="hl-1">.</span><span class="hl-6">tracks</span><span class="hl-1">.</span><span class="hl-7">remove</span><span class="hl-1">(</span><span class="hl-8">2</span><span class="hl-1">)).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">be</span><span class="hl-1">.</span><span class="hl-6">false</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><br/><span class="hl-1">        </span><span class="hl-6">group</span><span class="hl-1">.</span><span class="hl-6">records</span><span class="hl-1">.</span><span class="hl-7">remove</span><span class="hl-1">({</span><br/><span class="hl-1">          </span><span class="hl-6">date:</span><span class="hl-1"> </span><span class="hl-5">&#39;2019-01-01&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">          </span><span class="hl-6">tracks:</span><span class="hl-1"> </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-7">UniqueList</span><span class="hl-1">(</span><span class="hl-8">1</span><span class="hl-1">, </span><span class="hl-8">2</span><span class="hl-1">),</span><br/><span class="hl-1">          </span><span class="hl-6">users:</span><span class="hl-1"> </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-7">UniqueList</span><span class="hl-1">(</span><span class="hl-8">1</span><span class="hl-1">, </span><span class="hl-8">2</span><span class="hl-1">),</span><br/><span class="hl-1">          </span><span class="hl-6">km:</span><span class="hl-1"> </span><span class="hl-8">10</span><span class="hl-1">,</span><br/><span class="hl-1">        })</span><br/><span class="hl-1">      ).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">be</span><span class="hl-1">.</span><span class="hl-6">false</span><br/><span class="hl-1">    })</span><br/><span class="hl-1">    </span><span class="hl-7">it</span><span class="hl-1">(</span><span class="hl-5">&#39;Group Objects should have a ranking&#39;</span><span class="hl-1">, () </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-6">group</span><span class="hl-1">.</span><span class="hl-6">records</span><span class="hl-1">.</span><span class="hl-7">add</span><span class="hl-1">({</span><br/><span class="hl-1">        </span><span class="hl-6">date:</span><span class="hl-1"> </span><span class="hl-5">&#39;2023-01-01&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-6">tracks:</span><span class="hl-1"> </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-7">UniqueList</span><span class="hl-1">(</span><span class="hl-8">1</span><span class="hl-1">, </span><span class="hl-8">3</span><span class="hl-1">),</span><br/><span class="hl-1">        </span><span class="hl-6">users:</span><span class="hl-1"> </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-7">UniqueList</span><span class="hl-1">(</span><span class="hl-8">3</span><span class="hl-1">),</span><br/><span class="hl-1">        </span><span class="hl-6">km:</span><span class="hl-1"> </span><span class="hl-8">250</span><span class="hl-1">,</span><br/><span class="hl-1">      })</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">group</span><span class="hl-1">.</span><span class="hl-6">ranking</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">be</span><span class="hl-1">.</span><span class="hl-7">a</span><span class="hl-1">(</span><span class="hl-5">&#39;array&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">group</span><span class="hl-1">.</span><span class="hl-6">ranking</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">have</span><span class="hl-1">.</span><span class="hl-7">lengthOf</span><span class="hl-1">(</span><span class="hl-8">2</span><span class="hl-1">)</span><br/><span class="hl-1">    })</span><br/><span class="hl-1">  })</span><br/><br/><span class="hl-1">  </span><span class="hl-7">describe</span><span class="hl-1">(</span><span class="hl-5">&#39;Challenge class tests&#39;</span><span class="hl-1">, () </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-4">challenge</span><span class="hl-1"> = </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-7">Challenge</span><span class="hl-1">(</span><br/><span class="hl-1">      </span><span class="hl-8">0</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-5">&#39;The World Warrior&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-6">Activity</span><span class="hl-1">.</span><span class="hl-6">cycling</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-8">0</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-8">1</span><br/><span class="hl-1">    )</span><br/><span class="hl-1">    </span><span class="hl-7">it</span><span class="hl-1">(</span><span class="hl-5">&#39;Challenge Objects should have an id&#39;</span><span class="hl-1">, () </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">challenge</span><span class="hl-1">.</span><span class="hl-6">id</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">be</span><span class="hl-1">.</span><span class="hl-7">a</span><span class="hl-1">(</span><span class="hl-5">&#39;number&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">challenge</span><span class="hl-1">.</span><span class="hl-6">id</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-7">equal</span><span class="hl-1">(</span><span class="hl-8">0</span><span class="hl-1">)</span><br/><span class="hl-1">    })</span><br/><span class="hl-1">    </span><span class="hl-7">it</span><span class="hl-1">(</span><span class="hl-5">&#39;Challenge Objects should have a name&#39;</span><span class="hl-1">, () </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">challenge</span><span class="hl-1">.</span><span class="hl-6">name</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">be</span><span class="hl-1">.</span><span class="hl-7">a</span><span class="hl-1">(</span><span class="hl-5">&#39;string&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">challenge</span><span class="hl-1">.</span><span class="hl-6">name</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-7">equal</span><span class="hl-1">(</span><span class="hl-5">&#39;The World Warrior&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">    })</span><br/><span class="hl-1">    </span><span class="hl-7">it</span><span class="hl-1">(</span><span class="hl-5">&#39;Challenge Objects should have an activity&#39;</span><span class="hl-1">, () </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">Object</span><span class="hl-1">.</span><span class="hl-7">values</span><span class="hl-1">(</span><span class="hl-6">Activity</span><span class="hl-1">)).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-7">include</span><span class="hl-1">(</span><span class="hl-6">challenge</span><span class="hl-1">.</span><span class="hl-6">activity</span><span class="hl-1">)</span><br/><span class="hl-1">    })</span><br/><span class="hl-1">    </span><span class="hl-7">it</span><span class="hl-1">(</span><span class="hl-5">&#39;Challenge Objects should have a list of tracks that are part of the challenge&#39;</span><span class="hl-1">, () </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">challenge</span><span class="hl-1">.</span><span class="hl-6">tracks</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">be</span><span class="hl-1">.</span><span class="hl-7">a</span><span class="hl-1">(</span><span class="hl-5">&#39;array&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">challenge</span><span class="hl-1">.</span><span class="hl-6">tracks</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">have</span><span class="hl-1">.</span><span class="hl-7">lengthOf</span><span class="hl-1">(</span><span class="hl-8">2</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">challenge</span><span class="hl-1">.</span><span class="hl-6">tracks</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">be</span><span class="hl-1">.</span><span class="hl-6">deep</span><span class="hl-1">.</span><span class="hl-7">equal</span><span class="hl-1">([</span><span class="hl-8">0</span><span class="hl-1">, </span><span class="hl-8">1</span><span class="hl-1">])</span><br/><span class="hl-1">    })</span><br/><span class="hl-1">    </span><span class="hl-7">it</span><span class="hl-1">(</span><span class="hl-5">&#39;Challenge Objects should be able to add tracks&#39;</span><span class="hl-1">, () </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-6">challenge</span><span class="hl-1">.</span><span class="hl-6">tracks</span><span class="hl-1">.</span><span class="hl-7">add</span><span class="hl-1">(</span><span class="hl-8">2</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">challenge</span><span class="hl-1">.</span><span class="hl-6">tracks</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">have</span><span class="hl-1">.</span><span class="hl-7">lengthOf</span><span class="hl-1">(</span><span class="hl-8">3</span><span class="hl-1">)</span><br/><span class="hl-1">    })</span><br/><span class="hl-1">    </span><span class="hl-7">it</span><span class="hl-1">(</span><span class="hl-5">&#39;Challenge Objects should be able to remove tracks&#39;</span><span class="hl-1">, () </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-6">challenge</span><span class="hl-1">.</span><span class="hl-6">tracks</span><span class="hl-1">.</span><span class="hl-7">remove</span><span class="hl-1">(</span><span class="hl-8">2</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">challenge</span><span class="hl-1">.</span><span class="hl-6">tracks</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">have</span><span class="hl-1">.</span><span class="hl-7">lengthOf</span><span class="hl-1">(</span><span class="hl-8">2</span><span class="hl-1">)</span><br/><span class="hl-1">    })</span><br/><span class="hl-1">    </span><span class="hl-7">it</span><span class="hl-1">(</span><span class="hl-5">&#39;Challenge Objects should have a list of users that are part of the challenge&#39;</span><span class="hl-1">, () </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">challenge</span><span class="hl-1">.</span><span class="hl-6">users</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">be</span><span class="hl-1">.</span><span class="hl-7">a</span><span class="hl-1">(</span><span class="hl-5">&#39;array&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">challenge</span><span class="hl-1">.</span><span class="hl-6">users</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">have</span><span class="hl-1">.</span><span class="hl-7">lengthOf</span><span class="hl-1">(</span><span class="hl-8">0</span><span class="hl-1">)</span><br/><span class="hl-1">    })</span><br/><span class="hl-1">    </span><span class="hl-7">it</span><span class="hl-1">(</span><span class="hl-5">&#39;Challenge Objects should be able to add users&#39;</span><span class="hl-1">, () </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-6">challenge</span><span class="hl-1">.</span><span class="hl-6">users</span><span class="hl-1">.</span><span class="hl-7">add</span><span class="hl-1">(</span><span class="hl-8">1</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">challenge</span><span class="hl-1">.</span><span class="hl-6">users</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">have</span><span class="hl-1">.</span><span class="hl-7">lengthOf</span><span class="hl-1">(</span><span class="hl-8">1</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">challenge</span><span class="hl-1">.</span><span class="hl-6">users</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-7">include</span><span class="hl-1">(</span><span class="hl-8">1</span><span class="hl-1">)</span><br/><span class="hl-1">    })</span><br/><span class="hl-1">    </span><span class="hl-7">it</span><span class="hl-1">(</span><span class="hl-5">&#39;Challenge Objects should be able to remove users&#39;</span><span class="hl-1">, () </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-6">challenge</span><span class="hl-1">.</span><span class="hl-6">users</span><span class="hl-1">.</span><span class="hl-7">remove</span><span class="hl-1">(</span><span class="hl-8">1</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">challenge</span><span class="hl-1">.</span><span class="hl-6">users</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">have</span><span class="hl-1">.</span><span class="hl-7">lengthOf</span><span class="hl-1">(</span><span class="hl-8">0</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">challenge</span><span class="hl-1">.</span><span class="hl-6">users</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">not</span><span class="hl-1">.</span><span class="hl-7">include</span><span class="hl-1">(</span><span class="hl-8">1</span><span class="hl-1">)</span><br/><span class="hl-1">    })</span><br/><span class="hl-1">    </span><span class="hl-7">it</span><span class="hl-1">(</span><span class="hl-5">&#39;Challenge Objects should know if the user/track is in the list when adding&#39;</span><span class="hl-1">, () </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-6">challenge</span><span class="hl-1">.</span><span class="hl-6">users</span><span class="hl-1">.</span><span class="hl-7">add</span><span class="hl-1">(</span><span class="hl-8">1</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">challenge</span><span class="hl-1">.</span><span class="hl-6">users</span><span class="hl-1">.</span><span class="hl-7">add</span><span class="hl-1">(</span><span class="hl-8">1</span><span class="hl-1">)).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">be</span><span class="hl-1">.</span><span class="hl-6">false</span><br/><span class="hl-1">      </span><span class="hl-6">challenge</span><span class="hl-1">.</span><span class="hl-6">tracks</span><span class="hl-1">.</span><span class="hl-7">add</span><span class="hl-1">(</span><span class="hl-8">1</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">challenge</span><span class="hl-1">.</span><span class="hl-6">tracks</span><span class="hl-1">.</span><span class="hl-7">add</span><span class="hl-1">(</span><span class="hl-8">1</span><span class="hl-1">)).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">be</span><span class="hl-1">.</span><span class="hl-6">false</span><br/><span class="hl-1">    })</span><br/><span class="hl-1">    </span><span class="hl-7">it</span><span class="hl-1">(</span><span class="hl-5">&#39;Challenge Objects should know if the user/track is not in the list when removing&#39;</span><span class="hl-1">, () </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">challenge</span><span class="hl-1">.</span><span class="hl-6">users</span><span class="hl-1">.</span><span class="hl-7">remove</span><span class="hl-1">(</span><span class="hl-8">2</span><span class="hl-1">)).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">be</span><span class="hl-1">.</span><span class="hl-6">false</span><br/><span class="hl-1">      </span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-6">challenge</span><span class="hl-1">.</span><span class="hl-6">tracks</span><span class="hl-1">.</span><span class="hl-7">remove</span><span class="hl-1">(</span><span class="hl-8">2</span><span class="hl-1">)).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">be</span><span class="hl-1">.</span><span class="hl-6">false</span><br/><span class="hl-1">    })</span><br/><span class="hl-1">  })</span><br/><span class="hl-1">  </span><span class="hl-7">describe</span><span class="hl-1">(</span><span class="hl-5">&#39;Server class tests&#39;</span><span class="hl-1">, () </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-7">it</span><span class="hl-1">(</span><span class="hl-5">&quot;Servers should be able to make POST requests to &#39;the API&quot;</span><span class="hl-1">, </span><span class="hl-2">async</span><span class="hl-1"> () </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-7">request</span><span class="hl-1">(</span><span class="hl-6">server</span><span class="hl-1">.</span><span class="hl-6">app</span><span class="hl-1">).</span><span class="hl-7">post</span><span class="hl-1">(</span><span class="hl-5">&#39;/users&#39;</span><span class="hl-1">).</span><span class="hl-7">send</span><span class="hl-1">({</span><br/><span class="hl-1">        </span><span class="hl-6">name:</span><span class="hl-1"> </span><span class="hl-5">&#39;Test User&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-6">activity:</span><span class="hl-1"> </span><span class="hl-5">&quot;running&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">      }).</span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-8">201</span><span class="hl-1">)</span><br/><span class="hl-1">      </span><span class="hl-2">let</span><span class="hl-1"> </span><span class="hl-6">user_id</span><br/><span class="hl-1">      </span><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-6">UserModel</span><span class="hl-1">.</span><span class="hl-7">findOne</span><span class="hl-1">({ </span><span class="hl-6">name:</span><span class="hl-1"> </span><span class="hl-5">&#39;Test User&#39;</span><span class="hl-1"> }).</span><span class="hl-7">then</span><span class="hl-1">((</span><span class="hl-6">user</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-6">user</span><span class="hl-1">)</span><br/><span class="hl-1">          </span><span class="hl-6">user_id</span><span class="hl-1"> = </span><span class="hl-6">user</span><span class="hl-1">.</span><span class="hl-6">_id</span><br/><span class="hl-1">      })</span><br/><span class="hl-1">      </span><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-7">request</span><span class="hl-1">(</span><span class="hl-6">server</span><span class="hl-1">.</span><span class="hl-6">app</span><span class="hl-1">).</span><span class="hl-7">post</span><span class="hl-1">(</span><span class="hl-5">&#39;/tracks&#39;</span><span class="hl-1">).</span><span class="hl-7">send</span><span class="hl-1">({</span><br/><span class="hl-1">        </span><span class="hl-6">name:</span><span class="hl-1"> </span><span class="hl-5">&#39;Test Track&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-6">start:</span><span class="hl-1"> {</span><br/><span class="hl-1">          </span><span class="hl-6">lat:</span><span class="hl-1"> </span><span class="hl-8">0</span><span class="hl-1">,</span><br/><span class="hl-1">          </span><span class="hl-6">lng:</span><span class="hl-1"> </span><span class="hl-8">0</span><span class="hl-1">,</span><br/><span class="hl-1">        },</span><br/><span class="hl-1">        </span><span class="hl-6">end:</span><span class="hl-1"> {</span><br/><span class="hl-1">          </span><span class="hl-6">lat:</span><span class="hl-1"> </span><span class="hl-8">1</span><span class="hl-1">,</span><br/><span class="hl-1">          </span><span class="hl-6">lng:</span><span class="hl-1"> </span><span class="hl-8">1</span><span class="hl-1">,</span><br/><span class="hl-1">        },</span><br/><span class="hl-1">        </span><span class="hl-6">distance:</span><span class="hl-1"> </span><span class="hl-8">100</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-6">slope:</span><span class="hl-1"> </span><span class="hl-8">3.1</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-6">users:</span><span class="hl-1"> [</span><span class="hl-6">user_id</span><span class="hl-1">],</span><br/><span class="hl-1">        </span><span class="hl-6">activity:</span><span class="hl-1"> </span><span class="hl-5">&quot;running&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">      }).</span><span class="hl-7">expect</span><span class="hl-1">(</span><span class="hl-8">201</span><span class="hl-1">)</span><br/><span class="hl-1">    })</span><br/><span class="hl-1">  })</span><br/><span class="hl-1">})</span><br/><br/><span class="hl-7">after</span><span class="hl-1">(</span><span class="hl-2">async</span><span class="hl-1"> </span><span class="hl-2">function</span><span class="hl-1"> () {</span><br/><span class="hl-1">  </span><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-6">server</span><span class="hl-1">.</span><span class="hl-7">stop</span><span class="hl-1">()</span><br/><span class="hl-1">  </span><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-7">disconnect</span><span class="hl-1">()</span><br/><span class="hl-1">})</span>
</code></pre>
<p>Y como podemos ver a continuación todas las pruebas fueron superadas con éxito:</p>
<p>También podemos comprobar el cubrimiento de código con Istanbul y Coveralls:</p>
<p>Así que por último mostramos su funcionamiento por terminal:</p>

<a href="#conclusión" id="conclusión" style="color: inherit; text-decoration: none;">
  <h2>Conclusión</h2>
</a>
<p>Ha sido una práctica con cierto nivel de complejidad pero que nos a ayudado no sólo a saber trabajar en equipo por separado si no a usar herramientas como LiveShare en VSC que ha sido de gran ayuda. Cabe destacar que en esta práctica hemos alcanzado nuestro objetivo que era acabar con algo funcional que estuviera a la altura de lños requisitos del guión, gracias al uso de todos los conocimientos adquiridos en la asignatura durante el cuatrimestre.</p>

<a href="#elementos-bibliográficos" id="elementos-bibliográficos" style="color: inherit; text-decoration: none;">
  <h2>Elementos Bibliográficos:</h2>
</a>
<ul>
<li><p>Guión de la práctica 12, <a href="https://ull-esit-inf-dsi-2223.github.io/prct12-destravate-api/">https://ull-esit-inf-dsi-2223.github.io/prct12-destravate-api/</a>.</p>
</li>
<li><p>Adam Freeman - Essential TypeScript 4: From Beginner to ProURL,<a href="https://www.oreilly.com/library/view/essential-typescript-4/9781484270110/html/Part_1.xhtml">https://www.oreilly.com/library/view/essential-typescript-4/9781484270110/html/Part_1.xhtml</a> .</p>
</li>
</ul>
</div></div>
<div class="col-4 col-menu menu-sticky-wrap menu-highlight">
<div class="tsd-navigation settings">
<details class="tsd-index-accordion"><summary class="tsd-accordion-summary">
<h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><path d="M4.93896 8.531L12 15.591L19.061 8.531L16.939 6.409L12 11.349L7.06098 6.409L4.93896 8.531Z" fill="var(--color-text)"></path></svg> Settings</h3></summary>
<div class="tsd-accordion-details">
<div class="tsd-filter-visibility">
<h4 class="uppercase">Member Visibility</h4><form>
<ul id="tsd-filter-options">
<li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li>
<li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-private" name="private"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Private</span></label></li>
<li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li>
<li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></form></div>
<div class="tsd-theme-toggle">
<h4 class="uppercase">Theme</h4><select id="theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div>
<nav class="tsd-navigation primary">
<details class="tsd-index-accordion" open><summary class="tsd-accordion-summary">
<h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><path d="M4.93896 8.531L12 15.591L19.061 8.531L16.939 6.409L12 11.349L7.06098 6.409L4.93896 8.531Z" fill="var(--color-text)"></path></svg> Modules</h3></summary>
<div class="tsd-accordion-details">
<ul>
<li class="current selected"><a href="modules.html">prct12</a>
<ul>
<li class="tsd-kind-module"><a href="modules/Activity.html">Activity</a></li>
<li class="tsd-kind-module"><a href="modules/Challenge.html">Challenge</a></li>
<li class="tsd-kind-module"><a href="modules/Coordinate.html">Coordinate</a></li>
<li class="tsd-kind-module"><a href="modules/Entry.html">Entry</a></li>
<li class="tsd-kind-module"><a href="modules/Group.html">Group</a></li>
<li class="tsd-kind-module"><a href="modules/Models.html">Models</a></li>
<li class="tsd-kind-module"><a href="modules/Server.html">Server</a></li>
<li class="tsd-kind-module"><a href="modules/Stats.html">Stats</a></li>
<li class="tsd-kind-module"><a href="modules/Track.html">Track</a></li>
<li class="tsd-kind-module"><a href="modules/UniqueList.html">Unique<wbr/>List</a></li>
<li class="tsd-kind-module"><a href="modules/User.html">User</a></li>
<li class="tsd-kind-module"><a href="modules/main.html">main</a></li></ul></li></ul></div></details></nav></div></div>
<div class="container tsd-generator">
<p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></div>
<div class="overlay"></div><script src="assets/main.js"></script></body></html>